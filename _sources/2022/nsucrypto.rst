NSUCRYPTO 2022
**************

Lời nói đầu
===========

Thời kì đen tối ...

Đề thi năm 2022 khá lạ và phức tạp. Bảng điểm round 2 dành cho University student cũng ảo ma không kém.

Super dependent S-box
----------------------

Đề bài
^^^^^^

Harry muốn tìm một super dependent S-box cho mã hóa mới. Anh ấy dùng một hoán vị liên kết chặt chẽ với mọi biến của nó và muốn ước lượng số các hoán vị như vậy.

Một hàm boolean vectorial :math:`F(x) = (f_1(\bm{x}), f_2(\bm{x}), \ldots, f_n(\bm{x}))`, với :math:`\bm{x} \in \mathbb{F}_2^n`, là một **hoán vị** trên :math:`\mathbb{F}_2^n` nếu nó là một ánh xạ one-to-one từ :math:`\mathbb{F}_2^n` tới :math:`\mathbb{F}_2^n`.

Các hàm tọa độ :math:`f_k(\bm{x})` (là các hàm boolean từ :math:`\mathbb{F}_2^n` tới :math:`\mathbb{F}_2`) được gọi là *essential depend* trên các biến :math:`x_j` nếu tồn tại các giá trị :math:`b_1, b_2, \ldots, b_{j-1}, b_{j+1}, \ldots, b_n \in \mathbb{F}_2` sao cho

.. math:: f_k(b_1, b_2, \ldots, b_{j-1}, 0, b_{j+1},  \ldots, b_n) \neq f_k(b_1, b_2, \ldots, b_{j-1}, 1, b_{j+1}, \ldots, b_n).

Nói cách khác, essential depend trên biến :math:`x_j` nghĩa là trong dạng biểu diễn ANF (đa thức Zhegalkin) của hàm :math:`f` có sự có mặt của biến :math:`x_j`.

.. prf:example:: 
    :label: nsu22-exp-super-sbox

    Xét :math:`n = 3`. Khi đó hàm boolean :math:`f(x_1, x_2, x_3) = x_1 x_2 \oplus x_3` essential depend trên cả ba biến, nhưng hàm :math:`g(x_1, x_2, x_3) = x_1 x_2 \oplus x_2 \oplus 1` chỉ essential depend trên :math:`x_1` và :math:`x_2`.

**Câu hỏi.** Tìm số lượng hoán vị trên :math:`\mathbb{F}_2^n` mà các hàm tọa độ của nó đều essential depend trên cả :math:`n` biến.

**Q1.** Tìm đáp án cho :math:`n = 2, 3`.

**Q2.** Tìm đáp án cho :math:`n` (special prize).

Giải
^^^^^^

Q1 có thể được giải với SageMath. Tuy nhiên năm đó mình không dùng SageMath mà dùng Python thuần nên đáp án sai mất. Đáp án cho Q1 với :math:`n = 2` là :math:`0` (liệt kê tất cả hàm ra) và đáp án cho :math:`n = 3` là :math:`24576`.

Ở Q2 các team giải ra chứng minh được rằng, đáp án sẽ là một số chia hết cho :math:`2^n \cdot n!`.

A long awaited event
--------------------

Đề bài
^^^^^^

Bob nhận được một thông điệp ``L78V8LC7GBEYEE``.

về một sự kiện quan trọng từ Alice.

Alice sử dụng một bảng chữ cái 37 ký tự gồm chữ cái từ A tới Z, số từ 0 tới 9 và dấu space. Các ký tự được encode như sau:

+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| A         | B         | C         | D         | E         | F         | G         | H         | I         | J         | K          | L          | M          | N          | O          | P          | Q          | R          | S          | T          |
+===========+===========+===========+===========+===========+===========+===========+===========+===========+===========+============+============+============+============+============+============+============+============+============+============+
| :math:`0` | :math:`1` | :math:`2` | :math:`3` | :math:`4` | :math:`5` | :math:`6` | :math:`7` | :math:`8` | :math:`9` | :math:`10` | :math:`11` | :math:`12` | :math:`13` | :math:`14` | :math:`15` | :math:`16` | :math:`17` | :math:`18` | :math:`19` |
+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+

+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| U          | V          | W          | X          | Y          | Z          | 0          | 1          | 2          | 3          | 4          | 5          | 6          | 7          | 8          | 9          | SPACE      |
+============+============+============+============+============+============+============+============+============+============+============+============+============+============+============+============+============+
| :math:`20` | :math:`21` | :math:`22` | :math:`23` | :math:`24` | :math:`25` | :math:`26` | :math:`27` | :math:`28` | :math:`29` | :math:`30` | :math:`31` | :math:`32` | :math:`33` | :math:`34` | :math:`35` | :math:`36` |
+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+

Để mã hóa Alice sử dụng hàm :math:`f` sao cho :math:`f(x) = a x^2 + b x + c \pmod{37}` với số :math:`a, b, c` nào đó và hàm :math:`f` thỏa tính chất

.. math:: f(x-y) - 2 f(x) f(y) + f(1 + xy) = 1 \pmod{37},
    
với mọi số nguyên :math:`x`, :math:`y`.


**Q.** Hãy giải mã thông điệp Bob nhận được.

Giải
^^^^^^

Sử dụng hàm :math:`f`, ta có:

1. Nếu cho :math:`y = 0` thì 

.. math:: f(x) - 2 f(x) \cdot f(0) + f(1) = 1 \pmod{37}

với mọi :math:`x \in \mathbb{Z}_{37}`.

Điều này tương đương với

.. math:: (1 - 2 f(0)) \cdot f(x) = 1 - f(1) \pmod{37}

với mọi :math:`x \in \mathbb{Z}_{37}`.

Đẳng thức trên đúng với mọi :math:`x \in \mathbb{Z}_{37}` khi và chỉ khi

.. math:: 1 - 2 f(0) = 1 - f(1) = 0.

Suy ra :math:`f(0) = 19` và :math:`f(1) = 1`.

Cho :math:`x = y = 1` thì

.. math:: f(2) = 1 - f(0) - 2 \cdot (f(1))^2 = 21 \pmod{37}.

Với các cặp giá trị :math:`(x, f(x))` là :math:`(0, 19)`, :math:`(1, 1)` và :math:`(2, 21)` thì ta tìm lại được (bằng nội suy hoặc phép thế) đa thức :math:`f(x) = 19 x^2 + 19 \pmod{37}`.

Khi đó, với mỗi giá trị :math:`f(x)` ta có hai giá trị :math:`x` thỏa mãn đẳng thức. Truy ngược ra đáp án khả thi cho ta thông điệp ban đầu.

+-------------+-----------------------+-----------------------+-----------------------+---------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+
| Ciphertext  | L                     | 7                     | 8                     | V                   | 8                     | L                     | C                     | 7                     | G                     | B                     | E                     | Y                     | E                     | E                     |
+=============+=======================+=======================+=======================+=====================+=======================+=======================+=======================+=======================+=======================++======================+=======================++======================+=======================+=======================+
| Plaintext 1 | N                     | S                     | R                     | C                   | R                     | N                     | P                     | S                     | O                     | B                     | J                     | L                     | J                     | J                     |
+-------------+-----------------------+-----------------------+-----------------------+---------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+
|             | :math:`\color{red}13` | :math:`\color{red}18` | :math:`17`            | :math:`\color{red}2`| :math:`\color{red}17` | :math:`13`            | :math:`\color{red}15` | :math:`18`            | :math:`\color{red}14` | :math:`1`             | :math:`9`             | :math:`11`            | :math:`9`             | :math:`9`             |
+-------------+-----------------------+-----------------------+-----------------------+---------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+
| Plaintext 2 | Y                     | T                     | U                     | 9                   | U                     | Y                     | W                     | T                     | X                     | SPACE                 | 2                     | 0                     | 2                     | 2                     |
+-------------+-----------------------+-----------------------+-----------------------+---------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+
|             | :math:`24`            | :math:`19`            | :math:`\color{red}20` | :math:`35`          | :math:`20`            | :math:`\color{red}24` | :math:`22`            | :math:`\color{red}19` | :math:`23`            | :math:`\color{red}36` | :math:`\color{red}28` | :math:`\color{red}26` | :math:`\color{red}28` | :math:`\color{red}28` |
+-------------+-----------------------+-----------------------+-----------------------+---------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+-----------------------+

Theo bảng tên thì thông điệp là ``NSUCRYPTO 2022``.
