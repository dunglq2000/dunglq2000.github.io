<!doctype html>
<html class="no-js" lang="vi" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Tìm Kiếm" href="../../search.html"><link rel="next" title="Internet Olympiad 2024" href="../internet-olympiad/index.html"><link rel="prev" title="Các cuộc thi năm 2024" href="../index.html">
        <link rel="prefetch" href="../../_static/Euler_Stamp.jpg" as="image">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.12.19 -->
        <title>NSUCRYPTO 2024 - Math Book</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystyles.css?v=fd3ba0dd" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Math Book</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/Euler_Stamp.jpg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Math Book</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Tìm Kiếm" name="q" aria-label="Tìm Kiếm">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../introduction/index.html">Những lời nói đầu</a><input aria-label="Toggle navigation of Những lời nói đầu" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/about-maths.html">Toán học là gì với mình?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/about-notebook.html">Cơ sở xây dựng notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/about-quotation.html">Những lời răn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/about-notation.html">Kí hiệu và công thức toán trong mật mã</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../algebra/index.html">Đại số</a><input aria-label="Toggle navigation of Đại số" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../algebra/set/index.html">1. Đại cương về tập hợp</a><input aria-label="Toggle navigation of 1. Đại cương về tập hợp" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/set/set.html">1.1. Tập hợp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/set/cadinality.html">1.2. Lực lượng của tập hợp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/set/map.html">1.3. Ánh xạ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/set/function.html">1.4. Hàm số</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/set/infinity.html">1.5. Các nghịch lý về tập vô hạn</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../algebra/polynomial/index.html">2. Đa thức</a><input aria-label="Toggle navigation of 2. Đa thức" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/polynomial/polynomial.html">2.1. Giới thiệu về đa thức</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/polynomial/polynomial.html#so-sanh-cong-tru-va-nhan-hai-da-thuc-mot-bien">2.2. So sánh, cộng, trừ và nhân hai đa thức một biến</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/polynomial/polynomial.html#phep-chia-da-thuc-mot-bien">2.3. Phép chia đa thức một biến</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/polynomial/polynomial.html#phep-chia-da-thuc-nhieu-bien">2.4. Phép chia đa thức nhiều biến</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/polynomial/lagrange-interpolation.html">2.5. Đa thức nội suy Lagrange</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/polynomial/numerical-methods.html">2.6. Phương pháp tính giá trị đa thức</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../algebra/proof.html">3. Phương pháp chứng minh toán học</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../algebra/glossary.html">4. Bảng thuật ngữ đại số</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../abstract-algebra/index.html">Lý thuyết nhóm</a><input aria-label="Toggle navigation of Lý thuyết nhóm" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../abstract-algebra/groups/index.html">1. Lý thuyết nhóm</a><input aria-label="Toggle navigation of 1. Lý thuyết nhóm" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/groups/group.html">1.1. Nhóm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/groups/symmetric-group.html">1.2. Nhóm hoán vị</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/groups/quasigroup.html">1.3. Quasigroup</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../abstract-algebra/homomorphisms/index.html">2. Homomorphisms</a><input aria-label="Toggle navigation of 2. Homomorphisms" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/homomorphisms/group-homomorphism.html">2.1. Group homomorphism</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../abstract-algebra/group-action/index.html">3. Tác động nhóm</a><input aria-label="Toggle navigation of 3. Tác động nhóm" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/group-action/group-action.html">3.1. Tác động nhóm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/group-action/burnside.html">3.2. Bổ đề Burnside</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../abstract-algebra/rings/index.html">4. Vành</a><input aria-label="Toggle navigation of 4. Vành" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/rings/ring.html">4.1. Vành</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../abstract-algebra/fields/index.html">5. Trường</a><input aria-label="Toggle navigation of 5. Trường" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/fields/field.html">5.1. Trường</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/fields/ideal.html">5.2. Ideal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/fields/ring-homomorphism.html">5.3. Ring kernel và ring homomorphism</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../abstract-algebra/galois-theory/index.html">6. Lý thuyết Galois</a><input aria-label="Toggle navigation of 6. Lý thuyết Galois" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/galois-theory/extension-field.html">6.1. Extension Fields</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../abstract-algebra/glossary.html">7. Bảng thuật ngữ lý thuyết nhóm</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../geometry/index.html">Hình học</a><input aria-label="Toggle navigation of Hình học" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../geometry/analytic-geometry/index.html">1. Hình học giải tích</a><input aria-label="Toggle navigation of 1. Hình học giải tích" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/analytic-geometry/intro.html">1.1. Theo dòng lịch sử</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/analytic-geometry/analytic-geometry.html">1.2. Phương pháp tọa độ trong mặt phẳng</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/analytic-geometry/analytic-geometry.html#dao-ham">1.3. Đạo hàm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/analytic-geometry/analytic-geometry.html#tich-phan">1.4. Tích phân</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/analytic-geometry/conics.html">1.5. Ba đường Conic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/analytic-geometry/transformation.html">1.6. Phép biến hình</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/brachistochrone/brachistochrone.html">2. Đường đoản thời</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../geometry/affine-geometry/index.html">3. Hình học affine</a><input aria-label="Toggle navigation of 3. Hình học affine" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html">3.1. Không gian affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#phang">3.2. Phẳng</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#doc-lap-affine-va-phu-thuoc-affine">3.3. Độc lập affine và phụ thuộc affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#giao-cua-cac-phang-bao-affine">3.4. Giao của các phẳng. Bao affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#vi-tri-tuong-doi">3.5. Vị trí tương đối</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#muc-tieu-va-toa-do-affine">3.6. Mục tiêu và tọa độ affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#cong-thuc-doi-muc-tieu">3.7. Công thức đổi mục tiêu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#phuong-trinh-cua-m-phang">3.8. Phương trình của <span class="math notranslate nohighlight">\(m\)</span>-phẳng</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#tam-ti-cu-va-ti-so-don">3.9. Tâm tỉ cự và tỉ số đơn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#anh-xa-affine">3.10. Ánh xạ affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#su-xac-dinh-anh-xa-affine">3.11. Sự xác định ánh xạ affine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/noneuclidean.html">4. Hình học phi Euclid</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../calculus/index.html">Giải tích</a><input aria-label="Toggle navigation of Giải tích" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../calculus/calculus/index.html">1. Giải tích</a><input aria-label="Toggle navigation of 1. Giải tích" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/limits.html">1.1. Giới hạn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/continuity.html">1.2. Tính liên tục của hàm số</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/monotone.html">1.3. Tính đơn điệu và cực trị</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/derivative.html">1.4. Đạo hàm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/partial-derivative.html">1.5. Đạo hàm riêng</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/partial-derivative.html#dao-ham-mot-so-ham-nhieu-bien">1.6. Đạo hàm một số hàm nhiều biến</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/avarage-value.html">1.7. Một số định lí về giá trị trung bình</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/concave.html">1.8. Tính lồi, lõm và điểm uốn của đồ thị</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/line-integral.html">1.9. Tích phân đường</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../calculus/differential-equation/index.html">2. Phương trình vi phân</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../calculus/series/index.html">3. Chuỗi số</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../probability/index.html">Xác suất thống kê</a><input aria-label="Toggle navigation of Xác suất thống kê" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../probability/intro.html">Xác suất thống kê</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../probability/ML/index.html">Machine Learning</a><input aria-label="Toggle navigation of Machine Learning" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../probability/ML/linear-regression.html">Linear Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../probability/ML/kmeans.html">K-Means clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../probability/ML/gradient-descent.html">Gradient Descent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../probability/ML/perceptron.html">Perceptron Learning Algorithm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../linalg/index.html">Đại số tuyến tính</a><input aria-label="Toggle navigation of Đại số tuyến tính" class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../linalg/matrix/index.html">1. Ma trận</a><input aria-label="Toggle navigation of 1. Ma trận" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../linalg/matrix/matrix-determinant.html">1.1. Định thức ma trận</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../linalg/matrix/matrix-inversion.html">1.2. Ma trận nghịch đảo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../linalg/matrix/matrix-rank.html">1.3. Hạng của ma trận</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/system-of-equations.html">2. Hệ phương trình tuyến tính</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/linear-operator.html">3. Toán tử tuyến tính</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/eigen.html">4. Trị riêng và vector riêng</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/linear-combination.html">5. Tổ hợp tuyến tính</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/vector-space.html">6. Không gian vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/euclidean-space.html">7. Không gian Euclide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/quadratic-form.html">8. Dạng toàn phương</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/hilbert-space.html">9. Không gian Hilbert</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../number-theory/index.html">Lý thuyết số</a><input aria-label="Toggle navigation of Lý thuyết số" class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/euclidean.html">1. Phép chia Euclid. Thuật toán Euclid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/linear-congruence.html">2. Phương trình đồng dư tuyến tính</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/arithmetic-functions.html">3. Các hàm số học quan trọng</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/quadratic-residue.html">4. Thặng dư chính phương</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/dirichlet-convolution.html">5. Tích chập Dirichlet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/chinese-remainder-theorem.html">6. Định lý số dư Trung Hoa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/exercises.html">7. Bài tập số học sưu tầm</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../discrete-mathematics/index.html">Toán rời rạc</a><input aria-label="Toggle navigation of Toán rời rạc" class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/binary-relation.html">Quan hệ hai ngôi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/partition.html">Phân hoạch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/discrete-fourier-transform.html">Biến đổi Fourier rời rạc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/combinatoric.html">Đại cương tổ hợp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/recurrence-relation.html">Công thức truy hồi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/system-lineq-integer.html">Hệ phương trình tuyến tính trên trường hữu hạn</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../discrete-mathematics/graph/index.html">Lý thuyết đồ thị</a><input aria-label="Toggle navigation of Lý thuyết đồ thị" class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../discrete-mathematics/graph/definitions.html">Các định nghĩa cơ bản</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../discrete-mathematics/graph/connection.html">Tính liên thông của đồ thị</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../discrete-mathematics/graph/tree.html">Cây</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../discrete-mathematics/graph/application-1.html">Ứng dụng 1: sắp xếp topo và bài toán xếp lịch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../discrete-mathematics/graph/application-2.html">Ứng dụng 2: tối ưu bằng thuật toán Kruskal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../discrete-mathematics/graph/application-3.html">Ứng dụng 3: mạng xã hội</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../discrete-mathematics/graph/euler_hamilton.html">Đồ thị Euler và đồ thị Hamilton</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../topology/index.html">Topology</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../boolean/index.html">Hàm Boolean và mật mã học</a><input aria-label="Toggle navigation of Hàm Boolean và mật mã học" class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../boolean/boolean-function/index.html">1. Algebraic Normal Form</a><input aria-label="Toggle navigation of 1. Algebraic Normal Form" class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/boolean-function/introduction.html">1.1. Giới thiệu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/boolean-function/boolean-affine.html">1.2. Hàm affine và hàm tuyến tính</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/boolean-function/boolean-monotone.html">1.3. Hàm đơn điệu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/boolean-function/boolean-dnf-cnf.html">1.4. Disjunctive và Conjunctive Normal Form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/boolean-function/boolean-weight.html">1.5. Khoảng cách Hamming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/boolean-function/walsh-hadamard-spectre.html">1.6. Nonlinearity của hàm boolean</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../boolean/cryptographic-properties.html">2. Các tính chất mật mã của hàm Boolean</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../boolean/block-cipher/index.html">3. Block cipher</a><input aria-label="Toggle navigation of 3. Block cipher" class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block-cipher/spnet.html">3.1. SP network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block-cipher/aes.html">3.2. AES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block-cipher/kuznyechik.html">3.3. Kuznyechik</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block-cipher/present.html">3.4. PRESENT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block-cipher/feistel.html">3.5. Mô hình Feistel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block-cipher/magma.html">3.6. Magma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block-cipher/sms4.html">3.7. SMS4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block-cipher/arx.html">3.8. ARX</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../boolean/stream-cipher/index.html">4. Stream cipher</a><input aria-label="Toggle navigation of 4. Stream cipher" class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/stream-cipher/linear-feedback-shift-register.html">4.1. Linear Feedback Shift Register</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../boolean/mac.html">5. Message Authentication Code</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cryptanalysis/index.html">Phá mã</a><input aria-label="Toggle navigation of Phá mã" class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cryptanalysis/differential-attack/index.html">1. Phá mã vi sai</a><input aria-label="Toggle navigation of 1. Phá mã vi sai" class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cryptanalysis/differential-attack/toycipher.html">1.1. Nhập môn phá mã vi sai</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptanalysis/differential-attack/tinydes.html">1.2. Phá mã vi sai trên TinyDES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptanalysis/differential-attack/difference-and-differential.html">1.3. Difference và differential</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cryptanalysis/linear-attack/index.html">2. Phá mã tuyến tính</a><input aria-label="Toggle navigation of 2. Phá mã tuyến tính" class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cryptanalysis/linear-attack/tinydes.html">2.1. Phá mã tuyến tính trên TinyDES</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptanalysis/slide-attack/index.html">3. Slide attack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptanalysis/algebraic-attack/index.html">4. Algebraic cryptanalysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cryptography/index.html">Mật mã học</a><input aria-label="Toggle navigation of Mật mã học" class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cryptography/lattice-based/index.html">1. Lattice-based cryptography</a><input aria-label="Toggle navigation of 1. Lattice-based cryptography" class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/lattice-based/intro.html">1.1. Nhập môn mật mã dựa trên lattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/lattice-based/congruential-pubkey.html">1.2. Congruential public key cryptosystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/lattice-based/ntru.html">1.3. NTRU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/lattice-based/falcon.html">1.4. FALCON</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/lattice-based/lattice-reduction-algorithms.html">1.5. Thuật toán rút gọn lattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/lattice-based/coppersmith.html">1.6. Phương pháp Coppersmith</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cryptography/code-based/index.html">2. Code-based cryptography</a><input aria-label="Toggle navigation of 2. Code-based cryptography" class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/intro.html">2.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/decode-problem.html">2.2. Bài toán decode tổng quát</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/linear-code.html">2.3. Linear code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/weight.html">2.4. Bài toán phổ trọng số của mã tuyến tính</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/decode-on-linear-code.html">2.5. Bài toán decode trên linear code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/equivalence.html">2.6. Bài toán tương đương các linear code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/cryptosystem.html">2.7. Ý tưởng xây dựng các hệ mật mã dựa trên mã sửa sai</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/pubkey-algo.html">2.8. Các hệ mật mã khóa công khai dựa trên lý thuyết code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/goppa-code.html">2.9. Goppa Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/elliptic/index.html">3. Đường cong elliptic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/Kerckhoffs-principle/index.html">4. Nguyên tắc Kerckhoffs và mật mã học</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/quantum-computing.html">5. Quantum computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/discrete-logarithm.html">6. Logarithm rời rạc</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../solutions/index.html">Lời giải các bài tập trong sách tham khảo</a><input aria-label="Toggle navigation of Lời giải các bài tập trong sách tham khảo" class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../solutions/Judson.html">Abstract Algebra: Theory and Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../solutions/Petrushko/index.html">Курс высшей математики: Теория вероятностей</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../solutions/an-introduction-to-mathematical-cryptography/index.html">An Introduction to Mathematical Cryptography</a><input aria-label="Toggle navigation of An Introduction to Mathematical Cryptography" class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../solutions/an-introduction-to-mathematical-cryptography/chapter-2.html">Chapter 2. Discrete Logarithms and Diffie-Hellman</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../solutions/an-introduction-to-mathematical-cryptography/chapter-3.html">Chapter 3. Integer Factorization and RSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../solutions/an-introduction-to-mathematical-cryptography/chapter-4.html">Chapter 4. Digital Signatures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../solutions/an-introduction-to-mathematical-cryptography/chapter-7.html">Chapter 7. Lattices and Cryptography</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../solutions/symmetric-cryptography/index.html">Симметричная криптография</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../solutions/collection.html">Các bài toán sưu tầm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../solutions/cryptohack/index.html">Wargame chill chill</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../2020/index.html">Các cuộc thi năm 2020</a><input aria-label="Toggle navigation of Các cuộc thi năm 2020" class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../2020/midnightsun.html">Midnight Sun CTF 2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2020/nsucrypto/index.html">NSUCRYPTO 2020</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../2021/index.html">Các cuộc thi năm 2021</a><input aria-label="Toggle navigation of Các cuộc thi năm 2021" class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../2021/CryptoCTF/index.html">Crypto CTF 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2021/GoogleCTF/index.html">Google CTF 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2021/nsucrypto/index.html">NSUCRYPTO 2021</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../2022/index.html">Các cuộc thi năm 2022</a><input aria-label="Toggle navigation of Các cuộc thi năm 2022" class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../2022/downunderCTF/index.html">DownUnder CTF 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2022/nsucrypto.html">NSUCRYPTO 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2022/sekaiCTF/index.html">Sekai CTF 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2022/isitdtu/index.html">ISITDTU Quals 2022</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../2023/index.html">Các cuộc thi năm 2023</a><input aria-label="Toggle navigation of Các cuộc thi năm 2023" class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../2023/nsucrypto/index.html">NSUCRYPTO 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/siberian-maths-contest/index.html">Siberian Mathematical Contest 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/internet-olympiad/index.html">Internet Olympiad 2023 (Vòng 3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/amateursCTF.html">Amateurs CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/backdoorCTF.html">Backdoor CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/googleCTF.html">Google CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/diceCTF.html">Dice CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/UTCTF.html">UTCTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/wolvCTF.html">Wolv CTF 2023</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Các cuộc thi năm 2024</a><input aria-label="Toggle navigation of Các cuộc thi năm 2024" checked="" class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" role="switch" type="checkbox"/><label for="toctree-checkbox-40"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">NSUCRYPTO 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internet-olympiad/index.html">Internet Olympiad 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../0xL4ughCTF-2024/index.html">0xL4ugh CTF 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ASISCTF-2024/index.html">ASIS CTF 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TJCTF.html">TJCTF 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cryptofox/index.html">CryptoFox 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../isitdtu.html">ISITDTU Quals 2024</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../2025/index.html">Các cuộc thi năm 2025</a><input aria-label="Toggle navigation of Các cuộc thi năm 2025" class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" role="switch" type="checkbox"/><label for="toctree-checkbox-41"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../2025/cryptofox/index.html">CryptoFox 2025</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2025/tjctf.html">TJCTF 2025</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../stuff/index.html">Ngoài lề</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../game-programming/index.html">Lý thuyết lập trình game</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../myrefs.html">Tài liệu tham khảo</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/2024/nsucrypto/index.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="nsucrypto-2024">
<h1>NSUCRYPTO 2024<a class="headerlink" href="#nsucrypto-2024" title="Link to this heading">¶</a></h1>
<p>Trong hai bài viết mình sẽ giới thiệu cách giải các bài trong NSUCRYPTO 2024 từ bài giải của team mình lẫn từ team các bạn mà mình tham khảo sau khi kết thúc giải. Hiện tại chỉ có team của Robin Jadoul, Jack Pope, Esrever Yievs chia sẻ bài giải gần hoàn chỉnh trên discord của một cộng đồng toxic nào đó mà ai cũng biết nên mình sẽ gọi là team JPY khi đề cập tới cách giải của các bạn (lấy chữ cái đầu họ của ba người :v).</p>
<section id="loi-noi-dau">
<h2>Lời nói đầu<a class="headerlink" href="#loi-noi-dau" title="Link to this heading">¶</a></h2>
<p>Đầu tiên mình xin cám ơn rất nhiều người đã ủng hộ, giúp đỡ mình trong mấy năm qua, để mình có thể đi tới ngày hôm nay.</p>
<p>Đề thi năm nay khiến mình có chút hoang mang khi bắt đầu làm. Round 2 có 11 câu với hai câu special prize. Thường những năm trước có từ 4 tới 5 câu special prize và đây là nơi đột biến xảy ra. Nếu chỉ có hai câu thì mình không hy vọng được giải cao mà mục tiêu là giải trọn vẹn và không mắc lỗi ở tất cả câu khác.</p>
<p>Và điều kì diệu đã xảy ra :))) team mình được hai bài BEST SOLUTION do hai bạn teammate giải, còn mình thì ... ké :D</p>
<p>Chân thành cám ơn bạn Chương và bạn Uyên đã đồng hành cũng mình hai năm nay.</p>
</section>
<section id="rsa-signature">
<h2>RSA signature<a class="headerlink" href="#rsa-signature" title="Link to this heading">¶</a></h2>
<p>Đây là bài 7 ở round 1 và bài 1 ở round 2.</p>
<section id="de-bai">
<h3>Đề bài<a class="headerlink" href="#de-bai" title="Link to this heading">¶</a></h3>
<p>Chúng ta cần ký thông điệp <span class="math notranslate nohighlight">\(M\)</span> bằng thuật toán RSA. Như bình thường, đặt <span class="math notranslate nohighlight">\(N = p \cdot q\)</span> là RSA-modulus với <span class="math notranslate nohighlight">\(p\)</span> và <span class="math notranslate nohighlight">\(q\)</span> là hai số nguyên tố lớn.</p>
<p>Đặt <span class="math notranslate nohighlight">\(e\)</span> là public exponent và <span class="math notranslate nohighlight">\(d\)</span> là secret exponent với</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[e \cdot d = 1 \bmod (p - 1)(q - 1).\]</div>
</div>
<p>Signature của chúng ta sẽ là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[S = M^d \bmod N.\]</div>
</div>
<p>Giả sử kẻ tấn công biết giá trị</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[M_p = M^{d_p} \bmod p,\]</div>
</div>
<p>nhưng không biết giá trị</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[M_q = M^{d_q} \bmod q,\]</div>
</div>
<p>trong đó</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[d_p = d \bmod (p-1), \quad d_q = d \bmod (q-1).\]</div>
</div>
<p>Nếu kẻ tấn công biết modulo <span class="math notranslate nohighlight">\(N\)</span> (nhưng không biết <span class="math notranslate nohighlight">\(p\)</span> và <span class="math notranslate nohighlight">\(q\)</span>), biết public exponent <span class="math notranslate nohighlight">\(e\)</span> (nhưng không biết <span class="math notranslate nohighlight">\(d\)</span>) và biết thông điệp gốc <span class="math notranslate nohighlight">\(M\)</span>. Các thông số bí mật nào kẻ tấn công có thể tìm ra?</p>
</section>
<section id="loi-giai">
<h3>Lời giải<a class="headerlink" href="#loi-giai" title="Link to this heading">¶</a></h3>
<p>Vì <span class="math notranslate nohighlight">\(S \equiv M^d \pmod N\)</span> nên suy ra <span class="math notranslate nohighlight">\(S \equiv M^d \pmod p\)</span> vì</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(S - M^d) \ \vdots \ N \ \vdots \ p,\]</div>
</div>
<p>tương tự <span class="math notranslate nohighlight">\(S \equiv M^d \pmod q\)</span>.</p>
<p>Ngoài ra ta có</p>
<div class="math-wrapper docutils container" id="equation-nsu24-eq-1">
<div class="math notranslate nohighlight" id="equation-nsu24-eq-1">
<span class="eqno">(9)<a class="headerlink" href="#equation-nsu24-eq-1" title="Link to this equation">¶</a></span>\[S^e \equiv M^{ed} \equiv M \pmod N.\]</div>
</div>
<p>Tương tự phía trên ta cũng có</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[S^e \equiv M^{ed} \equiv M \pmod p,\]</div>
</div>
<p>nhưng <span class="math notranslate nohighlight">\(d_p \equiv d \pmod{p-1}\)</span>, tương đương với</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[d = d_p + k_p \cdot (p-1)\]</div>
</div>
<p>với <span class="math notranslate nohighlight">\(k_p \in \mathbb{Z}\)</span>.</p>
<p>Do đó</p>
<div class="math-wrapper docutils container" id="equation-nsu24-eq-2">
<div class="math notranslate nohighlight" id="equation-nsu24-eq-2">
<span class="eqno">(10)<a class="headerlink" href="#equation-nsu24-eq-2" title="Link to this equation">¶</a></span>\[\begin{split}S^e &amp; \equiv M^{e \cdot (d_p + k_p \cdot (p - 1))} \pmod{p} \\
    &amp; \equiv M^{e \cdot d_p} \pmod{p} \quad (\text{định lý Euler}) \\
    &amp; \equiv M_p^e \pmod{p}.\end{split}\]</div>
</div>
<p>Từ hai phương trình <a class="reference internal" href="#equation-nsu24-eq-1">(9)</a> và <a class="reference internal" href="#equation-nsu24-eq-2">(10)</a> suy ra</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[M^e_p \equiv M \pmod p,\]</div>
</div>
<p>hay ta có thể nói là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(M^e_p \bmod N) - M \ \vdots \ p.\]</div>
</div>
<p>Từ đây, sử dụng thuật toán Euclid ta tìm được</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p = \gcd((M^e_p \bmod N) - M, N).\]</div>
</div>
<p>Vậy là ta đã tìm được <span class="math notranslate nohighlight">\(p\)</span> nên có thể tìm được tất cả tham số secret khác của RSA là <span class="math notranslate nohighlight">\(q\)</span>, <span class="math notranslate nohighlight">\(d\)</span>, <span class="math notranslate nohighlight">\(d_p\)</span> và <span class="math notranslate nohighlight">\(d_q\)</span>.</p>
<div class="dropdown admonition">
<p class="admonition-title">solve.py</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Util.number</span><span class="w"> </span><span class="kn">import</span> <span class="n">getPrime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">while</span> <span class="n">b</span><span class="p">:</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="p">[</span><span class="n">getPrime</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">q</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
<span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">dp</span> <span class="o">=</span> <span class="n">d</span> <span class="o">%</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Mp</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">N</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">M</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Mp</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">p_guess</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">Mp</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">p</span> <span class="o">==</span> <span class="n">p_guess</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully recoverd p&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="antcipher-2-0">
<h2>AntCipher 2.0<a class="headerlink" href="#antcipher-2-0" title="Link to this heading">¶</a></h2>
<p>Đây là bài 2 ở round 2.</p>
<section id="id1">
<h3>Đề bài<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>Một phút một lần, GPS được track bởi vệ tinh. Khi đó, vĩ độ ở dạng IEEE 754 single-precision floating-point sẽ được chuyển thành dãy 32 bit. Tương tự cho kinh độ.</p>
<p>Khi đó hai dãy nhị phân sẽ được nối lại (lattile || longitude) thành plaintext có 64 bit. Sau đó plaintext được XOR với keystream để tạo thành ciphertext 64 bit.</p>
<p>Cách thực hiện sinh khóa như sau. Tại điểm khởi tạo, secret key 64 bit được viết vào thanh ghi <span class="math notranslate nohighlight">\(R\)</span> dung lượng 64 bit.</p>
<p>Với mỗi số <span class="math notranslate nohighlight">\(i\)</span> với <span class="math notranslate nohighlight">\(i \geqslant 1\)</span>, dãy <span class="math notranslate nohighlight">\(K_i\)</span> 64 bit sẽ được sinh từ input là <span class="math notranslate nohighlight">\(R\)</span> và keystream cũng dùng để cập nhật thanh ghi <span class="math notranslate nohighlight">\(R\)</span>, nghĩa là sau khi tính toán thì giá trị <span class="math notranslate nohighlight">\(K_i\)</span> sẽ được ghi vào <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>Xét dạng CNF của hàm <span class="math notranslate nohighlight">\(C\)</span>, với CNF là conjunction of disjunction (tích của các tổng), có dạng sau:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}C = (x_1 \lor v_2 \lor \neg x_5) \land (\neg x_1 \lor \neg x_2 \lor x_5) \land (x_1 \lor x_3 \lor \neg x_5) \land (\neg x_1 \lor \neg x_3 \lor x_5) \\
\land (x_2 \lor x_3 \lor \neg x_5) \land (\neg x_2 \lor \neg x_3 \lor x_5) \land (x_1 \lor x_2 \lor \neg x_6) \land (\neg x_1 \lor \neg x_2 \lor x_6) \\
\land (x_1 \lor x_4 \lor \neg x_6) \land (\neg x_1 \lor \neg x_4 \lor x_6) \land (x_2 \lor x_4 \lor \neg x_6) \land (\neg x_2 \lor \neg x_4 \lor x_6) \\
\land (x_1 \lor x_3 \lor \neg x_7) \land (\neg x_1 \lor \neg x_3 \lor x_7) \land (x_1 \lor x_4 \lor \neg x_7) \land (\neg x_1 \lor \neg x_4 \lor x_7) \\
\land (x_3 \lor x_4 \lor \neg x_7) \land (\neg x_3 \lor \neg x_4 \lor x_7) \land (x_2 \lor x_3 \lor \neg x_8) \land (\neg x_2 \lor \neg x_3 \lor x_8) \\
\land (x_2 \lor x_4 \lor \neg x_8) \land (\neg x_2 \lor \neg x_4 \lor x_8) \land (x_3 \lor x_4 \lor \neg x_8) \land (\neg x_3 \lor \neg x_4 \lor x_8)\end{split}\]</div>
</div>
<p>Phương trình <span class="math notranslate nohighlight">\(C = 1\)</span> biểu diễn một hàm không tuyến tính <span class="math notranslate nohighlight">\(F_G\)</span> lấy đầu vào là <span class="math notranslate nohighlight">\(4\)</span> bits <span class="math notranslate nohighlight">\((x_1, x_2, x_3, x_4)\)</span> và sinh ra <span class="math notranslate nohighlight">\(4\)</span> bits <span class="math notranslate nohighlight">\((x_5, x_6, x_7, x_8)\)</span> làm output.</p>
<p>Ở vòng lặp thứ <span class="math notranslate nohighlight">\(i\)</span> của cipher, <span class="math notranslate nohighlight">\(64\)</span> bits của <span class="math notranslate nohighlight">\(R\)</span> được chia thành <span class="math notranslate nohighlight">\(16\)</span> đoạn, mỗi đoạn <span class="math notranslate nohighlight">\(4\)</span> bit. Mỗi đoạn thành input cho <span class="math notranslate nohighlight">\(F_G\)</span> và kết quả là <span class="math notranslate nohighlight">\(16\)</span> đoạn <span class="math notranslate nohighlight">\(4\)</span> bits mới được nối với nhau thành <span class="math notranslate nohighlight">\(K_i\)</span> có <span class="math notranslate nohighlight">\(64\)</span> bits.</p>
<p><span class="math notranslate nohighlight">\(1704\)</span> ciphertexts được truyền đi không gặp vấn đề. Tuy nhiên ở hai keystream tiếp theo gặp sự cố về đĩa cứng nên chỉ nhận được ciphertext thứ <span class="math notranslate nohighlight">\(1704\)</span> là dãy</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1001</span> <span class="mi">1000</span> <span class="mi">0011</span> <span class="mi">1101</span> <span class="mi">0110</span> <span class="mi">0011</span> <span class="mi">1101</span> <span class="mi">0101</span> <span class="mi">1011</span> <span class="mi">0011</span> <span class="mi">1011</span> <span class="mi">0111</span> <span class="mi">0000</span> <span class="mi">0000</span> <span class="mi">1000</span> <span class="mi">0011</span>
</pre></div>
</div>
<p>và hai keystrem <span class="math notranslate nohighlight">\(1702\)</span> và <span class="math notranslate nohighlight">\(1703\)</span> nhưng bị mất một phần:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}K_{1702} &amp; = \text{0101 1001 1111 0011 00X1 X111 1X00 00X0} \\
        &amp; \text{111X X000 XXXX XXXX XXXX XXXX XXXX XXXX}, \\
K_{1703} &amp; = \text{XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX} \\
        &amp; \text{X111 000X X010 01X1 0X10 0101 0000 1111}.\end{split}\]</div>
</div>
<p>Hãy tìm lại plaintext thứ <span class="math notranslate nohighlight">\(1704\)</span>.</p>
</section>
<section id="id2">
<h3>Lời giải<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>Đầu tiên mình cần tìm những bộ số <span class="math notranslate nohighlight">\((x_1, \ldots, x_8)\)</span> mà <span class="math notranslate nohighlight">\(C = 1\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">product</span>

<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">x5</span><span class="p">,</span> <span class="n">x6</span><span class="p">,</span> <span class="n">x7</span><span class="p">,</span> <span class="n">x8</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x1</span> <span class="o">|</span> <span class="n">x2</span> <span class="o">|</span> <span class="o">~</span><span class="n">x5</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">x1</span> <span class="o">|</span> <span class="o">~</span><span class="n">x2</span> <span class="o">|</span> <span class="n">x5</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x1</span> <span class="o">|</span> <span class="n">x3</span> <span class="o">|</span> <span class="o">~</span><span class="n">x5</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">x1</span> <span class="o">|</span> <span class="o">~</span><span class="n">x3</span> <span class="o">|</span> <span class="n">x5</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x2</span> <span class="o">|</span> <span class="n">x3</span> <span class="o">|</span> <span class="o">~</span><span class="n">x5</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">x2</span> <span class="o">|</span> <span class="o">~</span><span class="n">x3</span> <span class="o">|</span> <span class="n">x5</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x1</span> <span class="o">|</span> <span class="n">x2</span> <span class="o">|</span> <span class="o">~</span><span class="n">x6</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">x1</span> <span class="o">|</span> <span class="o">~</span><span class="n">x2</span> <span class="o">|</span> <span class="n">x6</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x1</span> <span class="o">|</span> <span class="n">x4</span> <span class="o">|</span> <span class="o">~</span><span class="n">x6</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">x1</span> <span class="o">|</span> <span class="o">~</span><span class="n">x4</span> <span class="o">|</span> <span class="n">x6</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x2</span> <span class="o">|</span> <span class="n">x4</span> <span class="o">|</span> <span class="o">~</span><span class="n">x6</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">x2</span> <span class="o">|</span> <span class="o">~</span><span class="n">x4</span> <span class="o">|</span> <span class="n">x6</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x1</span> <span class="o">|</span> <span class="n">x3</span> <span class="o">|</span> <span class="o">~</span><span class="n">x7</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">x1</span> <span class="o">|</span> <span class="o">~</span><span class="n">x3</span> <span class="o">|</span> <span class="n">x7</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x1</span> <span class="o">|</span> <span class="n">x4</span> <span class="o">|</span> <span class="o">~</span><span class="n">x7</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">x1</span> <span class="o">|</span> <span class="o">~</span><span class="n">x4</span> <span class="o">|</span> <span class="n">x7</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x3</span> <span class="o">|</span> <span class="n">x4</span> <span class="o">|</span> <span class="o">~</span><span class="n">x7</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">x3</span> <span class="o">|</span> <span class="o">~</span><span class="n">x4</span> <span class="o">|</span> <span class="n">x7</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x2</span> <span class="o">|</span> <span class="n">x3</span> <span class="o">|</span> <span class="o">~</span><span class="n">x8</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">x2</span> <span class="o">|</span> <span class="o">~</span><span class="n">x3</span> <span class="o">|</span> <span class="n">x8</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x2</span> <span class="o">|</span> <span class="n">x4</span> <span class="o">|</span> <span class="o">~</span><span class="n">x8</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">x2</span> <span class="o">|</span> <span class="o">~</span><span class="n">x4</span> <span class="o">|</span> <span class="n">x8</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x3</span> <span class="o">|</span> <span class="n">x4</span> <span class="o">|</span> <span class="o">~</span><span class="n">x8</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">x3</span> <span class="o">|</span> <span class="o">~</span><span class="n">x4</span> <span class="o">|</span> <span class="n">x8</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>

<span class="n">key</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>

<span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">x5</span><span class="p">,</span> <span class="n">x6</span><span class="p">,</span> <span class="n">x7</span><span class="p">,</span> <span class="n">x8</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">x5</span><span class="p">,</span> <span class="n">x6</span><span class="p">,</span> <span class="n">x7</span><span class="p">,</span> <span class="n">x8</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x3</span><span class="p">,</span><span class="w"> </span><span class="n">x4</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">x5</span><span class="p">,</span><span class="w"> </span><span class="n">x6</span><span class="p">,</span><span class="w"> </span><span class="n">x7</span><span class="p">,</span><span class="w"> </span><span class="n">x8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="p">(</span><span class="n">x2</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x3</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x4</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">x5</span> <span class="o">+</span> <span class="p">(</span><span class="n">x6</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x7</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x8</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">key</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
</pre></div>
</div>
<p>Bảng biến đổi sẽ như sau:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\((x_1, x_2, x_3, x_4)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\((x_5, x_6, x_7, x_8)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\((0, 0, 0, 0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 0, 0, 0)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\((0, 0, 0, 1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 0, 0, 0)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\((0, 0, 1, 0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 0, 0, 0)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\((0, 0, 1, 1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 0, 1, 1)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\((0, 1, 0, 0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 0, 0, 0)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\((0, 1, 0, 1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 1, 0, 1)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\((0, 1, 1, 0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((1, 0, 0, 1)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\((0, 1, 1, 1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((1, 1, 1, 1)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\((1, 0, 0, 0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 0, 0, 0)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\((1, 0, 0, 1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 1, 1, 0)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\((1, 0, 1, 0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((1, 0, 1, 0)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\((1, 0, 1, 1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((1, 1, 1, 1)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\((1, 1, 0, 0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((1, 1, 0, 0)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\((1, 1, 0, 1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((1, 1, 1, 1)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\((1, 1, 1, 0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((1, 1, 1, 1)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\((1, 1, 1, 1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((1, 1, 1, 1)\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Có thể thấy đầu ra không chứa đủ <span class="math notranslate nohighlight">\(16\)</span> trường hợp mà chỉ gồm các trường hợp là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(0, 0, 0, 0), (0, 0, 1, 1), (0, 1, 0, 1), (1, 0, 0, 1), (0, 1, 1, 0,), (1, 0, 1, 0), (1, 1, 0, 0), (1, 1, 1, 1).\]</div>
</div>
<p>Ở đây mỗi vector đều có số lượng chẵn phần tử <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>Xét biến đổi từ <span class="math notranslate nohighlight">\(K_{1702}\)</span> thành <span class="math notranslate nohighlight">\(K_{1703}\)</span> như sau:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(K_{1702}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(K_{1703}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{0101}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\text{1001}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{1111}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\text{0011}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{00X1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\text{X111}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{1X00}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\text{00X0}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{111X}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{X111}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\text{X000}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{000X}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{X010}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{01X1}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{0X10}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{0101}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{0000}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\text{XXXX}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\rightarrow\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{1111}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Dựa vào bảng biến đổi ở trên và lưu ý đầu ra (có <span class="math notranslate nohighlight">\(8\)</span> trường hợp tất cả) thì ta có kết luận cho từng bộ <span class="math notranslate nohighlight">\(4\)</span> như sau:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(0101 \rightarrow 010\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(1001 \rightarrow 0110\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(1111 \rightarrow 1111\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(0011 \rightarrow 0011\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{00X1} \rightarrow 0000\)</span>. Vì <span class="math notranslate nohighlight">\(K_{1702}\)</span> nhận được từ <span class="math notranslate nohighlight">\(K_{1701}\)</span> nên X chỉ có thể là <span class="math notranslate nohighlight">\(1\)</span> và kết quả ở <span class="math notranslate nohighlight">\(K_{1703}\)</span> sẽ là <span class="math notranslate nohighlight">\(0000\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{X111} \rightarrow 1111\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{1X00} \rightarrow 0000\)</span>. Tương tự, vì <span class="math notranslate nohighlight">\(K_{1702}\)</span> nhận được từ <span class="math notranslate nohighlight">\(K_{1701}\)</span> nên X chỉ có thể là <span class="math notranslate nohighlight">\(1\)</span> và kết quả ở <span class="math notranslate nohighlight">\(K_{1703}\)</span> là <span class="math notranslate nohighlight">\(0000\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{0X00} \rightarrow 0000\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{111X} \rightarrow 1111\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{X000} \rightarrow 0000\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{XXXX} \rightarrow 1010\)</span>. Trong mỗi bộ số trong <span class="math notranslate nohighlight">\(8\)</span> trường hợp ở trên thì số lượng chữ số <span class="math notranslate nohighlight">\(1\)</span> là chẵn.</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{XXXX} \rightarrow 0101\)</span>. Tương tự.</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{XXXX} \rightarrow 0110\)</span>. Tương tự</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{XXXX} \rightarrow 0101\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{XXXX} \rightarrow 0000\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{XXXX} \rightarrow 1111\)</span>.</p></li>
</ol>
<p>Như vậy mình đã khôi phục được <span class="math notranslate nohighlight">\(K_{1703}\)</span> và có thể decrypt.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://gist.github.com/AlexEshoo/d3edc53129ed010b0a5b693b88c7e0b5</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ieee_754_conversion</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sgn_len</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">exp_len</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">mant_len</span><span class="o">=</span><span class="mi">23</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts an arbitrary precision Floating Point number.</span>
<span class="sd">    Note: Since the calculations made by python inherently use floats, the accuracy is poor at high precision.</span>
<span class="sd">    :param n: An unsigned integer of length `sgn_len` + `exp_len` + `mant_len` to be decoded as a float</span>
<span class="sd">    :param sgn_len: number of sign bits</span>
<span class="sd">    :param exp_len: number of exponent bits</span>
<span class="sd">    :param mant_len: number of mantissa bits</span>
<span class="sd">    :return: IEEE 754 Floating Point representation of the number `n`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">sgn_len</span> <span class="o">+</span> <span class="n">exp_len</span> <span class="o">+</span> <span class="n">mant_len</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number n is longer than prescribed parameters allows&quot;</span><span class="p">)</span>

    <span class="n">sign</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">sgn_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">exp_len</span> <span class="o">+</span> <span class="n">mant_len</span><span class="p">)))</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">exp_len</span> <span class="o">+</span> <span class="n">mant_len</span><span class="p">)</span>
    <span class="n">exponent_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">2</span> <span class="o">**</span> <span class="n">exp_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">mant_len</span><span class="p">)))</span> <span class="o">&gt;&gt;</span> <span class="n">mant_len</span>
    <span class="n">mantissa</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">mant_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">sign_mult</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">sign_mult</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">if</span> <span class="n">exponent_raw</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">exp_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Could be Inf or NaN</span>
        <span class="k">if</span> <span class="n">mantissa</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">mant_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span>  <span class="c1"># NaN</span>

        <span class="k">return</span> <span class="n">sign_mult</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>  <span class="c1"># Inf</span>

    <span class="n">exponent</span> <span class="o">=</span> <span class="n">exponent_raw</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">exp_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exponent_raw</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">mant_mult</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Gradual Underflow</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mant_mult</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mant_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">mantissa</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">b</span><span class="p">):</span>
            <span class="n">mant_mult</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">mant_len</span> <span class="o">-</span> <span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">sign_mult</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">exponent</span><span class="p">)</span> <span class="o">*</span> <span class="n">mant_mult</span>

<span class="n">ciphertext</span> <span class="o">=</span> <span class="s2">&quot;1001 1000 0011 1101 0110 0011 1101 0101 1011 0011 1011 0111 0000 0000 1000 0011&quot;</span>
<span class="n">ciphertext</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ciphertext</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))))</span>

<span class="n">keystream</span> <span class="o">=</span> <span class="s2">&quot;0101 0110 1111 0011 0011 1111 1100 0000 1111 0000 1010 0101 0110 0101 0000 1111&quot;</span>
<span class="n">keystream</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">keystream</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)]</span>
<span class="n">keystream</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keystream</span><span class="p">]</span> <span class="c1"># Find K_{1704} from K_{1703} by table 1</span>
<span class="n">keystream</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">04b</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keystream</span><span class="p">)</span>
<span class="n">keystream</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">keystream</span><span class="p">))</span>

<span class="n">plaintext</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">^</span><span class="n">k</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">keystream</span><span class="p">)]</span>  <span class="c1"># Recover plaintext</span>
<span class="n">plaintext</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">))</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span> <span class="o">==</span> <span class="mi">64</span>
<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">plaintext</span><span class="p">[:</span><span class="mi">32</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">plaintext</span><span class="p">[</span><span class="mi">32</span><span class="p">:],</span> <span class="mi">2</span><span class="p">)</span>     <span class="c1"># Extract first 32 bits and last 32 bits</span>

<span class="n">latitude</span> <span class="o">=</span> <span class="n">ieee_754_conversion</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>   <span class="c1"># Convert first 32 bits to latitude</span>
<span class="n">longitude</span> <span class="o">=</span> <span class="n">ieee_754_conversion</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># Convert last 32 bits to longitude</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">latitude</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">longitude</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Mình nhận được tọa độ là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(-25.79496192932129, 146.58416748046875).\]</div>
</div>
<p>Tọa độ này chỉ tới Australia (Augathella), cụ thể là một công viên tên là &quot;Meat Ant Park&quot;. Chữ &quot;Ant&quot; có vẻ khớp với đề bài.</p>
</section>
</section>
<section id="steganography-and-codes">
<h2>Steganography and codes<a class="headerlink" href="#steganography-and-codes" title="Link to this heading">¶</a></h2>
<p>Đây là bài 3 ở round 2.</p>
<section id="id3">
<h3>Đề bài<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>Sam và Betty sử dụng kênh mở cho giao tiếp bí mật. Họ không muốn ai biết về hội thoại của mình.</p>
<p>Sam có thể gửi co Betty một trong <span class="math notranslate nohighlight">\(16\)</span> thông điệp.</p>
<p>Khi đó, Sam lấy một ảnh với format RGB bất kì, đổi pixel đầu tiên theo cách nào đó và publish lên website.</p>
<p>Betty sẽ tải bức ảnh đó xuống và phân tích xem Sam đã gửi thông điệp nào.</p>
<p>Sam sẽ làm gì với bức ảnh? Chúng ta nên chú ý rằng phải thay đổi pixel sao cho không thể nhận biết sự thay đổi bởi mắt thường.</p>
<p>Cụ thể, mỗi pixel RGB được biểu diễn ở dạng <span class="math notranslate nohighlight">\(24\)</span> bit:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(8\)</span> bit đầu là độ sáng của màu đỏ <span class="math notranslate nohighlight">\((r_1, \ldots, r_8)\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(8\)</span> bit tiếp theo là độ sáng màu xanh lá <span class="math notranslate nohighlight">\((g_1, \ldots, g_8)\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(8\)</span> bit cuối là độ sáng màu xanh dương <span class="math notranslate nohighlight">\((b_1, \ldots, b_8)\)</span>.</p></li>
</ul>
<p>Sam không được thay đổi các bit <span class="math notranslate nohighlight">\(r\)</span>, <span class="math notranslate nohighlight">\(g\)</span>, <span class="math notranslate nohighlight">\(b\)</span> từ <span class="math notranslate nohighlight">\(1\)</span> tới <span class="math notranslate nohighlight">\(5\)</span> vì điều đó sẽ dễ nhận thấy khi nhìn bằng mắt.</p>
<p>Nếu Sam đổi một trong các bit <span class="math notranslate nohighlight">\(r_6\)</span>, <span class="math notranslate nohighlight">\(r_7\)</span>, <span class="math notranslate nohighlight">\(g_6\)</span>, <span class="math notranslate nohighlight">\(g_7\)</span> và <span class="math notranslate nohighlight">\(b_6\)</span> sẽ tốn <span class="math notranslate nohighlight">\(2\)</span> coins mỗi lần đổi.</p>
<p>Nếu Sam đổi một trong các bit <span class="math notranslate nohighlight">\(r_8\)</span>, <span class="math notranslate nohighlight">\(g_8\)</span>, <span class="math notranslate nohighlight">\(b_7\)</span> và <span class="math notranslate nohighlight">\(b_8\)</span> thì tốn <span class="math notranslate nohighlight">\(1\)</span> coin mỗi lần đổi.</p>
<p>Hãy đưa ra một phương pháp coding cho <span class="math notranslate nohighlight">\(16\)</span> thông điệp vào một pixel mà tốn không quá <span class="math notranslate nohighlight">\(2\)</span> coins (mà không thể nhận thấy bằng mắt thường).</p>
<p>Thêm nữa hãy đưa ra một phương để Betty có thể biết được thông điệp mà Sam giấu vào ảnh là gì. Lưu ý rằng Betty không biết ảnh gốc như thế nào.</p>
</section>
<section id="id4">
<h3>Lời giải<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>Tạm thời trống.</p>
</section>
</section>
<section id="weak-key-schedule-for-des">
<h2>Weak key schedule for DES<a class="headerlink" href="#weak-key-schedule-for-des" title="Link to this heading">¶</a></h2>
<p>Đây là bài 6 ở round 1 và bài 4 ở round 2.</p>
<section id="id5">
<h3>Đề bài<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>Alice sử dụng thuật toán DES để mã hóa file <cite>Book.txt</cite> thành <cite>Book_Cipher.txt</cite>. Tuy nhiên khi code thuật toán DES thì Alice đã code lỗi và khiến cả thuật toán chỉ sử dụng subkey đầu tiên cho tất cả các vòng (thay vì mỗi vòng mỗi khóa con như DES chuẩn).</p>
<p>Hãy giúp Carol tìm lại khóa ban đầu và decrypt bản mã sau:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">86991641</span><span class="n">D28259604412D6BA88A5C0A6471CA722</span>
<span class="mi">2</span><span class="n">C52482BF2D0E841D4343DFB877DC8E0147F3D5F</span>
<span class="mi">20</span><span class="n">FC18FF28CB5C4DA8A0F4694861AB5E98F37ADB</span>
<span class="n">C2D69B35779D9001BB4B648518FE6EBC00B2AB10</span>
</pre></div>
</div>
</section>
<section id="id6">
<h3>Lời giải<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>Bài này được giải bởi bạn Chương và được thêm BEST SOLUTION :)))</p>
<p>Ý tưởng của bài này là slide attack. Các bạn có thể xem lời giải ở bài viết về <a class="reference external" href="../../cryptanalysis/slide-attack">slide attack</a> của mình.</p>
</section>
</section>
<section id="reverse-engineering">
<h2>Reverse engineering<a class="headerlink" href="#reverse-engineering" title="Link to this heading">¶</a></h2>
<p>Đây là bài 5 ở round 2.</p>
<section id="id7">
<h3>Đề bài<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<p>Sau khi reverse engineering cài đặt của một thuật toán mật mã nào đó chưa biết thì Bob nhận được hàm boolean sau:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_{2n} (x_1, \ldots, x_{2n}) = \bigoplus_{i=1}^n x_i x_{i+n} \prod_{j=i+1}^n (x_j \oplus x_{j + n}).\]</div>
</div>
<p>Bob cố gắng hiểu ý nghĩa mật mã của hàm boolean trên là gì, và nhanh chóng tìm thấy một &quot;liên hệ&quot;. Đây là hàm gì?</p>
<figure class="align-default">
<img alt="../../_images/cast.png" src="../../_images/cast.png" />
</figure>
</section>
<section id="mo-dau">
<h3>Mở đầu<a class="headerlink" href="#mo-dau" title="Link to this heading">¶</a></h3>
<p>Bài này mình chứng minh được tính chất của hàm đề bài cho chứ không tìm ra ý nghĩa của hàm nên chỉ được 4/6 điểm.</p>
<p>Tham khảo lời giải của team JPY thì đây là hàm kiểm tra tràn bit số nguyên (integer overflow).</p>
<p>Mình sẽ trình bày cả cách giải của mình lẫn cách giải của team bạn.</p>
<p>Hình đề cho là CAST cipher - tiêu chuẩn mã hóa của Canada.</p>
<p>S-boxes trong CAST cipher được lựa chọn từ các hàm boolean có nonlinearity cao nhất nên trong lúc làm bài mình cắm đầu vào tìm một tính chất gì đó của hàm boolean trên liên quan tới nonlinearity.</p>
<p>Mình đã chứng minh được hai điều:</p>
<ul class="simple">
<li><p>trọng số Hamming của hàm <span class="math notranslate nohighlight">\(f_{2n}\)</span> bằng <span class="math notranslate nohighlight">\(2^{n-1} \cdot (2^n - 1)\)</span>;</p></li>
<li><p>nonlinearity của hàm <span class="math notranslate nohighlight">\(f_{2n}\)</span> bằng <span class="math notranslate nohighlight">\(2^{2n-2}\)</span>.</p></li>
</ul>
<p>Nhắc lại hàm boolean <span class="math notranslate nohighlight">\(f_{2n}\)</span> đề cho là hàm</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_{2n}(x_1, \ldots, x_{2n}) = \bigoplus_{i=1}^n x_i x_{i+n} \prod_{j=i+1}^n (x_j \oplus x_{j+n}).\]</div>
</div>
</section>
<section id="trong-so-hamming-cua-ham-boolean">
<h3>Trọng số Hamming của hàm boolean<a class="headerlink" href="#trong-so-hamming-cua-ham-boolean" title="Link to this heading">¶</a></h3>
<p>Để tìm công thức hoặc tính chất thì thường mình sẽ thử với các số nhỏ và sau đó đoán công thức.</p>
<p>Với <span class="math notranslate nohighlight">\(n = 1\)</span> thì <span class="math notranslate nohighlight">\(f_2(x_1, x_2) = x_1 x_2\)</span>. Dễ thấy rằng <span class="math notranslate nohighlight">\(f_2 = 1\)</span> khi <span class="math notranslate nohighlight">\(x_1 = x_2 = 1\)</span>.</p>
<p>Thay vì viết bảng chân trị gồm <span class="math notranslate nohighlight">\(4\)</span> dòng thì mình viết thành bảng ô vuông <span class="math notranslate nohighlight">\(2 \times 2\)</span>:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td></td>
<td><p><span class="math notranslate nohighlight">\(x_2 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(x_2 = 1\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(x_1 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_2 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_2 = 0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(x_1 = 1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_2 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_2 = {\color{red}1}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Với <span class="math notranslate nohighlight">\(n = 2\)</span> thì hàm boolean là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_4(x_1, x_, x_3, x_4) = \left[x_1 x_3 (x_2 \oplus x_4)\right] \oplus x_2 x_4 = x_1 x_2 x_3 \oplus x_1 x_3 x_4 \oplus x_2 x_4.\]</div>
</div>
<p>Cũng tương tự, mình viết bảng chân trị thành bảng ô vuông <span class="math notranslate nohighlight">\(4 \times 4\)</span>:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td></td>
<td><p><span class="math notranslate nohighlight">\(x_3 x_4 = 00\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(x_3 x_4 = 01\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(x_3 x_4 = 10\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(x_3 x_4 = 11\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(x_1 x_2 = 00\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = 0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(x_1 x_2 = 01\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = {\color{red}1}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(x_1 x_2 = 10\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = {\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = {\color{red}1}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(x_1 x_2 = 11\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = 0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = {\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = {\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(f_4 = {\color{red}1}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Với <span class="math notranslate nohighlight">\(n = 3\)</span> thì mình viết bảng chân trị thành bảng <span class="math notranslate nohighlight">\(8 \times 8\)</span>:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td></td>
<td><p><span class="math notranslate nohighlight">\(000\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(001\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(010\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(011\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(100\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(101\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(110\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(111\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(000\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(001\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(010\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(011\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(100\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(101\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(110\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(111\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\({\color{red}1}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Đến đây thì mình nhận thấy hàm <span class="math notranslate nohighlight">\(f_{2n}\)</span> sẽ nhận giá trị <span class="math notranslate nohighlight">\(1\)</span> tại:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(1\)</span> ô hàng thứ hai;</p></li>
<li><p><span class="math notranslate nohighlight">\(2\)</span> ô hàng thứ ba;</p></li>
<li><p>...</p></li>
<li><p><span class="math notranslate nohighlight">\(2^n-1\)</span> ô hàng cuối.</p></li>
</ul>
<p>Như vậy trọng số Hamming được dự đoán là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[1 + 2 + \ldots + (2^n - 1) = \dfrac{(2^n - 1) \cdot 2^n}{2} = 2^{n-1} \cdot (2^n - 1).\]</div>
</div>
<p>Sau đây mình sẽ chứng minh công thức trọng số Hamming này bằng quy nạp.</p>
<p>Với <span class="math notranslate nohighlight">\(n = 1\)</span>, hàm <span class="math notranslate nohighlight">\(f_2(x_1, x_2) = x_1 x_2\)</span> có trọng số Hamming là <span class="math notranslate nohighlight">\(1 = 2^{1-1} \cdot (2^1 - 1)\)</span>. Như vậy công thức đúng với <span class="math notranslate nohighlight">\(n = 1\)</span>.</p>
<p>Giả sử công thức đúng với <span class="math notranslate nohighlight">\(n = k \geqslant 1\)</span>, nghĩa là hàm</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_{2k}(x_1, \ldots, x_{2k}) = \bigoplus_{i=1}^k x_i x_{i+k} \prod_{j=i+1}^k (x_j \oplus x_{j+k})\]</div>
</div>
<p>có trọng số Hamming là <span class="math notranslate nohighlight">\(2^{k-1} \cdot (2^k - 1)\)</span>.</p>
<p>Với <span class="math notranslate nohighlight">\(n = k + 1\)</span>, xét hàm</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_{2k+2}(x_1, \ldots, x_k, y, x_{k+1}, \ldots, x_{2k}, z) = \bigoplus_{i=1}^k x_i x_{i+k} \left[ \prod_{j=i+1}^k (x_j \oplus x_{j+k}) \cdot (y \oplus z)  \right] \oplus yz.\]</div>
</div>
<p>Ta có các trường hợp sau:</p>
<ul class="simple">
<li><p>khi <span class="math notranslate nohighlight">\(y = z = 0\)</span> thì <span class="math notranslate nohighlight">\(y \oplus z = 0\)</span> và <span class="math notranslate nohighlight">\(yz = 0\)</span>. Khi đó mọi phép nhân <span class="math notranslate nohighlight">\(\prod\limits_{j=i+1}^k (x_j \oplus x_{j+k}) \cdot (y \oplus z) = 0\)</span> nên khiến cả hàm <span class="math notranslate nohighlight">\(f_{2k+2} = 0\)</span> tại tất cả vector <span class="math notranslate nohighlight">\((x_1, \ldots, x_{2k})\)</span>;</p></li>
<li><p>khi <span class="math notranslate nohighlight">\(y = 0\)</span> và <span class="math notranslate nohighlight">\(z = 1\)</span> thì <span class="math notranslate nohighlight">\(y \oplus z = 1\)</span> và <span class="math notranslate nohighlight">\(yz = 0\)</span>. Thay vào hàm <span class="math notranslate nohighlight">\(f_{2k+2}\)</span> ta có</p></li>
</ul>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_{2k+2}(x_1, \ldots, x_k, 0, x_{k+1}, \ldots, x_{2k}, 1) = \bigoplus_{i=1}^k x_i x_{i+k} \left[ \prod_{j=i+1}^k (x_j \oplus x_{j+k}) \cdot 1 \right] \oplus 0 \equiv f_{2k}(x_1, \ldots, x_{2k}).\]</div>
</div>
<p>Như vậy khi <span class="math notranslate nohighlight">\(y = 0\)</span> và <span class="math notranslate nohighlight">\(z = 1\)</span> thì <span class="math notranslate nohighlight">\(f_{2k+2}\)</span> chính xác bằng <span class="math notranslate nohighlight">\(f_{2k}\)</span>. Nghĩa là trọng số Hamming của <span class="math notranslate nohighlight">\(f_{2k+2}\)</span> lúc này bằng trọng số Hamming của <span class="math notranslate nohighlight">\(f_{2k}\)</span> và bằng <span class="math notranslate nohighlight">\(2^{k-1} \cdot (2^k - 1)\)</span> theo giả thiết quy nạp.</p>
<ul class="simple">
<li><p>khi <span class="math notranslate nohighlight">\(y = 1\)</span> và <span class="math notranslate nohighlight">\(z = 0\)</span> thì tương tự, trọng số Hamming của <span class="math notranslate nohighlight">\(f_{2k+2}\)</span> trong trường hợp này cũng bằng <span class="math notranslate nohighlight">\(2^{k-1} \cdot (2^k - 1)\)</span>.</p></li>
<li><p>khi <span class="math notranslate nohighlight">\(y = z = 1\)</span> thì <span class="math notranslate nohighlight">\(y \oplus z = 0\)</span> và <span class="math notranslate nohighlight">\(yz = 1\)</span>. Khi đó tất cả biểu thức <span class="math notranslate nohighlight">\(\prod\limits_{j=i+1}^k (x_j \oplus x_{j+k}) \cdot (y \oplus z) = 0\)</span> nên hàm <span class="math notranslate nohighlight">\(f_{2k+2} = 1\)</span> với mọi đầu vào <span class="math notranslate nohighlight">\((x_1, \ldots, x_{2k}) \in \mathbb{F}_2^{2k}\)</span>. Như vậy trọng số Hamming của <span class="math notranslate nohighlight">\(f_{2k+2}\)</span> ở trường hợp này là <span class="math notranslate nohighlight">\(2^{2k}\)</span>.</p></li>
</ul>
<p>Kết hợp bốn trường hợp lại thì trọng số Hamming của <span class="math notranslate nohighlight">\(f_{2k+2}\)</span> là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathrm{wt}(f_{2k}) = 2^{k-1} \cdot (2^k - 1) \cdot 2 + 2^{2k} = 2^k (2^{k+1} - 1).\]</div>
</div>
<p>Như vậy công thức trọng số Hamming đúng với <span class="math notranslate nohighlight">\(k + 1\)</span> nên theo quy nạp thì công thức đúng với mọi <span class="math notranslate nohighlight">\(n \geqslant 1\)</span>.</p>
</section>
<section id="bien-doi-walsh-hadamard-va-nonlinearity">
<h3>Biến đổi Walsh-Hadamard và nonlinearity<a class="headerlink" href="#bien-doi-walsh-hadamard-va-nonlinearity" title="Link to this heading">¶</a></h3>
<p>Gọi <span class="math notranslate nohighlight">\(W_f(\bm{a})\)</span> là hệ số Walsh của hàm boolean <span class="math notranslate nohighlight">\(f\)</span> (trên <span class="math notranslate nohighlight">\(2n\)</span> biến) ứng với vector <span class="math notranslate nohighlight">\(\bm{a} \in \mathbb{F}_2^{2n}\)</span>.</p>
<p>Đặt <span class="math notranslate nohighlight">\(\bm{0}\)</span> là vector độ dài <span class="math notranslate nohighlight">\(2n\)</span> chỉ gồm các số <span class="math notranslate nohighlight">\(0\)</span>, nghĩa là <span class="math notranslate nohighlight">\(\bm{0} = (0, \ldots, 0)\)</span>.</p>
<p>Một tính chất đơn giản của phổ Walsh là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[W_f(\bm{0}) = 2^{2n} - 2 \cdot \mathrm{wt}(f),\]</div>
</div>
<p>với <span class="math notranslate nohighlight">\(f\)</span> là hàm boolean <span class="math notranslate nohighlight">\(2n\)</span> biến.</p>
<p>Từ kết quả về trọng số ở trên, thay vào công thức ta có</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[W_f(\bm{0}) = 2^{2n} - 2 \cdot 2^{n-1} \cdot (2^n - 1) = 2^n.\]</div>
</div>
<p>Bây giờ xét hệ số Walsh cho vector dạng</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\bm{a} = (0, 0, \ldots, a_n, 0, 0, \ldots, a_{2n}).\]</div>
</div>
<p>Công thức tính hệ số Walsh là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[W_f(\bm{a}) = \sum_{\bm{x} \in \mathbb{F}_2^{2n}} (-1)^{f(\bm{x}) \oplus x_n a_n \oplus x_{2n} a_{2n}}.\]</div>
</div>
<p>Nếu <span class="math notranslate nohighlight">\(a_n = a_{2n} = 0\)</span> thì ta có trường hợp <span class="math notranslate nohighlight">\(W_f(\bm{0})\)</span> như vừa rồi.</p>
<p>Nếu <span class="math notranslate nohighlight">\(a_n = 1\)</span> và <span class="math notranslate nohighlight">\(a_{2n} = 0\)</span> ta sẽ chứng minh hệ số Walsh lúc này có giá trị tuyệt đối lớn nhất. Tương tự đối với <span class="math notranslate nohighlight">\(a_n = 0\)</span> và <span class="math notranslate nohighlight">\(a_{2n} = 1\)</span> cũng sẽ cho hệ số Walsh có giá trị tuyệt đối lớn nhất.</p>
<p>Khi <span class="math notranslate nohighlight">\(a_n = 1\)</span> và <span class="math notranslate nohighlight">\(a_{2n} = 0\)</span> thì hệ số Walsh sẽ có dạng</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[W_f(\bm{a}) = \sum_{\bm{x} \in \mathbb{F}_2^{2n}} (-1)^{f(\bm{x}) \oplus x_n},\]</div>
</div>
<p>ở đây <span class="math notranslate nohighlight">\(\bm{x} = (x_1, \ldots, x_{2n})\)</span>.</p>
<p>Ta có hai trường hợp:</p>
<p><strong>Trường hợp 1.</strong> Nếu <span class="math notranslate nohighlight">\(x_n = 0\)</span> thì trong số <span class="math notranslate nohighlight">\(2^{2n-1}\)</span> vector <span class="math notranslate nohighlight">\((x_1, \ldots, x_{n-1}, 0, x_{n+1}, \ldots, x_{2n})\)</span>, ta cần tìm số lượng vector khiến <span class="math notranslate nohighlight">\(f_{2n} = 1\)</span>.</p>
<p>Theo chứng minh về trọng số Hamming ở trên thì nếu <span class="math notranslate nohighlight">\(x_{2n} = 0\)</span> thì hàm <span class="math notranslate nohighlight">\(f_{2n}\)</span> (hiện là hàm <span class="math notranslate nohighlight">\(2n - 2\)</span> biến do <span class="math notranslate nohighlight">\(x_n\)</span> và <span class="math notranslate nohighlight">\(x_{2n}\)</span> đã cố định) sẽ luôn có giá trị <span class="math notranslate nohighlight">\(0\)</span>. Tuy nhiên chỉ với dữ liệu này thì không đủ để biết có bao nhiêu vector khiến <span class="math notranslate nohighlight">\(f_{2n} = 1\)</span>.</p>
<p>Thay đổi cách tiếp cận nhưng xét <span class="math notranslate nohighlight">\(x_{2n} = 1\)</span>, khi đó hàm <span class="math notranslate nohighlight">\(f_{2n}\)</span> cũng là hàm <span class="math notranslate nohighlight">\(2n - 2\)</span> biến do <span class="math notranslate nohighlight">\(x_n\)</span> và <span class="math notranslate nohighlight">\(x_{2n}\)</span> đã cố định, nhưng hàm <span class="math notranslate nohighlight">\(f_{2n}\)</span> sẽ bằng <span class="math notranslate nohighlight">\(1\)</span> tại đúng <span class="math notranslate nohighlight">\(2^{n-2} \cdot (2^{n-1} - 1)\)</span> vectors trong số <span class="math notranslate nohighlight">\(2^{2n-1}\)</span> vectors đang xét. Vậy theo nguyên lý bù trừ thì <span class="math notranslate nohighlight">\(f_{2n} = 0\)</span> tại</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[2^{2n-1} - 2^{n-2} \cdot (2^{n-1} - 1) = 3 \cdot 2^{2n-3} + 2^{n-2} \ \text{vectors}.\]</div>
</div>
<p>Lúc này ta có thể tính</p>
<div class="math-wrapper docutils container" id="equation-nsu24-p5-1">
<div class="math notranslate nohighlight" id="equation-nsu24-p5-1">
<span class="eqno">(11)<a class="headerlink" href="#equation-nsu24-p5-1" title="Link to this equation">¶</a></span>\[\begin{split}\sum_{\substack{\bm{x} \in \mathbb{F}_2^{2n} \\ x_n = 0}} (-1)^{f(\bm{x}) \oplus 0} = (-1)^{0} \cdot \left[ 2^{n-2} \cdot (2^{n-1} - 1) \right] + (-1)^{1} \cdot (3 \cdot 2^{2n-3} + 2^{n-2}) = 2^{2n-2} + 2^{n-1}.\end{split}\]</div>
</div>
<p><strong>Trường hợp 2.</strong> Nếu <span class="math notranslate nohighlight">\(x_n = 1\)</span>, tương tự, trong số <span class="math notranslate nohighlight">\(2^{2n-1}\)</span> vector <span class="math notranslate nohighlight">\((x_1, \ldots, x_{n-1}, 1, x_{n+1}, \ldots, x_{2n})\)</span> ta cần tìm xem có bao nhiêu vector khiến <span class="math notranslate nohighlight">\(f_{2n} = 1\)</span>.</p>
<p>Sử dụng chứng minh cho trọng số Hamming ở trên thì</p>
<ol class="arabic simple">
<li><p>Nếu <span class="math notranslate nohighlight">\(x_{2n} = 0\)</span> thì</p></li>
</ol>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_{2n}(x_1, \ldots, x_{n-1}, 1, x_{n+1}, \ldots, 0)\]</div>
</div>
<p>bằng <span class="math notranslate nohighlight">\(1\)</span> tại <span class="math notranslate nohighlight">\(2^{n-2} \cdot (2^{n-1} - 1)\)</span> vectors.</p>
<ol class="arabic simple" start="2">
<li><p>Nếu <span class="math notranslate nohighlight">\(x_{2n} = 1\)</span> thì</p></li>
</ol>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_{2n}(x_1, \ldots, x_{n-1}, 1, x_{n+1}, \ldots, 1)\]</div>
</div>
<p>bằng <span class="math notranslate nohighlight">\(1\)</span> tại tất cả <span class="math notranslate nohighlight">\(2^{2n-2}\)</span> vectors.</p>
<p>Tổng kết lại, hàm <span class="math notranslate nohighlight">\(f_{2n} = 1\)</span> tại</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A = 2^{n-2} \cdot (2^{n-1} - 1) + 2^{2n-2}\]</div>
</div>
<p>vectors. Điều này dẫn tới <span class="math notranslate nohighlight">\(f_{2n} = 0\)</span> tại <span class="math notranslate nohighlight">\(2^{2n-1} - A\)</span> vectors.</p>
<p>Ở đây do <span class="math notranslate nohighlight">\(x_n = 1\)</span> nên khi tính <span class="math notranslate nohighlight">\(\sum (-1)^{f(\bm{x}) \oplus 1}\)</span> ta cần chuyển dấu</p>
<div class="math-wrapper docutils container" id="equation-nsu24-p5-2">
<div class="math notranslate nohighlight" id="equation-nsu24-p5-2">
<span class="eqno">(12)<a class="headerlink" href="#equation-nsu24-p5-2" title="Link to this equation">¶</a></span>\[\begin{split}\sum_{\substack{\bm{x} \in \mathbb{F}_2^{2n} \\ x_n = 1}} (-1)^{f(\bm{x}) \oplus 1} = &amp; (-1) \cdot (2^{2n-1} - A) + 1 \cdot A = 2A - 2^{2n-1} \\ = &amp; 2^{2n-1} + 2^{n-1} \cdot (2^{n-1} - 1) - 2^{2n-1} = 2^{2n-2} - 2^{n-1}.\end{split}\]</div>
</div>
<p>Kết hợp <a class="reference internal" href="#equation-nsu24-p5-1">(11)</a> và <a class="reference internal" href="#equation-nsu24-p5-2">(12)</a> ta có hệ số Walsh ứng với vector <span class="math notranslate nohighlight">\(\bm{a}\)</span> có <span class="math notranslate nohighlight">\(a_n = 1\)</span> là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[W_f(\bm{a}) = 2^{2n-2} + 2^{n-1} + 2^{2n-2} - 2^{n-1} = 2^{2n-1}.\]</div>
</div>
<p>Tương tự, tại vector <span class="math notranslate nohighlight">\(\bm{a}'\)</span> có <span class="math notranslate nohighlight">\(a_{2n} = 1\)</span> thì ta cũng có <span class="math notranslate nohighlight">\(W_f(\bm{a}') = 2^{2n-1}\)</span>.</p>
<p>Theo định lí Parseval thì</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\sum_{\bm{a} \in \mathbb{F}_2^n} (W_f(a))^2 = 2^{2 \cdot 2n} = 2^{4n}\]</div>
</div>
<p>vì <span class="math notranslate nohighlight">\(f\)</span> ở đây là hàm boolean <span class="math notranslate nohighlight">\(2n\)</span> biến.</p>
<p>Như vậy ta chỉ cần chứng minh được rằng không tồn tại vector nào khác <span class="math notranslate nohighlight">\(\bm{a}\)</span> và <span class="math notranslate nohighlight">\(\bm{a}'\)</span> có hệ số Walsh lớn hơn hoặc bằng <span class="math notranslate nohighlight">\(2^{2n-1}\)</span>.</p>
<p>Thật vậy, do tính giao hoán của phép XOR (phép cộng) và phép nhân nên công thức của <span class="math notranslate nohighlight">\(f_{2n}\)</span> cho thấy hai bộ <span class="math notranslate nohighlight">\((x_1, \ldots, x_n)\)</span> và <span class="math notranslate nohighlight">\((x_{n+1}, \ldots, x_{2n})\)</span> có thể thay thế nhau, nghĩa là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_{2n}(x_1, \ldots, x_n, x_{n+1}, \ldots, x_{2n}) \equiv f_{2n}(x_{n+1}, \ldots, x_{2n}, x_1, \ldots, x_{n}).\]</div>
</div>
<p>Do đó hệ số Walsh cũng có tính đối xứng như vậy. Nếu tồn tại vector <span class="math notranslate nohighlight">\(\bm{b}\)</span> có hệ số Walsh <span class="math notranslate nohighlight">\(W_f(\bm{b}) \geqslant 2^{2n-1}\)</span> thì cũng tồn tại vector <span class="math notranslate nohighlight">\(\bm{b}'\)</span> khác <span class="math notranslate nohighlight">\(\bm{b}\)</span> có hệ số Walsh <span class="math notranslate nohighlight">\(W_f(\bm{b}') \geqslant 2^{2n-1}\)</span>.</p>
<p>Khi đó ta có</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\underbrace{(W_f(\bm{a}))^2}_{=(2^{2n-1})^2} + \underbrace{(W_f(\bm{a}'))^2}_{=(2^{2n-1})^2} + \underbrace{(W_f(\bm{0}))^2}_{=(2^n)^2} + \underbrace{(W_f(\bm{b}))^2}_{&gt; (2^{2n-1})^2} + \underbrace{(W_f(\bm{b}'))^2}_{&gt; (2^{2n-1})^2} &gt; 2^{4n} + 2^{2n}.\]</div>
</div>
<p>Điều này vô lý theo đẳng thức Parseval nên không tồn tại vector <span class="math notranslate nohighlight">\(\bm{b}\)</span> có hệ số Walsh lớn hơn hoặc bằng <span class="math notranslate nohighlight">\(2^{2n-1}\)</span>.</p>
<p>Như vậy giá trị tuyệt đối lớn nhất trong các hệ số Walsh là <span class="math notranslate nohighlight">\(2^{2n-1}\)</span>, từ đó nonlinearity là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[N_f = 2^{2n-1} - \frac{1}{2} \max \lvert W_f(\bm{a}) \rvert = 2^{2n-1} - \frac{1}{2} \cdot 2^{2n-1} = 2^{2n-1} - 2^{2n-2} = 2^{2n-2}.\]</div>
</div>
<p>Như vậy mình đã chứng minh xong công thức cho nonlinearity.</p>
</section>
<section id="loi-giai-cua-team-jpy-va-goi-y-cua-thay-kolomeec">
<h3>Lời giải của team JPY và gợi ý của thầy Kolomeec<a class="headerlink" href="#loi-giai-cua-team-jpy-va-goi-y-cua-thay-kolomeec" title="Link to this heading">¶</a></h3>
<p>Sau khi hết giải thì mình hỏi ý kiến thầy Kolomeec về cách làm của mình thì có vẻ là không khớp đáp án. Đáp án là nếu ta xem hai vector <span class="math notranslate nohighlight">\((x_1, \ldots, x_n)\)</span> và <span class="math notranslate nohighlight">\((x_{n+1}, \ldots, x_{2n})\)</span> như các số nguyên, tức là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}u &amp; = x_1 + 2 x_2 + \ldots + 2^{n-1} x_n, \\
v &amp; = x_{n+1} + 2 x_{n+2} + \ldots + 2^{n-1} x_{2n},\end{split}\]</div>
</div>
<p>thì hàm boolean <span class="math notranslate nohighlight">\(f_{2n}\)</span> có giá trị <span class="math notranslate nohighlight">\(1\)</span> nếu <span class="math notranslate nohighlight">\(u + v \geqslant 2^n\)</span> và ngược lại, đạt giá trị <span class="math notranslate nohighlight">\(0\)</span> nếu <span class="math notranslate nohighlight">\(u + v &lt; 2^n\)</span>.</p>
<p>Gợi ý của thầy hoàn toàn khớp với bài giải của team JPY, trong đó nói rằng hàm <span class="math notranslate nohighlight">\(f_{2n}\)</span> là hàm kiểm tra tràn số khi cộng hai số nguyên (integer overflow). Ví dụ khi cộng hai số kiểu <cite>unsigned int</cite> thì có thể xảy ra hiện tượng tràn bit vì <cite>unsigned int</cite> chỉ có <span class="math notranslate nohighlight">\(32\)</span> bit. Điều này hợp lý vì CAST cipher có một phép cộng modulo <span class="math notranslate nohighlight">\(2^{32}\)</span>, nghĩa là có liên quan đến hình vẽ.</p>
<p>Mình cũng sẽ dùng quy nạp để chứng minh khi <span class="math notranslate nohighlight">\(u + v \geqslant 2^n\)</span> thì <span class="math notranslate nohighlight">\(f_{2n}\)</span> nhận giá trị <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>Với <span class="math notranslate nohighlight">\(n = 1\)</span>, hàm <span class="math notranslate nohighlight">\(f_2(x_1, x_2) = x_1 x_2\)</span> nhận giá trị <span class="math notranslate nohighlight">\(1\)</span> khi <span class="math notranslate nohighlight">\(x_1 = x_2 = 1\)</span>. Lúc này <span class="math notranslate nohighlight">\(u = x_1 = 1\)</span> và <span class="math notranslate nohighlight">\(v = x_2 = 1\)</span> nên <span class="math notranslate nohighlight">\(u + v = 2 \geqslant 2^1\)</span>. Như vậy mệnh đề đúng với <span class="math notranslate nohighlight">\(n = 1\)</span>.</p>
<p>Giả thiết quy nạp: giả sử mệnh đề đúng với <span class="math notranslate nohighlight">\(n = k \geqslant 1\)</span>, nghĩa là hàm boolean</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_{2k}(x_1, \ldots, x_k, x_{k+1}, \ldots, x_{2k}) = 1\]</div>
</div>
<p>khi <span class="math notranslate nohighlight">\(u + v \geqslant 2^k\)</span> với</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}u &amp; = x_1 + 2 x_2 + \ldots + 2^{k-1} x_k, \\
v &amp; = x_{k+1} + 2 x_{k+2} + \ldots + 2^{k-1} x_{2k}.\end{split}\]</div>
</div>
<p>Với <span class="math notranslate nohighlight">\(n = k + 1\)</span>, xét hàm</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_{2k+2}(x_1, \ldots, x_k, y, x_{k+1}, \ldots, x_{2k}, z) = \bigoplus_{i=1}^k x_i x_{i+k} \left[\prod_{j=i+1}^k (x_j \oplus x_{j+k}) \cdot (y \oplus z)\right] \oplus yz.\]</div>
</div>
<p>Mình cũng sẽ có bốn trường hợp cho <span class="math notranslate nohighlight">\((y, z)\)</span>:</p>
<ol class="arabic simple">
<li><p>Khi <span class="math notranslate nohighlight">\(y = z = 0\)</span> thì <span class="math notranslate nohighlight">\(f_{2k+2} = 0\)</span> với mọi <span class="math notranslate nohighlight">\((x_1, \ldots, x_{2k})\)</span> nên chúng ta bỏ qua.</p></li>
<li><p>Khi <span class="math notranslate nohighlight">\(y = 1\)</span> và <span class="math notranslate nohighlight">\(z = 0\)</span> thì <span class="math notranslate nohighlight">\(f_{2k+2} \equiv f_{2k}\)</span> như chứng minh ở phần trên. Khi đó <span class="math notranslate nohighlight">\(f_{2k+2}\)</span> bằng <span class="math notranslate nohighlight">\(1\)</span> tại các vector <span class="math notranslate nohighlight">\((x_1, \ldots, x_{2k})\)</span> khiến <span class="math notranslate nohighlight">\(f_{2k}\)</span> bằng <span class="math notranslate nohighlight">\(1\)</span>, nói cách khác là</p></li>
</ol>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}u' &amp; = x_1 + 2 x_2 + \ldots + 2^{k-1} x_k + 2^k y = u + 2^k y, \\
v' &amp; = x_{k+1} + 2 x_{k+2} + \ldots + 2^{k-1} x_{2k} + 2^k z = v + 2^k z.\end{split}\]</div>
</div>
<p>Với <span class="math notranslate nohighlight">\(y = 1\)</span> và <span class="math notranslate nohighlight">\(z = 0\)</span> thì</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[u' + v' = u + 2^k y + v = (u + v) + 2^k y \geqslant 2^k + 2^k \cdot 1 = 2^{k+1}.\]</div>
</div>
<p>Như vậy nếu <span class="math notranslate nohighlight">\(y = 1\)</span> và <span class="math notranslate nohighlight">\(z = 0\)</span> thì mệnh đề cần chứng minh đúng cho <span class="math notranslate nohighlight">\(n = k + 1\)</span>.</p>
<ol class="arabic simple">
<li><p>Khi <span class="math notranslate nohighlight">\(y = 0\)</span> và <span class="math notranslate nohighlight">\(z = 1\)</span>, chứng minh tương tự trường hợp <span class="math notranslate nohighlight">\(y = 1\)</span> và <span class="math notranslate nohighlight">\(z = 0\)</span>.</p></li>
<li><p>Khi <span class="math notranslate nohighlight">\(y = 1\)</span> và <span class="math notranslate nohighlight">\(z = 1\)</span> thì <span class="math notranslate nohighlight">\(f_{2k+2}\)</span> luôn bằng <span class="math notranslate nohighlight">\(1\)</span>, tương ứng với</p></li>
</ol>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[u' + v' = u + 2^k y + v + 2^k z = (u + v) + 2^k \cdot (1 + 1) \geqslant 2^k + 2 \cdot 2^k &gt; 2^{k+1}.\]</div>
</div>
<p>Như vậy mệnh đề đúng cho <span class="math notranslate nohighlight">\(n = k + 1\)</span> với mọi trường hợp <span class="math notranslate nohighlight">\((y, z)\)</span> và ta có điều cần chứng minh.</p>
</section>
</section>
<section id="open-competition-nsucrypto-lightweight-cipher">
<h2>Open competition: NSUCRYPTO lightweight cipher<a class="headerlink" href="#open-competition-nsucrypto-lightweight-cipher" title="Link to this heading">¶</a></h2>
<p>Đây là bài 6 ở round 2.</p>
<section id="id8">
<h3>Đề bài<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Ghi chú</p>
<p>Problem for special prize</p>
</div>
<p>NSUCRYPTO team tổ chức cuộc thi phát triển mã khối light-weight mới.</p>
<p>Một số yêu cầu:</p>
<ul class="simple">
<li><p>Block size là <span class="math notranslate nohighlight">\(64\)</span> bits.</p></li>
<li><p>Key size là <span class="math notranslate nohighlight">\(80\)</span>, <span class="math notranslate nohighlight">\(96\)</span> hoặc <span class="math notranslate nohighlight">\(64\)</span> bits.</p></li>
<li><p>Số vòng là <span class="math notranslate nohighlight">\(32\)</span>.</p></li>
<li><p>Cấu trúc xây dựng tùy ý. Nghĩa là SPN, ARX, Feistel đều có thể sử dụng, thậm chí là một cách xây dựng mới.</p></li>
</ul>
<p>Thí sinh cần xem xét PRESENT light-weight cipher (2007) và cố gắng tìm ra điều có thể làm tốt hơn mã khối này.</p>
<p>Hãy so sánh đáp án của bạn với PRESENT: khi thực hiện, khi chống phá mã (linear, differential, algebraic, ...) và đưa ra các giải thích cần thiết.</p>
</section>
<section id="id9">
<h3>Lời giải<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<p>Đây là bài có tính mở rất cao nhưng để tìm ra điều gì đó mới (và hiệu quả) trong 7 ngày là rất khó. Do đó lúc thi mình đã xây dựng một block cipher mới tốt hơn PRESENT về mặt lưu trữ, còn các tính chất khác như kháng phá mã thì mình không đề cập tới. Bài này mình được 6/10 điểm.</p>
<p>Về PRESENT thì mình đã có tóm tắt trong một bài viết của blog này nên mình không viết lại. PRESENT cipher là thuật toán light-weight, tức là thuật toán được thiết kế nhỏ gọn để chạy trên các thiết bị có bộ xử lý và lưu trữ nhỏ (như các hệ thống nhúng).</p>
<p>Cải tiến của mình dựa trên việc PRESENT sử dụng mạng SP nên sẽ cần lưu trữ phép biến đổi để mã hóa và phép biến đổi ngược để giải mã:</p>
<ul class="simple">
<li><p>cần lưu trữ đồng thời S-box là <span class="math notranslate nohighlight">\(S[x]\)</span> và inverse S-box là <span class="math notranslate nohighlight">\(S^{-1}[x]\)</span>;</p></li>
<li><p>cần lưu trữ biến đổi tuyến tính pLayer và biến đổi ngược của nó;</p></li>
<li><p>addRoundKey có phép biến đổi ngược là chính nó nên mình bỏ qua.</p></li>
</ul>
<p>Như vậy, ta tốn hai phần bộ nhớ: một cho phép biến đổi mã hóa và một cho phép biến đổi ngược để giải mã.</p>
<p>Làm sao để cải tiến? Mình dùng mô hình Feistel, hoặc mô hình Feistel tổng quát (generalize Feistel network) để xây dựng mã khối mới.</p>
<p>Khối đầu vào (plaintext) có <span class="math notranslate nohighlight">\(64\)</span> bits sẽ được chia thành <span class="math notranslate nohighlight">\(4\)</span> phần bằng nhau, mỗi phần có <span class="math notranslate nohighlight">\(16\)</span> bits:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[P = (X^0, X^1, X^2, X^3).\]</div>
</div>
<p>Khóa <span class="math notranslate nohighlight">\(K\)</span> có <span class="math notranslate nohighlight">\(64\)</span> bits sẽ sinh ra các khóa con <span class="math notranslate nohighlight">\(K_0\)</span>, <span class="math notranslate nohighlight">\(K_1\)</span>, ..., <span class="math notranslate nohighlight">\(K_{31}\)</span> cho <span class="math notranslate nohighlight">\(32\)</span> vòng.</p>
<p>Tại vòng thứ <span class="math notranslate nohighlight">\(i\)</span> với <span class="math notranslate nohighlight">\(0 \leqslant i \leqslant 31\)</span>, <span class="math notranslate nohighlight">\(X^{i+4}\)</span> được tính như sau</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[X^{i+4} = X^i \oplus F(X^{i+1} \oplus X^{i+2} \oplus X^{i+3}, K_i),\]</div>
</div>
<p>trong đó <span class="math notranslate nohighlight">\(F: \mathbb{F}_2^{16} \times \mathbb{F}_2^{16} \to \mathbb{F}_2^{16}\)</span> là round function.</p>
<figure class="align-default">
<img alt="../../_images/solution-6.jpg" src="../../_images/solution-6.jpg" />
</figure>
<p>Ciphertext sau <span class="math notranslate nohighlight">\(32\)</span> vòng sẽ là trạng thái cuối viết theo thứ tự ngược lại, nghĩa là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[C = (X^{35}, X^{34}, X^{33}, X^{32}).\]</div>
</div>
<p><strong>Round function.</strong> Round function <span class="math notranslate nohighlight">\(F: \mathbb{F}_2^{16} \times \mathbb{F}_2^{16} \to \mathbb{F}_2^{16}\)</span> gồm ba phép biến đổi là cộng modulo <span class="math notranslate nohighlight">\(2^{16}\)</span>, S-box và linear layer.</p>
<ol class="arabic simple">
<li><p>Phép cộng modulo <span class="math notranslate nohighlight">\(2^{16}\)</span>, đặt <span class="math notranslate nohighlight">\(Y = X^i \oplus X^{i+1} \oplus X^{i+2}\)</span>, khi đó ta tính <span class="math notranslate nohighlight">\(Y + K_i \pmod{2^{16}}\)</span> và kí hiệu là <span class="math notranslate nohighlight">\(Y \boxplus K_i\)</span>.</p></li>
<li><p>S-box là ánh xạ <span class="math notranslate nohighlight">\(S: \mathbb{F}_2^4 \to \mathbb{F}_2^4\)</span>, trong đó <span class="math notranslate nohighlight">\(16\)</span> bits từ phép cộng trên được chia thành <span class="math notranslate nohighlight">\(4\)</span> phần, mỗi phần có <span class="math notranslate nohighlight">\(4\)</span> bits đi qua S-box. Sau đó ta nối các kết quả lại thành <span class="math notranslate nohighlight">\(16\)</span> bits mới.</p></li>
<li><p>Linear layer <span class="math notranslate nohighlight">\(L\)</span>. Ta xor <span class="math notranslate nohighlight">\(X\)</span> với <span class="math notranslate nohighlight">\(X \lll 11\)</span>, trong đó <span class="math notranslate nohighlight">\(\lll\)</span> là phép dịch <span class="math notranslate nohighlight">\(11\)</span> bits sang trái.</p></li>
</ol>
<p>Như vậy</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[S(X) = S(a_0, a_1, a_2, a_3) = (\mathtt{Sbox}(a_0), \mathtt{Sbox}(a_1), \mathtt{Sbox}(a_2), \mathtt{Sbox}(a_3)),\]</div>
</div>
<p>với <span class="math notranslate nohighlight">\(X = (a_0, a_1, a_2, a_3) \in \mathbb{F}_2^{16}\)</span> và <span class="math notranslate nohighlight">\(a_i \in \mathbb{F}_2^4\)</span>.</p>
<p>S-box được cho bởi bảng sau</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(x\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(0\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(2\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(3\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(4\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(5\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(6\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(7\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(8\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(9\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\text{A}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\text{B}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\text{C}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\text{D}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\text{E}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\text{F}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(S(x)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{C}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{F}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{A}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{B}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(9\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(8\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{D}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(7\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{E}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(6\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(4\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Linear layer như sau:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[L(X) = X \oplus (X \lll 11).\]</div>
</div>
<p><strong>Round key.</strong> Khóa đầu vào <span class="math notranslate nohighlight">\(K\)</span> có <span class="math notranslate nohighlight">\(64\)</span> bits sẽ được chia thành <span class="math notranslate nohighlight">\(8\)</span> phần <span class="math notranslate nohighlight">\(K_0\)</span>, <span class="math notranslate nohighlight">\(K_1\)</span>, ..., <span class="math notranslate nohighlight">\(K_7\)</span>. Các vòng dùng khóa con như sau:</p>
<ol class="arabic simple">
<li><p>Các vòng 0, 1, ..., 7 sử dụng lần lượt các khóa <span class="math notranslate nohighlight">\(K_0\)</span>, <span class="math notranslate nohighlight">\(K_1\)</span>, ..., <span class="math notranslate nohighlight">\(K_7\)</span>.</p></li>
<li><p>Các vòng 8, 9, ..., 15 sử dụng lần lượt các khóa <span class="math notranslate nohighlight">\(K_0\)</span>, <span class="math notranslate nohighlight">\(K_1\)</span>, ..., <span class="math notranslate nohighlight">\(K_7\)</span>.</p></li>
<li><p>Các vòng 16, 17, ..., 23 sử dụng lần lượt các khóa <span class="math notranslate nohighlight">\(K_0\)</span>, <span class="math notranslate nohighlight">\(K_1\)</span>, ..., <span class="math notranslate nohighlight">\(K_7\)</span>.</p></li>
<li><p>Các vòng 24, 25, ..., 31 sử dụng lần lượt các khóa <span class="math notranslate nohighlight">\(K_7\)</span>, <span class="math notranslate nohighlight">\(K_6\)</span>, ..., <span class="math notranslate nohighlight">\(K_0\)</span>.</p></li>
</ol>
<p><strong>Decryption.</strong> Đẻ giải mã ta thực hiện theo thứ tự ngược lại. Giả sử ciphertext là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[C = (X^{35}, X^{34}, X^{33}, X^{32}),\]</div>
</div>
<p>ta viết theo thứ tự ngược lại là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[C_{32} = (X^{32}, X^{33}, X^{34}, X^{35}).\]</div>
</div>
<p>Tại vòng thứ <span class="math notranslate nohighlight">\(i\)</span> với <span class="math notranslate nohighlight">\(i = 31, \ldots, 0\)</span>, <span class="math notranslate nohighlight">\(X^i\)</span> sẽ được tính bởi</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[X^i = X^{i+4} \oplus F(X^{i+1} \oplus X^{i+2} \oplus X^{i+3}, K_i),\]</div>
</div>
<p>trong đó <span class="math notranslate nohighlight">\(F\)</span> là round function được định nghĩa ở trên. Cuối cùng plaintext là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[P = (X^0, X^1, X^2, X^3).\]</div>
</div>
</section>
</section>
<section id="a-nonlinear-generator">
<h2>A nonlinear generator<a class="headerlink" href="#a-nonlinear-generator" title="Link to this heading">¶</a></h2>
<p>Đây là bài 4 ở round 1 và bài 7 ở round 2.</p>
<section id="id10">
<h3>Đề bài<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<p>Alice tạo ra một bộ sinh khóa như hình sau:</p>
<figure class="align-default">
<img alt="../../_images/problem-7.png" src="../../_images/problem-7.png" />
</figure>
<p>Bộ sinh khóa gồm hai thanh ghi độ dài <span class="math notranslate nohighlight">\(47\)</span> và <span class="math notranslate nohighlight">\(49\)</span> với các hàm không tuyến tính (non-linear feedback).</p>
<p>Tại mỗi thời điểm <span class="math notranslate nohighlight">\(t = 1,2,\ldots\)</span>, mỗi thanh ghi sẽ sinh keystream tại trạng thái ở thời điểm <span class="math notranslate nohighlight">\(t\)</span> và sau đó chuyển sang trạng thái ở thời điểm <span class="math notranslate nohighlight">\(t+1\)</span>.</p>
<p>Cụ thể, trạng thái của thanh ghi ở thời điểm <span class="math notranslate nohighlight">\(t\)</span> là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A(t) = (a_1(t), \ldots, a_{47}(t)) \, \text{và} \, B(t) = (b_1(t), \ldots, b_{49}(t)).\]</div>
</div>
<p>Hai thanh ghi được dịch chuyển đồng thời. Ví dụ</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A(t+1) = (a_1(t), \ldots, a_{47}(t), (a_1(t) \&amp; a_2(t)) \oplus a_{13}(t) \oplus a_{44}(t)).\]</div>
</div>
<p>Keystream <span class="math notranslate nohighlight">\(\gamma\)</span> với độ dài <span class="math notranslate nohighlight">\(8192\)</span> tạo bởi bộ sinh khóa trên được ghi lại trong file <cite>keystream.txt</cite>. Ngoài ra chúng ta cũng có trạng thái <span class="math notranslate nohighlight">\(A(8192)\)</span> và <span class="math notranslate nohighlight">\(B(8192)\)</span> là:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}A(8192) &amp; = (00101001110001001110111001100001010100000101110), \\
B(8192) &amp; = (0000010000101001000011000001010111001110000100101).\end{split}\]</div>
</div>
<p>Bạn có thể tìm lại trạng thái khởi tạo <span class="math notranslate nohighlight">\(A(1)\)</span> và <span class="math notranslate nohighlight">\(B(1)\)</span> không?</p>
</section>
<section id="id11">
<h3>Lời giải<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<p>Bài này chúng ta bruteforce từ cặp bit <span class="math notranslate nohighlight">\(A(i)\)</span> và <span class="math notranslate nohighlight">\(B(i)\)</span> bắt đầu từ vị trí <span class="math notranslate nohighlight">\(8191\)</span> về <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>Mình sẽ viết lại dãy của đề bài. Dãy trên và dãy dưới lần lượt là <span class="math notranslate nohighlight">\(a_0, a_1, \ldots\)</span> và <span class="math notranslate nohighlight">\(b_0, b_1, \ldots\)</span> và các phần tử sau được sinh ra từ các phần tử trước theo công thức</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[a_{i+47} = (a_i \&amp; a_{i+1}) \oplus a_{i+12} \oplus a_{i+43}\]</div>
</div>
<p>và</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[b_{i+49} = (b_i \&amp; b_{i+1}) \oplus b_{i+10} \oplus b_{i+47}.\]</div>
</div>
<p>Keystream <span class="math notranslate nohighlight">\(\{ g_n \}\)</span> sẽ được sinh theo công thức</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}g_i &amp; = a_i \oplus a_{i+3} \oplus (a_{i+7} \&amp; a_{i+8}) \\
    &amp; \oplus b_i \oplus (b_{i+4} \&amp; b_{i+5}) \oplus b_{i+7}.\end{split}\]</div>
</div>
<p>Như vậy mình sẽ bruteforce từ vị trí <span class="math notranslate nohighlight">\(i\)</span> từ <span class="math notranslate nohighlight">\(8190\)</span> về <span class="math notranslate nohighlight">\(0\)</span>. Ở mỗi vị trí mình có hai trường hợp <span class="math notranslate nohighlight">\(a_i\)</span> và hai trường hợp <span class="math notranslate nohighlight">\(b_i\)</span>. Nếu đặt được tới <span class="math notranslate nohighlight">\(i = 0\)</span> thì đây là dãy cần tìm.</p>
<p>Keystream là một chuỗi <span class="math notranslate nohighlight">\(8192\)</span> bits nên mình sẽ lưu ở file <a class="reference download internal" download="" href="../../_downloads/381571dccde743f1dbc7acdaf11544d7/keystream.txt"><code class="xref download docutils literal notranslate"><span class="pre">keystream.txt</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">product</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">setrecursionlimit</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>

<span class="n">g</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;keystream.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_a</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">47</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="n">val</span> <span class="o">&amp;</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">^</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">12</span><span class="p">]</span> <span class="o">^</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">43</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_b</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">49</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="n">val</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">^</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span> <span class="o">^</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">47</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">check_g</span><span class="p">(</span><span class="n">valx</span><span class="p">,</span> <span class="n">valy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">valx</span> <span class="o">^</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">])</span> <span class="o">^</span> <span class="n">valy</span> <span class="o">^</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">])</span> <span class="o">^</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8191</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;00101001110001001110111001100001010100000101110&#39;</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8191</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;0000010000101001000011000001010111001110000100101&#39;</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">bruteforce</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">assert</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">a</span><span class="p">[:</span><span class="mi">47</span><span class="p">]))</span> <span class="o">==</span> <span class="s2">&quot;01111100001110000110010001011000110000110011110&quot;</span>
        <span class="k">assert</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">b</span><span class="p">[:</span><span class="mi">49</span><span class="p">]))</span> <span class="o">==</span> <span class="s2">&quot;1100110011010001010101000101110100011011010010110&quot;</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ai</span><span class="p">,</span> <span class="n">bi</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">check_a</span><span class="p">(</span><span class="n">ai</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">and</span> <span class="n">check_b</span><span class="p">(</span><span class="n">bi</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">and</span> <span class="n">check_g</span><span class="p">(</span><span class="n">ai</span><span class="p">,</span> <span class="n">bi</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ai</span><span class="p">,</span> <span class="n">bi</span>
                <span class="n">bruteforce</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">bruteforce</span><span class="p">(</span><span class="mi">8190</span><span class="p">)</span>
</pre></div>
</div>
<p>Bài này được giải bởi bạn Uyên và là BEST SOLUTION. Điều thú vị là rất nhiều đội được BEST SOLUTION cho bài này :)))</p>
</section>
</section>
<section id="unsecure-sp-network">
<h2>Unsecure SP-network<a class="headerlink" href="#unsecure-sp-network" title="Link to this heading">¶</a></h2>
<p>Đây là bài 5 ở round 1 và bài 8 ở round 2.</p>
<section id="id12">
<h3>Đề bài<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<p>Bob có nghe về mạng SP và quyết định xây dựng mật mã của riêng mình.</p>
<p>Block size (kích thước khối) là <span class="math notranslate nohighlight">\(32\)</span> bits. Bob tạo S-boxes kích thước <span class="math notranslate nohighlight">\(2 \times 2\)</span> là <span class="math notranslate nohighlight">\(P\)</span>-layer sử dụng một phần của secret key.</p>
<p>Ở đây <span class="math notranslate nohighlight">\(P\)</span> là một biến đổi tuyến tính <span class="math notranslate nohighlight">\(P : \mathbb{F}_2^{32} \to \mathbb{F}_2^{32}\)</span>, nghĩa là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[P(x \oplus y) = P(x) \oplus P(y)\]</div>
</div>
<p>với mọi <span class="math notranslate nohighlight">\(x, y \in \mathbb{F}_2^{32}\)</span>.</p>
<p>Ngoài ra, secret key là <span class="math notranslate nohighlight">\(K \in \mathbb{F}_2^{128}\)</span>. Với nó Bob đặt</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[K^i = (K_{32 (i \bmod 4) + 1}, \ldots, K_{32(i \bmod 4) + 32})\]</div>
</div>
<p>có độ dài <span class="math notranslate nohighlight">\(32\)</span> với mọi <span class="math notranslate nohighlight">\(i \in \{ 1, \ldots, 100 \}\)</span>.</p>
<p>Như vậy vòng thứ <span class="math notranslate nohighlight">\(i\)</span> của mã khối sẽ như sau:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[r_i(x) = P(S(x_1 \oplus K_1^i, x_2 \oplus K_2^i), S(x_3 \oplus K_3^i, x_4 \oplus K_4^i), \ldots, S(x_{31} \oplus K_{31}^i, x_{32} \oplus K_{32}^i))\]</div>
</div>
<p>với <span class="math notranslate nohighlight">\(x \in \mathbb{F}_2^{32}\)</span>.</p>
<p>Ciphertext sẽ là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[c = K^{100} \oplus r_{99}(r_{98}(\ldots r_1(m)))\]</div>
</div>
<p>với <span class="math notranslate nohighlight">\(m\)</span> là plaintext ban đầu, <span class="math notranslate nohighlight">\(m = (m_1, \ldots, m_{32})\)</span> và <span class="math notranslate nohighlight">\(m_i \in \mathbb{F}_2\)</span>.</p>
<p>Tuy nhiên Bob nhanh chóng nhận ra Carol có thể đọc được plaintext mà không gặp vấn đề nếu Carol biết <span class="math notranslate nohighlight">\(100\)</span> cặp plaintext và ciphertext bất kì.</p>
<p>Tại sao cô ấy làm được?</p>
</section>
<section id="id13">
<h3>Lời giải<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<p>Giả sử việc mã hóa có dạng <span class="math notranslate nohighlight">\(C = \mathtt{Enc}(P)\)</span>. Mình sẽ chứng minh rằng với hai plaintext <span class="math notranslate nohighlight">\(P\)</span> và <span class="math notranslate nohighlight">\(P'\)</span>, nếu ciphertext tương ứng là <span class="math notranslate nohighlight">\(C\)</span> và <span class="math notranslate nohighlight">\(C'\)</span> thì</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[C \oplus C' = \mathtt{Enc}(P \oplus P').\]</div>
</div>
<p>Một điều khá buồn cười là bài này mình mất kha khá thời gian vì những suy nghĩ ... vĩ mô. Theo đề bài có thể nhận thấy S-box <span class="math notranslate nohighlight">\(S\)</span> là ánh xạ từ <span class="math notranslate nohighlight">\(\mathbb{F}_2^2\)</span> tới <span class="math notranslate nohighlight">\(\mathbb{F}_2^2\)</span>. Theo quy tắc nhân có tất cả <span class="math notranslate nohighlight">\(2^{2^2} = 16\)</span> ánh xạ từ <span class="math notranslate nohighlight">\(\mathbb{F}_2^2\)</span> tới <span class="math notranslate nohighlight">\(\mathbb{F}_2\)</span> (số lượng hàm boolean hai biến). Do đó có <span class="math notranslate nohighlight">\(16^2 = 256\)</span> trường hợp S-box <span class="math notranslate nohighlight">\(S\)</span>.</p>
<p>Đối với các S-box tuyến tính hoặc affine thì câu chuyện không phải vấn đề. Tuy nhiên các trường hợp khác rất khó kiểm soát. Lúc này bạn Uyên nói với mình có <span class="math notranslate nohighlight">\(4! = 24\)</span> trường hợp của S-box thôi, là số lượng hoán vị trên tập <span class="math notranslate nohighlight">\(\{ 0, 1, 2, 3 \}\)</span>. Lý do là vì thuật toán mã hóa sử dụng mạng SP, do đó mỗi phép biến đổi phải có phép biến đổi ngược. Chân lý đây rồi, ánh sáng đây rồi :v :v :v Vậy mà mình nghĩ mãi, haizz.</p>
<p>Ý tưởng của mình là sử dụng phá mã vi sai (differential cryptanalysis).</p>
<p>Với ánh xạ <span class="math notranslate nohighlight">\(M: \mathbb{F}_2^n \to \mathbb{F}_2^n\)</span> mình gọi:</p>
<ol class="arabic simple">
<li><p><strong>Input differential</strong> là <span class="math notranslate nohighlight">\(x_1 \oplus x_2\)</span>.</p></li>
<li><p><strong>Output differential</strong> là <span class="math notranslate nohighlight">\(M(x_1) \oplus M(x_2)\)</span>.</p></li>
</ol>
<p>Mình dùng SageMath để kiểm tra nhanh phân bố vi sai trên <span class="math notranslate nohighlight">\(24\)</span> hoán vị (ứng với <span class="math notranslate nohighlight">\(24\)</span> S-box).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sage.crypto.sbox</span><span class="w"> </span><span class="kn">import</span> <span class="n">SBox</span>

<span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;S-box: </span><span class="si">{</span><span class="n">perm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">SBox</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span><span class="o">.</span><span class="n">difference_distribution_table</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
<p>Một dấu hiệu chung cho mọi S-box là nếu input differential cố định thì output differential cũng cố định.</p>
<p>Ví dụ, với S-box tương ứng với hoán vị</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}S = \begin{pmatrix} 0 &amp; 1 &amp; 2 &amp; 3 \\ 1 &amp; 2 &amp; 0 &amp; 3 \end{pmatrix}\end{split}\]</div>
</div>
<p>thì bảng phân bố vi sai là</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td></td>
<td><p><span class="math notranslate nohighlight">\(00\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(01\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(10\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(11\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(00\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\color{red}{4}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(01\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\color{red}{4}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(10\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\color{red}{4}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(11\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\color{red}{4}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Theo bảng trên, nếu input differential là <span class="math notranslate nohighlight">\(10\)</span> thì output differential chắc chắn là <span class="math notranslate nohighlight">\(01\)</span>.</p>
<p>Như vậy mình có nhận xét sau.</p>
<div class="proof remark admonition" id="nsu24-rmk-sp">
<p class="admonition-title"><span class="caption-number">Chú ý 13 </span></p>
<section class="remark-content" id="proof-content">
<p>Với S-box bất kì là hoán vị trên tập <span class="math notranslate nohighlight">\(\{ 0, 1, 2, 3 \}\)</span>, nếu input differential cố định thì output differential cũng cố định.</p>
</section>
</div><p>Đầu tiên mình cần viết lại các kí hiệu trong bài này.</p>
<p>Plaintext có <span class="math notranslate nohighlight">\(32\)</span> bit:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[m = (m_1, \ldots, m_{32}), \quad m_i \in \mathbb{F}_2.\]</div>
</div>
<p>S-box là hoán vị trên tập <span class="math notranslate nohighlight">\(\{ 0, 1, 2, 3 \}\)</span>. Nói cách khác S-box là song ánh <span class="math notranslate nohighlight">\(S\)</span> từ <span class="math notranslate nohighlight">\(\mathbb{F}_2^2\)</span> tới <span class="math notranslate nohighlight">\(\mathbb{F}_2^2\)</span>.</p>
<p>Đặt <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> là ánh xạ biến đổi <span class="math notranslate nohighlight">\(32\)</span> bit thành <span class="math notranslate nohighlight">\(32\)</span> bit mới với S-box, nghĩa là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}S : &amp; \ \mathbb{F}_2^{32} \times \mathbb{F}_2^{32} \to \mathbb{F}_2^{32} \\
    &amp; (x, K) \mapsto X,\end{split}\]</div>
</div>
<p>trong đó:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x = (x_1, \ldots, x_{32})\)</span> là khối <span class="math notranslate nohighlight">\(32\)</span> bit</p></li>
<li><p><span class="math notranslate nohighlight">\(K = (K_1, \ldots, K_{32})\)</span> là khóa con ở vòng tương ứng</p></li>
<li><p><span class="math notranslate nohighlight">\(X = (X_1, \ldots, X_{32})\)</span> nhận được từ</p></li>
</ul>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccl}
    (X_1, X_2) &amp; = &amp; S(x_1 \oplus K_1, x_2 \oplus K_2), \\
    (X_3, X_4) &amp; = &amp; S(x_3 \oplus K_3, x_4 \oplus K_4), \\
    \cdots \\
    (X_{31}, X_{32}) &amp; = &amp; S(x_{31} \oplus K_{31}, x_{32} \oplus K_{32}).
\end{array}\end{split}\]</div>
</div>
<p>Biến đổi tuyến tính là ánh xạ <span class="math notranslate nohighlight">\(P\)</span> từ <span class="math notranslate nohighlight">\(\mathbb{F}_2^{32}\)</span> tới <span class="math notranslate nohighlight">\(\mathbb{F}_2^{32}\)</span>.</p>
<p>Secret key là <span class="math notranslate nohighlight">\(K \in \mathbb{F}_2^{128}\)</span>. Subkey ở vòng thứ <span class="math notranslate nohighlight">\(i\)</span> nhận được từ <span class="math notranslate nohighlight">\(K\)</span> theo công thức</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[K^i = (K_{32 (i \bmod 4) + 1}, \ldots, K_{32 (i \bmod 4) + 32}),\]</div>
</div>
<p>với <span class="math notranslate nohighlight">\(i \in \{ 1, \ldots, 100 \}\)</span>. Mỗi subkey <span class="math notranslate nohighlight">\(K^i\)</span> có độ dài <span class="math notranslate nohighlight">\(32\)</span> bit.</p>
<p>Biến đổi ở vòng thứ <span class="math notranslate nohighlight">\(i\)</span> là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[r_i(x) = P(\mathcal{S}(x, K^i)).\]</div>
</div>
<p>Ciphertext sau <span class="math notranslate nohighlight">\(100\)</span> vòng sẽ là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[c = K^{100} r_{99}(r_{98}(\ldots (r_1(m)))).\]</div>
</div>
<p>Tiếp theo, sử dụng differential attack mình sẽ tìm liên hệ known-plaintext. Mình xét vòng đầu tiên trước.</p>
<p>Giả sử mình có hai plaintext là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[m = (m_1, \ldots, m_{32}) \ \text{và} \ m' = (m_1', \ldots, m_{32}') \in \mathbb{F}_2^{32}.\]</div>
</div>
<p>Ta có</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}(m_1, m_2) \rightarrow S(m_1 \oplus K_1^1, m_2 \oplus K_2^1) = (X_1, X_2), \\
(m_1', m_2') \rightarrow S(m_1' \oplus K_1^1, m_2' \oplus K_2^1) = (X_1', X_2').\end{split}\]</div>
</div>
<p>Input differential cho S-box là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(m_1 \oplus K_1^1 \oplus m_1' \oplus K_1^1, m_2 \oplus K_2^1 \oplus m_2' \oplus K_2^1) = (m_1 \oplus m_1', m_2 \oplus m_2').\]</div>
</div>
<p>Ở đây subkey không ảnh hưởng input differential và đây là yếu tố quan trọng cần chú ý.</p>
<p>Nếu mình cố định input differential <span class="math notranslate nohighlight">\((m_1 \oplus m_1', m_2 \oplus m_2')\)</span> thì output differential</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[S(m_1 \oplus K_1^1, m_2 \oplus K_2^1) \oplus S(m_1' \oplus K_1^1, m_2' \oplus K_2^1) = (X_1, X_2) \oplus (X_1', X_2) = (X_1 \oplus X_1', X_2 \oplus X_2')\]</div>
</div>
<p>cũng cố định. Tương tự cho các cặp còn lại <span class="math notranslate nohighlight">\((m_3, m_4)\)</span>, ..., <span class="math notranslate nohighlight">\((m_{31}, m_{32})\)</span>.</p>
<p>Như vậy ở vòng đầu ta có</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}&amp; r_1(m) = P(\mathcal{S}(m, K^1)) = P(X_1, X_2, \ldots, X_{32}), \\
&amp; r_1(m') = P(\mathcal{S}(m', K^1)) = P(X_1', X_2', \ldots, X_{32}').\end{split}\]</div>
</div>
<p>Suy ra</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[r_1(m) \oplus r_1(m') = P(X_1, \ldots, X_{32}) \oplus P(X_1', \ldots, X_{32}') = P(X_1 \oplus X_1', \ldots, X_{32} \oplus X_{32}')\]</div>
</div>
<p>vì <span class="math notranslate nohighlight">\(P\)</span> là biến đổi tuyến tính. Rõ ràng nếu <span class="math notranslate nohighlight">\(X_i \oplus X_i'\)</span> cố định với mọi <span class="math notranslate nohighlight">\(i = 1, \ldots, 32\)</span> thì kết quả <span class="math notranslate nohighlight">\(r_1(m) \oplus r_1(m')\)</span> cũng cố định theo.</p>
<p>Áp dụng kết quả này cho <span class="math notranslate nohighlight">\(99\)</span> vòng. Ở vòng cuối (vòng <span class="math notranslate nohighlight">\(100\)</span>) ta XOR với <span class="math notranslate nohighlight">\(K^{100}\)</span> nhưng thực ra là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}c \oplus c' &amp; = (K^{100} \oplus r_{99}(r_98)(\ldots r_1(m))) \oplus (K^{100} \oplus r_{99}(r_{98}(\ldots r_1(m')))) \\
            &amp; = r_{99}(r_98)(\ldots r_1(m)) \oplus r_{99}(r_{98}(\ldots r_1(m'))),\end{split}\]</div>
</div>
<p>tức là <span class="math notranslate nohighlight">\(K^{100}\)</span> cũng không ảnh hưởng differential như <span class="math notranslate nohighlight">\(K_1, \ldots, K_{99}\)</span>.</p>
<p>Tóm lại mình nhận được kết quả sau.</p>
<div class="proof remark admonition" id="nsu24-rmk-sp-solve">
<p class="admonition-title"><span class="caption-number">Chú ý 14 </span></p>
<section class="remark-content" id="proof-content">
<p>Nếu ta biết plaintext <span class="math notranslate nohighlight">\(P\)</span> và ciphertext tương ứng là <span class="math notranslate nohighlight">\(C\)</span>, thì với mọi ciphertext <span class="math notranslate nohighlight">\(C'\)</span> mới nào đó ta luôn có thể tìm lại được plaintext tương ứng. Nói cách khác là chú ý ở đầu bài</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[C \oplus C' = \mathtt{Enc}(P \oplus P').\]</div>
</div>
</section>
</div><div class="danger admonition">
<p class="admonition-title">Chứng minh</p>
<p>Đặt <span class="math notranslate nohighlight">\(DDT_S\)</span> là ánh xạ từ input differential thành output differential của S-box. Do input differential cố định thì output differential, <span class="math notranslate nohighlight">\(DDT_S\)</span> sẽ nhận được từ bảng phân bố vi sai bằng cách, nếu phần tử ở hàng <span class="math notranslate nohighlight">\(i\)</span> và cột <span class="math notranslate nohighlight">\(j\)</span> bằng <span class="math notranslate nohighlight">\(4\)</span> thì <span class="math notranslate nohighlight">\(DDT_S(i) = j\)</span>.</p>
<p>VÍ dụ, với S-box</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}S = \begin{pmatrix} 0 &amp; 1 &amp; 2 &amp; 3 \\ 1 &amp; 2 &amp; 0 &amp; 3 \end{pmatrix}\end{split}\]</div>
</div>
<p>như trên thì</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}DDT_S = \begin{pmatrix} 0 &amp; 1 &amp; 2 &amp; 3 \\ 0 &amp; 3 &amp; 1 &amp; 2 \end{pmatrix}.\end{split}\]</div>
</div>
<p>Rõ ràng <span class="math notranslate nohighlight">\(DDT_S\)</span> là hoán vị, hay song ánh. Do đó tồn tại biến đổi ngược</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}DDT_S^{-1} = \begin{pmatrix} 0 &amp; 1 &amp; 2 &amp; 3 \\ 0 &amp; 2 &amp; 3 &amp; 1 \end{pmatrix}.\end{split}\]</div>
</div>
<p>Đặt <span class="math notranslate nohighlight">\(P^{-1}\)</span> là nghịch đảo của <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>Giả sử <span class="math notranslate nohighlight">\(c = (c_1, \ldots, c_{32})\)</span> và <span class="math notranslate nohighlight">\(c' = (c_1', \ldots, c_{32}')\)</span> là các ciphertexts.</p>
<p>Đặt <span class="math notranslate nohighlight">\(P^{-1}(c \oplus c') = (C_1, \ldots, C_{32})\)</span>. Áp dụng <span class="math notranslate nohighlight">\(DDT_S^{-1}\)</span> ta có</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[DDT_S^{-1}(C_1, C_2), DDT_S^{-1}(C_3, C_4), \ldots, DDT_S^{-1}(C_{31}, C_{32}),\]</div>
</div>
<p>và tương tự cho <span class="math notranslate nohighlight">\(98\)</span> vòng còn lại. Cuối cùng ta sẽ nhận được differential của các plaintexts <span class="math notranslate nohighlight">\(P\)</span> và <span class="math notranslate nohighlight">\(P'\)</span>.</p>
<p>Do đã biết <span class="math notranslate nohighlight">\(P\)</span> và differential <span class="math notranslate nohighlight">\(P \oplus P'\)</span> vừa tìm được, ta có thể tìm <span class="math notranslate nohighlight">\(P'\)</span>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># binmatrix.py</span>

<span class="c1"># https://github.com/xiangzejun/binary_matrix</span>
<span class="c1"># For feedback or questions, pleast contact at xiangzejun@iie.ac.cn</span>

<span class="c1"># Implemented by Xiang Zejun, State Key Laboratory of Information Security,</span>
<span class="c1"># Institute Of Information Engineering, CAS</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">reduce</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DataError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Define my data exception.</span>
<span class="sd">    Check whether the elements of the matrxi are binaries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        store the coordinate of the entry which is not binary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">printError</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The element at [</span><span class="si">{0}</span><span class="s2">][</span><span class="si">{1}</span><span class="s2">] is NOT binary!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FormatError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Define my format exception.</span>
<span class="sd">    Check whether input is a matrix or a square matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;The input is &quot;</span> <span class="o">+</span> <span class="n">s</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">printError</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RankError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Define my rank exception.</span>
<span class="sd">    Check whether the square matrix is full rank when calculating its inverse.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">printError</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The matrix is NOT full rank. (rank = </span><span class="si">{0}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">))</span>

<span class="k">class</span><span class="w"> </span><span class="nc">BinMatrix</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initilize a matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span> <span class="c1"># row number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># column number</span>
        <span class="c1"># self.length = len(self.m)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__convertMatrixToInt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert each row of the binary matrix to an integer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_len</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__appendUnitMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Append a unit matrix to m_int.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">m_int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__convertMatrixToInt</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_len</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_len</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">))</span> <span class="o">^</span> <span class="n">m_int</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_len</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__chooseElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">m_int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Choose a none-zero row started from position [r][c].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">err</span> <span class="o">=</span> <span class="s2">&quot;The row index can not exceed the column index in row-reduced echelon matrix.&quot;</span>
        <span class="k">assert</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">,</span> <span class="n">err</span>

        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_len</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_len</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="p">))</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">[(</span><span class="n">m_int</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_len</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">mask</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chooseElement</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m_int</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span> <span class="o">+</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">__switchRows</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">m_int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Switch r1-th and r2-th rows of m_int.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">m_int</span><span class="p">[</span><span class="n">r1</span><span class="p">]</span>
        <span class="n">m_int</span><span class="p">[</span><span class="n">r1</span><span class="p">]</span> <span class="o">=</span> <span class="n">m_int</span><span class="p">[</span><span class="n">r2</span><span class="p">]</span>
        <span class="n">m_int</span><span class="p">[</span><span class="n">r2</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__addRows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">m_int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add the r-th row to all the other rows if the c-th element of</span>
<span class="sd">        the corresponding rows are nonzero.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_len</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="p">))</span>
        <span class="n">it</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_len</span><span class="p">))</span>
        <span class="n">it</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">m_int</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">mask</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">m_int</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">m_int</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">__isMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether the input is a matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_len</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_len</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FormatError</span><span class="p">(</span><span class="s2">&quot;NOT a matrix!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__isSquareMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether the input is a square matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_len</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_len</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FormatError</span><span class="p">(</span><span class="s2">&quot;NOT a Square matrix!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__isBinary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether the entrys in the input are binaries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="n">DataError</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rank</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the Rank of the matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isMatrix</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isBinary</span><span class="p">()</span>
        <span class="n">m_int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__convertMatrixToInt</span><span class="p">()</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_len</span><span class="p">):</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chooseElement</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">m_int</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">arg</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">r_temp</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__switchRows</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">r_temp</span><span class="p">,</span> <span class="n">m_int</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__addRows</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">m_int</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">r</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_len</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">det</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the Det of the matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isSquareMatrix</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isBinary</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_len</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the inverse of the matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isSquareMatrix</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isBinary</span><span class="p">()</span>
        <span class="n">m_adj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__appendUnitMatrix</span><span class="p">()</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_len</span><span class="p">):</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__chooseElement</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">m_adj</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">arg</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">r_temp</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__switchRows</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">r_temp</span><span class="p">,</span> <span class="n">m_adj</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__addRows</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">m_adj</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">RankError</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">format</span><span class="p">((</span><span class="n">m_adj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_len</span><span class="p">),</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_len</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;b&quot;</span><span class="p">))))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_len</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># cipher.py</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">binmatrix</span><span class="w"> </span><span class="kn">import</span> <span class="n">BinMatrix</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="n">sbox</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sbox</span><span class="p">)</span>    <span class="c1"># generate random S-box which is permuation</span>

<span class="n">P</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># generate random invertible matrix on F_2</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">break</span>

<span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">P</span><span class="p">]</span> <span class="c1"># convert from numpy.narray to list</span>
<span class="n">P_inv</span> <span class="o">=</span> <span class="n">BinMatrix</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>      <span class="c1"># calculate inverse of P</span>

<span class="n">difference_distribution_table</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span> <span class="k">for</span> <span class="n">__</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="c1"># i-th row -&gt; input differential</span>
<span class="c1"># o-th row -&gt; output differential</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">a</span> <span class="o">^</span> <span class="n">b</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">sbox</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">^</span> <span class="n">sbox</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
        <span class="n">difference_distribution_table</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">o</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">sbox_diff</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>
<span class="c1"># calculate DDT_S</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">difference_distribution_table</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">sbox_diff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>

<span class="n">sbox_diff_inv</span> <span class="o">=</span> <span class="p">[</span><span class="n">sbox_diff</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span> <span class="c1"># DDT_S^{-1}</span>

<span class="k">def</span><span class="w"> </span><span class="nf">matmul</span><span class="p">(</span><span class="n">M</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="n">v</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="c1"># multiplication of matrix M and vector v</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>
        <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span><span class="w"> </span><span class="nf">encrypt</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">K</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="c1"># encryption with plaintext m, key K</span>
    <span class="n">Ki</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">32</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="p">),</span> <span class="mi">32</span><span class="p">)]</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">99</span><span class="p">):</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="o">^</span> <span class="n">k</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">Ki</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">])]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pt</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">pt</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># get two bits for input of S-box</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">sbox</span><span class="p">[</span><span class="n">z</span><span class="p">]</span>
            <span class="n">pt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>      <span class="c1"># write two new bits</span>
            <span class="n">pt</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span> <span class="o">&amp;</span> <span class="mi">1</span>     <span class="c1"># after S-box</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">matmul</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="o">^</span> <span class="n">k</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">Ki</span><span class="p">[</span><span class="mi">100</span> <span class="o">%</span> <span class="mi">4</span><span class="p">])]</span>
    <span class="k">return</span> <span class="n">pt</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># solve.py</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cipher</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">pt1</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span>  <span class="c1"># Known</span>
<span class="n">pt2</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span>  <span class="c1"># Unknown</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">128</span><span class="p">)</span>

<span class="n">ct1</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>   <span class="c1"># Known</span>
<span class="n">ct2</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">pt2</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>   <span class="c1"># Known</span>

<span class="n">ct_diff</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">^</span> <span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ct1</span><span class="p">,</span> <span class="n">ct2</span><span class="p">)]</span> <span class="c1"># ct1 ^ ct2</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">99</span><span class="p">):</span>
    <span class="n">ct_diff</span> <span class="o">=</span> <span class="n">matmul</span><span class="p">(</span><span class="n">P_inv</span><span class="p">,</span> <span class="n">ct_diff</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ct_diff</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">ct_diff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ct_diff</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">sbox_diff_inv</span><span class="p">[</span><span class="n">z</span><span class="p">]</span>
        <span class="n">ct_diff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
        <span class="n">ct_diff</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span> <span class="o">&amp;</span> <span class="mi">1</span>

<span class="n">pt2_guess</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ct_diff</span><span class="p">,</span> <span class="n">pt1</span><span class="p">)]</span> <span class="c1"># Recover pt2</span>
<span class="k">assert</span> <span class="n">pt2</span> <span class="o">==</span> <span class="n">pt2_guess</span>
</pre></div>
</div>
<p>Một điều thú vị là có thể dùng nhiều S-box và quá trình tấn công vẫn tương tự. Ví dụ</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(x_1, \ldots, x_{32}) \xrightarrow{K^i} (S_1(x_1 \oplus K_1^i, x_2 \oplus K_2^i), S_2(x_3 \oplus K_3^i, x_4 \oplus K_4^i), \ldots, S_{16}(x_31 \oplus K_{31}^i, x_{32} \oplus K_{32}^i)),\]</div>
</div>
<p>với <span class="math notranslate nohighlight">\(S_i\)</span> là hoán vị bất kì trên <span class="math notranslate nohighlight">\(\{ 0, 1, 2, 3 \}\)</span>, <span class="math notranslate nohighlight">\(i = 1, \ldots, 16\)</span>.</p>
<p>Ở đây ta sẽ áp dụng cùng phương pháp như trên nhưng ta sẽ tính <span class="math notranslate nohighlight">\(DDT_{S_i}\)</span> cho mỗi S-box <span class="math notranslate nohighlight">\(S_i\)</span>.</p>
</section>
<section id="loi-giai-hoan-chinh">
<h3>Lời giải hoàn chỉnh<a class="headerlink" href="#loi-giai-hoan-chinh" title="Link to this heading">¶</a></h3>
<p>Thật ra mình đã đọc thiếu đề và chưa xét trường hợp S-box và <span class="math notranslate nohighlight">\(P\)</span> là các phép biến đổi bí mật (giống secret key). Đây là lý do mình không được full điểm câu này.</p>
<p>S-box, theo phân tích của mình ở trên, thực chất là một ánh xạ affine. Nhắc lại ánh xạ affine là ánh xạ có dạng <span class="math notranslate nohighlight">\(S(\bm{x}) = \bm{A} \cdot \bm{x} \oplus \bm{b}\)</span>, trong đó <span class="math notranslate nohighlight">\(\bm{A}\)</span> là ma trận, <span class="math notranslate nohighlight">\(\bm{x}\)</span> và <span class="math notranslate nohighlight">\(\bm{b}\)</span> là các vector cột.</p>
<p>Khi đó, với hai đầu vào <span class="math notranslate nohighlight">\(\bm{x}\)</span> và <span class="math notranslate nohighlight">\(\bm{x}'\)</span> sao cho <span class="math notranslate nohighlight">\(\bm{x} \oplus \bm{x}'\)</span> cố định (input differential) thì ta có</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[S(\bm{x}) \oplus S(\bm{x}') = \bm{A} \cdot (\bm{x} \oplus \bm{x}')\]</div>
</div>
<p>cũng cố định do <span class="math notranslate nohighlight">\(\bm{A}\)</span> đã xác định.</p>
<p>Theo đó toàn bộ quá trình encrypt là một ánh xạ affine lớn, do đó chúng ta hoàn toàn có thể tìm được ánh xạ affine đó nếu biết đủ <span class="math notranslate nohighlight">\(32\)</span> vector độc lập tuyến tính.</p>
<p>Sử dụng <cite>cipher.py</cite> ở trên và đoạn code sau để giải:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sage.all</span><span class="w"> </span><span class="kn">import</span> <span class="n">random_vector</span><span class="p">,</span> <span class="n">vector</span><span class="p">,</span> <span class="n">GF</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">ones_matrix</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">encrypt</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1333</span><span class="p">)</span>

<span class="n">K</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">)]</span>
<span class="n">ms</span> <span class="o">=</span> <span class="p">[</span><span class="n">random_vector</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">32</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>

<span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="n">encrypt</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">)),</span> <span class="n">K</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">ms</span><span class="p">]</span>

<span class="n">ms</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">ms</span><span class="p">)</span>
<span class="n">cs</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">cs</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">32</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">bb</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">cs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">bb</span> <span class="o">*</span> <span class="n">ones_matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">A</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bb</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">random_vector</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">32</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">encrypt</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">u</span><span class="p">)),</span> <span class="n">K</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">u</span> <span class="o">*</span> <span class="n">A</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
<p>Ở đây mình viết plaintext ở dạng hàng. Giả sử plaintext và ciphertext là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[M = (m_1, \ldots, m_n), \quad C = (c_1, \ldots, c_n).\]</div>
</div>
<p>Ánh xạ affine của chúng ta tương ứng với</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(c_1, \ldots, c_n) = (m_1, \ldots, m_n) \cdot \bm{A} + (b_1, \ldots, b_n),\]</div>
</div>
<p>trong đó <span class="math notranslate nohighlight">\(\bm{A}\)</span> là ma trận <span class="math notranslate nohighlight">\(n \times n\)</span> (trong trường hợp bài này <span class="math notranslate nohighlight">\(n = 32\)</span>).</p>
<p>Như vậy mình cần tìm ma trận <span class="math notranslate nohighlight">\(\bm{A}\)</span> và vector <span class="math notranslate nohighlight">\(\bm{b} = (b_1, \ldots, b_n)\)</span>. Nếu có <span class="math notranslate nohighlight">\(T\)</span> phương trình như vậy</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}(c_{11}, \ldots, c_{1n}) &amp; = (m_{11}, \ldots, m_{1n}) \cdot \bm{A} + (b_1, \ldots, b_n), \\
(c_{21}, \ldots, c_{2n}) &amp; = (m_{21}, \ldots, m_{2n}) \cdot \bm{A} + (b_1, \ldots, b_n), \\
\cdots &amp; = \cdots \\
(c_{T1}, \ldots, c_{Tn}) &amp; = (m_{T1}, \ldots, m_{Tn}) \cdot \bm{A} + (b_1, \ldots, b_n),\end{split}\]</div>
</div>
<p>thì mình giải từng cột thứ <span class="math notranslate nohighlight">\(i\)</span> của ma trận <span class="math notranslate nohighlight">\(A\)</span> và từng số hạng <span class="math notranslate nohighlight">\(b_i\)</span>. Nghĩa là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix} c_{11} \\ c_{12} \\ \vdots \\ c_{T1} \end{pmatrix} =
\begin{pmatrix} m_{11} &amp; m_{12} &amp; \cdots &amp; m_{1n} \\ m_{21} &amp; m_{22} &amp; \cdots &amp; m_{2n} \\ \vdots &amp; \ddots &amp; \ddots &amp; \vdots \\ m_{T1} &amp; m_{T2} &amp; \cdots &amp; m_{Tn} \end{pmatrix} \cdot
\begin{pmatrix} a_{11} \\ a_{21} \\ \vdots \\ a_{n1} \end{pmatrix} + \begin{pmatrix} b_1 \\ b_1 \\ \vdots \\ b_1 \end{pmatrix}.\end{split}\]</div>
</div>
<p>Như vậy chúng ta bruteforce <span class="math notranslate nohighlight">\(b_1\)</span> và kiểm tra xem phương trình có nghiệm <span class="math notranslate nohighlight">\(\begin{pmatrix} a_{11} \\ \vdots \\ a_{n1} \end{pmatrix}\)</span> không. Nếu có thì đây là kết quả cần tìm.</p>
<p>Tiến hành cho từng cột của <span class="math notranslate nohighlight">\(\bm{A}\)</span> và từng phần tử <span class="math notranslate nohighlight">\(b_i\)</span> sẽ tìm được ánh xạ affine.</p>
</section>
</section>
<section id="unknown-function">
<h2>Unknown function<a class="headerlink" href="#unknown-function" title="Link to this heading">¶</a></h2>
<p>Đây là bài 8 ở round 1 và bài 10 ở round 2.</p>
<section id="id14">
<h3>Đề bài<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<p>Bob tạo một máy lượng tử <span class="math notranslate nohighlight">\(M\)</span> mã hóa 4-bit word với 4-bit secret key <span class="math notranslate nohighlight">\(k = (k_1, k_2, k_3, k_4)\)</span> theo mạch sau:</p>
<figure class="align-default">
<img alt="../../_images/problem-10.png" src="../../_images/problem-10.png" />
</figure>
<p>Máy này thực hiện trên 4-bit plaintext <span class="math notranslate nohighlight">\(x = (x_1, x_2, x_3, x_4)\)</span> với 4-qubit tương ứng, gọi là &quot;plainstate&quot;, là <span class="math notranslate nohighlight">\(\lvert x_1, x_2, x_3, x_4 \rangle\)</span>, tương tự với &quot;keystate&quot; là <span class="math notranslate nohighlight">\(\lvert k_1, k_2, k_3, k_4 \rangle\)</span>.</p>
<p>Mô hình tính toán là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\lvert x \rangle \lvert k \rangle \xrightarrow{M} \lvert x \rangle \lvert k \oplus f(x) \rangle,\]</div>
</div>
<p>trong đó</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f(x) = (f_1(x), f_2(x), f_3(x), f_4(x))\]</div>
</div>
<p>là hàm Boolean vectorial khả nghịch trên <span class="math notranslate nohighlight">\(4\)</span> biến. Khi đó &quot;cipherstate&quot; là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\lvert k_1 \oplus f_1(x), k_2 \oplus f_2(x), k_3 \oplus f_3(x), k_4 \oplus f_4(x) \rangle\]</div>
</div>
<p>và cuối cùng ta thu được ciphertext.</p>
<p>Alice có thể khôi phục secret key <span class="math notranslate nohighlight">\(k\)</span> không nếu cô ấy không biết hàm <span class="math notranslate nohighlight">\(f\)</span>?</p>
<p>Giả sử Alice có oracle access tới máy lượng tử với khóa cố định <span class="math notranslate nohighlight">\(k\)</span> và thu được thông tin</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f(0, 0, 0, 0) \oplus f(1, 1, 1, 1) \oplus f(1, 0, 0, 0) = c \in \mathbb{F}_2^4\]</div>
</div>
<p>với <span class="math notranslate nohighlight">\(c\)</span> đã biết.</p>
</section>
<section id="id15">
<h3>Lời giải<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<p>Đặt <span class="math notranslate nohighlight">\(\bm{x} = (x_1, x_2, x_3, x_4) \in \mathbb{F}_2^4\)</span>.</p>
<p>Kí hiệu bảng chân trị của các hàm bool <span class="math notranslate nohighlight">\(f_1(\bm{x})\)</span>, <span class="math notranslate nohighlight">\(f_2(\bm{x})\)</span>, <span class="math notranslate nohighlight">\(f_3(\bm{x})\)</span> và <span class="math notranslate nohighlight">\(f_4(\bm{x})\)</span> là</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(x_1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_2\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_3\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_4\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(f_1(\bm{x})\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(f_2(\bm{x})\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(f_3(\bm{x})\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(f_4(\bm{x})\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_1\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_3\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_4\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_4\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_4\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_4\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_5\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_6\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_6\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_6\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_6\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_7\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_7\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_7\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_7\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_8\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_8\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_8\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_8\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_9\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_9\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_9\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_9\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_{10}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{10}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_{10}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_{10}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_{11}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{11}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_{11}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_{11}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_{12}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{12}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_{12}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_{12}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_{13}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{13}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_{13}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_{13}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_{14}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{14}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_{14}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_{14}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(m_{15}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{15}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p_{15}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(q_{15}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Ở đây <span class="math notranslate nohighlight">\(m_i\)</span> là giá trị của hàm <span class="math notranslate nohighlight">\(f_1(\bm{x})\)</span> tại dòng thứ <span class="math notranslate nohighlight">\(i\)</span> với <span class="math notranslate nohighlight">\(0 \leqslant i \leqslant 15\)</span>. Tương tự cho <span class="math notranslate nohighlight">\(n_i\)</span>, <span class="math notranslate nohighlight">\(p_i\)</span> và <span class="math notranslate nohighlight">\(q_i\)</span>.</p>
<p>Ta đã biết</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f(0, 0, 0, 0) \oplus f(1, 1, 1, 1) \oplus f(1, 0, 0, 0) = \bm{c} \in \mathbb{F}_2^4\]</div>
</div>
<p>với <span class="math notranslate nohighlight">\(\bm{c}\)</span> đã biết.</p>
<p>Như vậy ta có</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}&amp; f(0, 0, 0, 0) = (m_0, n_0, p_0, q_0), \\
&amp; f(1, 1, 1, 1) = (m_{15}, n_{15}, p_{15}, q_{15}), \\
&amp; f(1, 0, 0, 0) = (m_8, n_8, p_8, q_8),\end{split}\]</div>
</div>
<p>suy ra</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\bm{c} = (m_0 \oplus m_{15} \oplus m_8, n_0 \oplus n_{15} \oplus n_8, p_0 \oplus p_{15} \oplus p_8, q_0 \oplus q_{15} \oplus q_8).\]</div>
</div>
<p>&quot;Cipherstate&quot;</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\lvert k_1 \oplus f_1(\bm{x}), k_2 \oplus f_2(\bm{x}), k_3 \oplus f_3(\bm{x}), k_4 \oplus f_4(\bm{x}) \rangle\]</div>
</div>
<p>chính là <span class="math notranslate nohighlight">\(4\)</span> bit ciphertext</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(k_1 \oplus f_1(\bm{x}), k_2 \oplus f_2(\bm{x}), k_3 \oplus f_3(\bm{x}), k_4 \oplus f_4(\bm{x})).\]</div>
</div>
<p>Vì Alice có truy cập oracle tới máy với khóa cố định <span class="math notranslate nohighlight">\(k\)</span> nên</p>
<ol class="arabic simple">
<li><p>Nếu Alice gửi plaintext <span class="math notranslate nohighlight">\((0, 0, 0, 0)\)</span> thì sẽ nhận lại ciphertext</p></li>
</ol>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\bm{C}_0 = (k_1 \oplus m_0, k_2 \oplus n_0, k_3 \oplus p_0, k_4 \oplus q_0).\]</div>
</div>
<ol class="arabic simple" start="2">
<li><p>Nếu Alice gửi plaintext <span class="math notranslate nohighlight">\((1, 1, 1, 1)\)</span> thì sẽ nhận lại ciphertext</p></li>
</ol>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\bm{C}_{15} = (k_1 \oplus m_{15}, k_2 \oplus n_{15}, k_3 \oplus p_{15}, k_4 \oplus q_{15}).\]</div>
</div>
<ol class="arabic simple" start="3">
<li><p>Nếu Alice gửi plaintext <span class="math notranslate nohighlight">\((1, 0, 0, 0)\)</span> thì sẽ nhận lại ciphertext</p></li>
</ol>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\bm{C}_8 = (k_1 \oplus m_8, k_2 \oplus n_8, k_3 \oplus p_8, k_4 \oplus q_8).\]</div>
</div>
<p>Nói cách khác là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\bm{C}_0 \oplus \bm{C}_{15} \oplus \bm{C}_8 &amp; = (k_1 \oplus (m_0 \oplus m_{15} \oplus m_8), k_2 \oplus (n_0 \oplus n_{15} \oplus n_8), k_3 \oplus (p_0 \oplus p_{15} \oplus p_8), k_4 \oplus (q_0 \oplus q_{15} \oplus q_8)) \\
&amp; = (k_1, k_2, k_3, k_4) \oplus \bm{c}.\end{split}\]</div>
</div>
<p>Ta đã biết vector <span class="math notranslate nohighlight">\(\bm{c}\)</span>, và có thể tính <span class="math notranslate nohighlight">\(\bm{C}_0 \oplus \bm{C}_{15} \oplus \bm{C}_8\)</span> nên hoàn toàn có thể tìm lại được khóa <span class="math notranslate nohighlight">\(\bm{k}\)</span> mà không cần hàm <span class="math notranslate nohighlight">\(f\)</span>.</p>
</section>
</section>
<section id="a-simple-hash-function">
<h2>A simple hash function<a class="headerlink" href="#a-simple-hash-function" title="Link to this heading">¶</a></h2>
<p>Đây là bài 11 ở round 2.</p>
<section id="id16">
<h3>Đề bài<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<p>Carol tạo một thuật toán hash mới. Khóa <span class="math notranslate nohighlight">\(k = (k_1, \ldots, k_6)\)</span> là vector nhị phân độ dài <span class="math notranslate nohighlight">\(6\)</span>.</p>
<p>Đầu vào hàm hash là một dãy các chữ số. Dãy này được chia thành các khối độ dài <span class="math notranslate nohighlight">\(6\)</span>. Nếu độ dài của dãy không chia hết cho sau thì ta thêm lần lượt các chữ số <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(2\)</span>, <span class="math notranslate nohighlight">\(3\)</span>, ... vào sau dãy cho đến khi độ dài của dãy chia hết cho <span class="math notranslate nohighlight">\(6\)</span>.</p>
<p>Mỗi khối, giả sử là <span class="math notranslate nohighlight">\((p_1, \ldots, p_6)\)</span>, được biến đổi thành số nguyên theo quy tắc</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(-1)^{k_1} \cdot p_1 + \ldots + \ldots + (-1)^{k_6} \cdot p_6.\]</div>
</div>
<p>Ở đây <span class="math notranslate nohighlight">\((-1)^0 = 1\)</span> và <span class="math notranslate nohighlight">\((-1)^1 = -1\)</span>.</p>
<p>Kết quả sau khi tính toán các khối <span class="math notranslate nohighlight">\(n_1\)</span>, <span class="math notranslate nohighlight">\(n_2\)</span>, ... sau đó được tổng hợp thành giá trị hash là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[H = n_1 - n_2 + n_3 - n_4 + \cdots\]</div>
</div>
<p>Carol áp dụng thuật toán hash này vào hệ thống log của trang web ngân hàng. Mỗi khi người dùng nhập mật khẩu <span class="math notranslate nohighlight">\(P\)</span> thì hệ thống sẽ tính toán hash <span class="math notranslate nohighlight">\(H(P, K)\)</span> và so sánh với giá trị hash lưu trên cơ sở dữ liệu để xem người dùng có nhập đúng mật khẩu không.</p>
<p>Nhưng mà Carol nhận ra hệ thống này không an toàn. Việc tìm va chạm (collision) là có thể và từ đó kẻ tấn công có thể truy cập hệ thống. Họ làm như thế nào?</p>
<p>Hãy đề xuất thuật toán đơn giản nhất để tìm va chạm cho mọi dãy đầu vào <span class="math notranslate nohighlight">\(P\)</span> biết trước nếu khóa <span class="math notranslate nohighlight">\(K\)</span> không biết.</p>
<p>Hơn nữa hãy tìm va chạm ngắn nhất cho dãy trong ví dụ (dãy <span class="math notranslate nohighlight">\(P = 134875512293\)</span>). Lưu ý rằng do không biết <span class="math notranslate nohighlight">\(K\)</span> nên chúng ta cũng không biết giá trị hash <span class="math notranslate nohighlight">\(H(P, K)\)</span>.</p>
</section>
<section id="id17">
<h3>Lời giải<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h3>
<p>Bài này mình có chút nhầm lẫn nên không được full điểm.</p>
<p>Giả sử input có <span class="math notranslate nohighlight">\(t\)</span> khối là <span class="math notranslate nohighlight">\(n_1\)</span>, <span class="math notranslate nohighlight">\(n_2\)</span>, ..., <span class="math notranslate nohighlight">\(n_t\)</span>. Mỗi khối có <span class="math notranslate nohighlight">\(6\)</span> chữ số.</p>
<p>Mình sẽ chứng minh rằng khi <span class="math notranslate nohighlight">\(t\)</span> chẵn thì ta luôn tìm được collision mà không cần khóa <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>Đầu tiên, với <span class="math notranslate nohighlight">\(t = 2\)</span>, giả sử hai khối là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[n_1 = (p_{1, 1}, \ldots, p_{1, 6}), \quad n_2 = (p_{2, 1}, \ldots, p_{2, 6}).\]</div>
</div>
<p>Giả sử khóa là <span class="math notranslate nohighlight">\(K = (k_1, \ldots, k_6)\)</span>. Khi đó hash là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}H &amp; = (-1)^{k_1} \cdot p_{1, 1} + \ldots + (-1)^{k_6} \cdot p_{1, 6} \\
&amp; - \left[ (-1)^{k_1} \cdot p_{2, 1} + \ldots + (-1)^{k_6} \cdot p_{2, 6} \right]\end{split}\]</div>
</div>
<p>và nếu mình tăng hoặc giảm <span class="math notranslate nohighlight">\(p_{1, i}\)</span> và <span class="math notranslate nohighlight">\(p_{2, i}\)</span>, với <span class="math notranslate nohighlight">\(1 \leqslant i \leqslant 6\)</span>, cùng một lượng, ví dụ như</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p_{1, 1}' = p_{1, 1} + a, \quad p_{2, 1}' = p_{2, 1} + a,\]</div>
</div>
<p>và thay <span class="math notranslate nohighlight">\(p_{1, 1}'\)</span> và <span class="math notranslate nohighlight">\(p_{2, 1}'\)</span> vào hash thì được</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}H' &amp; = (-1)^{k_1} \cdot p_{1, 1}' + \ldots + (-1)^{k_6} \cdot p_{1, 6} - \left[ (-1)^{k_1} \cdot p_{2, 1}' + \ldots + (-1)^{k_6} \cdot p_{2, 6} \right] \\
&amp; = (-1)^{k_1} \cdot (p_{1, 1} + a) + \ldots + (-1)^{k_6} \cdot p_{1, 6} - \left[ (-1)^{k-1} \cdot (p_{2, 1} + a) + \ldots +  (-1)^{k_6} \cdot p_{2, 6} \right] \\
&amp; = H + (-1)^{k_1} \cdot a - \left[ (-1)^{k_1} \cdot a \right] = H.\end{split}\]</div>
</div>
<p>Điều đó nghĩa là nếu tăng hoặc giảm <span class="math notranslate nohighlight">\(p_{1, i}\)</span> và <span class="math notranslate nohighlight">\(p_{2, i}\)</span> cùng lượng, tức là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p_{1, i}' = p_{1, i} + a_i, \ p_{2, i}' = p_{2, i} + a_i, \ \text{where} \ a_i \in \{ -1, 0, 1\},\]</div>
</div>
<p>và phải thỏa điều kiện <span class="math notranslate nohighlight">\(1 \leqslant p_{1, i}' \leqslant 9\)</span> và <span class="math notranslate nohighlight">\(1 \leqslant p_{2, i}' \leqslant 9\)</span> thì mình sẽ tìm được input mới có cùng hash.</p>
<p>Khi <span class="math notranslate nohighlight">\(t = 4, 6, \ldots\)</span> thì sử dụng phương pháp tương tự cho các cặp khối <span class="math notranslate nohighlight">\(n_{2m+1}\)</span> và <span class="math notranslate nohighlight">\(n_{2m+2}\)</span> (mỗi cặp sử dụng các giá trị <span class="math notranslate nohighlight">\(a_i\)</span> tùy ý miễn thỏa các điều kiện trên) thì ta luôn tìm được collision bất kể khóa <span class="math notranslate nohighlight">\(K\)</span> là gì.</p>
</section>
</section>
<section id="cryptographic-fish">
<h2>Cryptographic Fish<a class="headerlink" href="#cryptographic-fish" title="Link to this heading">¶</a></h2>
<p>Đây là bài 1 ở round 1.</p>
<figure class="align-default">
<img alt="../../_images/problem-1-round-1.png" src="../../_images/problem-1-round-1.png" />
</figure>
<p>Đây là tam giác Pascal.</p>
<p>Mình đã có một hàng là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[1 \to 3 \to 3 \to 1.\]</div>
</div>
<p>Hàng kế tiếp là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[1 \to 4 \to {\color{red}6} \to 4 \to 1.\]</div>
</div>
<p>Hàng kế nữa là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[1 \to {\color{red}5} \to 10 \to 20 \to 10 \to {\color{red}5} \to 1.\]</div>
</div>
<p>Tiếp theo sẽ là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[1 \to 6 \to {\color{red}15} \to {\color{red}15} \to 6 \to 1\]</div>
</div>
<p>vì theo thứ tự chúng ta sẽ cần <span class="math notranslate nohighlight">\(C^2_6\)</span> (đi từ trên xuống) và <span class="math notranslate nohighlight">\(C^4_6\)</span> (đi từ dưới lên).</p>
<p>Hàng cuối sẽ là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[1 \to 7 \to 21 \to {\color{red}35} \to {\color{red}35} \to 21 \to 7 \to 1.\]</div>
</div>
<p>Còn về ô đầu tiên thì cần điền số <span class="math notranslate nohighlight">\(\color{red}2\)</span> do dòng trước <span class="math notranslate nohighlight">\(3\)</span> là <span class="math notranslate nohighlight">\(2\)</span> theo tam giác Pascal.</p>
<p>Như vậy kết quả là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[2 + 6 + 5 + 5 + 15 + 15 + 35 + 35 = 118.\]</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../internet-olympiad/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Internet Olympiad 2024</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Các cuộc thi năm 2024</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025-2026, Lê Quốc Dũng
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">NSUCRYPTO 2024</a><ul>
<li><a class="reference internal" href="#loi-noi-dau">Lời nói đầu</a></li>
<li><a class="reference internal" href="#rsa-signature">RSA signature</a><ul>
<li><a class="reference internal" href="#de-bai">Đề bài</a></li>
<li><a class="reference internal" href="#loi-giai">Lời giải</a></li>
</ul>
</li>
<li><a class="reference internal" href="#antcipher-2-0">AntCipher 2.0</a><ul>
<li><a class="reference internal" href="#id1">Đề bài</a></li>
<li><a class="reference internal" href="#id2">Lời giải</a></li>
</ul>
</li>
<li><a class="reference internal" href="#steganography-and-codes">Steganography and codes</a><ul>
<li><a class="reference internal" href="#id3">Đề bài</a></li>
<li><a class="reference internal" href="#id4">Lời giải</a></li>
</ul>
</li>
<li><a class="reference internal" href="#weak-key-schedule-for-des">Weak key schedule for DES</a><ul>
<li><a class="reference internal" href="#id5">Đề bài</a></li>
<li><a class="reference internal" href="#id6">Lời giải</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reverse-engineering">Reverse engineering</a><ul>
<li><a class="reference internal" href="#id7">Đề bài</a></li>
<li><a class="reference internal" href="#mo-dau">Mở đầu</a></li>
<li><a class="reference internal" href="#trong-so-hamming-cua-ham-boolean">Trọng số Hamming của hàm boolean</a></li>
<li><a class="reference internal" href="#bien-doi-walsh-hadamard-va-nonlinearity">Biến đổi Walsh-Hadamard và nonlinearity</a></li>
<li><a class="reference internal" href="#loi-giai-cua-team-jpy-va-goi-y-cua-thay-kolomeec">Lời giải của team JPY và gợi ý của thầy Kolomeec</a></li>
</ul>
</li>
<li><a class="reference internal" href="#open-competition-nsucrypto-lightweight-cipher">Open competition: NSUCRYPTO lightweight cipher</a><ul>
<li><a class="reference internal" href="#id8">Đề bài</a></li>
<li><a class="reference internal" href="#id9">Lời giải</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-nonlinear-generator">A nonlinear generator</a><ul>
<li><a class="reference internal" href="#id10">Đề bài</a></li>
<li><a class="reference internal" href="#id11">Lời giải</a></li>
</ul>
</li>
<li><a class="reference internal" href="#unsecure-sp-network">Unsecure SP-network</a><ul>
<li><a class="reference internal" href="#id12">Đề bài</a></li>
<li><a class="reference internal" href="#id13">Lời giải</a></li>
<li><a class="reference internal" href="#loi-giai-hoan-chinh">Lời giải hoàn chỉnh</a></li>
</ul>
</li>
<li><a class="reference internal" href="#unknown-function">Unknown function</a><ul>
<li><a class="reference internal" href="#id14">Đề bài</a></li>
<li><a class="reference internal" href="#id15">Lời giải</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-simple-hash-function">A simple hash function</a><ul>
<li><a class="reference internal" href="#id16">Đề bài</a></li>
<li><a class="reference internal" href="#id17">Lời giải</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-fish">Cryptographic Fish</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=dd9e4a14"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Nhấp để hiển thị';</script>
    <script>let toggleHintHide = 'Nhấp để ẩn';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=1ae7504c"></script>
    <script src="../../_static/translations.js?v=4c1d55b0"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"tex": {"macros": {"bm": ["{\\boldsymbol{#1}}", 1]}}, "chtml": {"mtextInheritFont": "true"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>