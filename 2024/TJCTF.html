<!doctype html>
<html class="no-js" lang="vi" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Tìm Kiếm" href="../search.html" /><link rel="next" title="CryptoFox 2024" href="cryptofox/index.html" /><link rel="prev" title="ASIS CTF 2024" href="ASISCTF-2024/index.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>TJCTF 2024 - Math Book</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/mystyles.css?v=fd3ba0dd" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Math Book</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/Euler_Stamp.jpg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Math Book</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Tìm Kiếm" name="q" aria-label="Tìm Kiếm">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/index.html">Những lời nói đầu</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Những lời nói đầu</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/about-maths.html">Toán học là gì với mình?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/about-notebook.html">Cơ sở xây dựng notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/about-quotations.html">Những lời răn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/about-notation.html">Kí hiệu và công thức toán trong mật mã</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../algebra/index.html">Đại số</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Đại số</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../algebra/set/index.html">1. Đại cương về tập hợp</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of 1. Đại cương về tập hợp</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../algebra/set/set.html">1.1. Tập hợp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebra/set/cadinality.html">1.2. Lực lượng của tập hợp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebra/set/map.html">1.3. Ánh xạ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebra/set/function.html">1.4. Hàm số</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebra/set/infinity.html">1.5. Các nghịch lý về tập vô hạn</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../algebra/polynomial/index.html">2. Đa thức</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of 2. Đa thức</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../algebra/polynomial/polynomial.html">2.1. Giới thiệu về đa thức</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebra/polynomial/polynomial.html#so-sanh-cong-tru-va-nhan-hai-da-thuc">2.2. So sánh, cộng, trừ và nhân hai đa thức</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebra/polynomial/lagrange-interpolation.html">2.3. Đa thức nội suy Lagrange</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebra/polynomial/numerical-methods.html">2.4. Phương pháp tính giá trị đa thức</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../algebra/proof.html">3. Phương pháp chứng minh toán học</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algebra/glossary.html">4. Bảng thuật ngữ đại số</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../abstract-algebra/index.html">Lý thuyết nhóm</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Lý thuyết nhóm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../abstract-algebra/groups/index.html">1. Lý thuyết nhóm</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of 1. Lý thuyết nhóm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../abstract-algebra/groups/group.html">1.1. Nhóm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abstract-algebra/groups/symmetric-group.html">1.2. Nhóm hoán vị</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abstract-algebra/groups/quasigroup.html">1.3. Quasigroup</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../abstract-algebra/homomorphisms/index.html">2. Homomorphisms</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of 2. Homomorphisms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../abstract-algebra/homomorphisms/group-homomorphism.html">2.1. Group homomorphism</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../abstract-algebra/group-action/index.html">3. Tác động nhóm</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of 3. Tác động nhóm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../abstract-algebra/group-action/group-action.html">3.1. Tác động nhóm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abstract-algebra/group-action/burnside.html">3.2. Bổ đề Burnside</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../abstract-algebra/rings/index.html">4. Vành</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 4. Vành</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../abstract-algebra/rings/ring.html">4.1. Vành</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../abstract-algebra/fields/index.html">5. Trường</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of 5. Trường</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../abstract-algebra/fields/field.html">5.1. Trường</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abstract-algebra/fields/ideal.html">5.2. Ideal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abstract-algebra/fields/ring-homomorphism.html">5.3. Ring kernel và ring homomorphism</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../abstract-algebra/galois-theory/index.html">6. Lý thuyết Galois</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of 6. Lý thuyết Galois</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../abstract-algebra/galois-theory/extension-field.html">6.1. Extension Fields</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../abstract-algebra/glossary.html">7. Bảng thuật ngữ lý thuyết nhóm</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../geometry/index.html">Hình học</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Hình học</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../geometry/analytic-geometry/index.html">1. Hình học giải tích</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of 1. Hình học giải tích</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../geometry/analytic-geometry/intro.html">1.1. Theo dòng lịch sử</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/analytic-geometry/analytic-geometry.html">1.2. Phương pháp tọa độ trong mặt phẳng</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/analytic-geometry/analytic-geometry.html#dao-ham">1.3. Đạo hàm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/analytic-geometry/analytic-geometry.html#tich-phan">1.4. Tích phân</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/analytic-geometry/conics.html">1.5. Ba đường Conic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/analytic-geometry/transformation.html">1.6. Phép biến hình</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../geometry/brachistochrone/brachistochrone.html">2. Đường đoản thời</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../geometry/affine-geometry/index.html">3. Hình học affine</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of 3. Hình học affine</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../geometry/affine-geometry/affine-space.html">3.1. Không gian affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/affine-geometry/affine-space.html#phang">3.2. Phẳng</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/affine-geometry/affine-space.html#doc-lap-affine-va-phu-thuoc-affine">3.3. Độc lập affine và phụ thuộc affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/affine-geometry/affine-space.html#giao-cua-cac-phang-bao-affine">3.4. Giao của các phẳng. Bao affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/affine-geometry/affine-space.html#vi-tri-tuong-doi">3.5. Vị trí tương đối</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/affine-geometry/affine-space.html#muc-tieu-va-toa-do-affine">3.6. Mục tiêu và tọa độ affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/affine-geometry/affine-space.html#cong-thuc-doi-muc-tieu">3.7. Công thức đổi mục tiêu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/affine-geometry/affine-space.html#phuong-trinh-cua-m-phang">3.8. Phương trình của <span class="math notranslate nohighlight">\(m\)</span>-phẳng</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/affine-geometry/affine-space.html#tam-ti-cu-va-ti-so-don">3.9. Tâm tỉ cự và tỉ số đơn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/affine-geometry/affine-space.html#anh-xa-affine">3.10. Ánh xạ affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/affine-geometry/affine-space.html#su-xac-dinh-anh-xa-affine">3.11. Sự xác định ánh xạ affine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../geometry/noneuclidean.html">4. Hình học phi Euclid</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../calculus/index.html">Giải tích</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Giải tích</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../calculus/calculus/index.html">1. Giải tích</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of 1. Giải tích</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../calculus/calculus/limits.html">1.1. Giới hạn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../calculus/calculus/continuity.html">1.2. Tính liên tục của hàm số</a></li>
<li class="toctree-l3"><a class="reference internal" href="../calculus/calculus/monotone.html">1.3. Tính đơn điệu và cực trị</a></li>
<li class="toctree-l3"><a class="reference internal" href="../calculus/calculus/derivative.html">1.4. Đạo hàm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../calculus/calculus/avarage-value.html">1.5. Một số định lí về giá trị trung bình</a></li>
<li class="toctree-l3"><a class="reference internal" href="../calculus/calculus/concave.html">1.6. Tính lồi, lõm và điểm uốn của đồ thị</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../calculus/differential-equation/index.html">2. Phương trình vi phân</a></li>
<li class="toctree-l2"><a class="reference internal" href="../calculus/series/index.html">3. Chuỗi số</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../calculus/derivative/index.html">4. Đạo hàm</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of 4. Đạo hàm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../calculus/derivative/partial-derivative.html">4.1. Đạo hàm một số hàm nhiều biến</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../calculus/integral/index.html">5. Tích phân</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of 5. Tích phân</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../calculus/integral/line-integral.html">5.1. Tích phân đường</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../probability/index.html">Xác suất thống kê</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Xác suất thống kê</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../probability/intro.html">Xác suất thống kê</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../probability/ML/index.html">Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Machine Learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../probability/ML/linear-regression.html">Linear Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../probability/ML/kmeans.html">K-Means clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../probability/ML/gradient-descent.html">Gradient Descent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../probability/ML/perceptron.html">Perceptron Learning Algorithm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../linalg/index.html">Đại số tuyến tính</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of Đại số tuyến tính</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../linalg/matrix/index.html">1. Ma trận</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of 1. Ma trận</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../linalg/matrix/matrix-determinant.html">1.1. Định thức ma trận</a></li>
<li class="toctree-l3"><a class="reference internal" href="../linalg/matrix/matrix-inversion.html">1.2. Ma trận nghịch đảo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../linalg/matrix/matrix-rank.html">1.3. Hạng của ma trận</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../linalg/linear-operator.html">2. Toán tử tuyến tính</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linalg/eigen.html">3. Trị riêng và vector riêng</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linalg/linear-combination.html">4. Tổ hợp tuyến tính</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linalg/vector-space.html">5. Không gian vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linalg/euclidean-space.html">6. Không gian Euclide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linalg/hilbert-space.html">7. Không gian Hilbert</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../number-theory/index.html">Lý thuyết số</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Lý thuyết số</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../number-theory/euclidean.html">1. Phép chia Euclid. Thuật toán Euclid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../number-theory/linear-congruence.html">2. Phương trình đồng dư tuyến tính</a></li>
<li class="toctree-l2"><a class="reference internal" href="../number-theory/euler.html">3. Hàm Euler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../number-theory/quadratic-residue.html">4. Thặng dư chính phương</a></li>
<li class="toctree-l2"><a class="reference internal" href="../number-theory/mobius.html">5. Hàm Möbius</a></li>
<li class="toctree-l2"><a class="reference internal" href="../number-theory/dirichlet-convolution.html">6. Tích chập Dirichlet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../number-theory/chinese-remainder-theorem.html">7. Định lý số dư Trung Hoa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../number-theory/exercises.html">8. Bài tập số học sưu tầm</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../discrete-mathematics/index.html">Toán rời rạc</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Toán rời rạc</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/binary-relation.html">Quan hệ hai ngôi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/partition.html">Phân hoạch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/discrete-fourier-transform.html">Biến đổi Fourier rời rạc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/combinatoric.html">Đại cương tổ hợp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/recurrence-relation.html">Công thức truy hồi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/system-lineq-integer.html">Hệ phương trình tuyến tính trên trường hữu hạn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discrete-mathematics/graph/index.html">Lý thuyết đồ thị</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../topology/index.html">Topology</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../boolean/index.html">Đại số Bool và mật mã học</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Đại số Bool và mật mã học</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../boolean/intro.html">1. Giới thiệu</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../boolean/boolean-algebra/index.html">2. Đại số Boolean</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of 2. Đại số Boolean</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../boolean/boolean-algebra/boolean-function.html">2.1. Hàm boolean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boolean/boolean-algebra/boolean-affine.html">2.2. Hàm affine và hàm tuyến tính</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boolean/boolean-algebra/boolean-monotone.html">2.3. Hàm đơn điệu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boolean/boolean-algebra/boolean-dnf-cnf.html">2.4. Disjunctive và Conjunctive Normal Form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boolean/boolean-algebra/boolean-weight.html">2.5. Khoảng cách Hamming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boolean/boolean-algebra/walsh-hadamard-spectre.html">2.6. Nonlinearity của hàm boolean</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../boolean/block/block-cipher.html">3. Block cipher</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of 3. Block cipher</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../boolean/block/spnet.html">3.1. SP network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boolean/block/AES.html">3.2. AES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boolean/block/kuznyechik.html">3.3. Kuznyechik</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boolean/block/present.html">3.4. PRESENT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boolean/block/feistel.html">3.5. Mô hình Feistel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boolean/block/magma.html">3.6. Magma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boolean/block/sms4.html">3.7. SMS4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boolean/block/arx.html">3.8. ARX</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../boolean/stream/stream-cipher.html">4. Stream cipher</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of 4. Stream cipher</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../boolean/stream/linear-feedback-shift-register.html">4.1. Linear Feedback Shift Register</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../boolean/mac.html">5. Message Authentication Code</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cryptanalysis/index.html">Phá mã</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of Phá mã</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cryptanalysis/differential-attack/index.html">1. Phá mã vi sai</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of 1. Phá mã vi sai</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cryptanalysis/differential-attack/toycipher.html">1.1. Nhập môn phá mã vi sai</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptanalysis/differential-attack/tinydes.html">1.2. Phá mã vi sai trên TinyDES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptanalysis/differential-attack/difference-and-differential.html">1.3. Difference và differential</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cryptanalysis/linear-attack/index.html">2. Phá mã tuyến tính</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of 2. Phá mã tuyến tính</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cryptanalysis/linear-attack/tinydes.html">2.1. Phá mã tuyến tính trên TinyDES</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cryptanalysis/slide-attack/index.html">3. Slide attack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cryptanalysis/algebraic-attack/index.html">4. Algebraic cryptanalysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cryptography/index.html">Mật mã học</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of Mật mã học</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cryptography/lattice-based/index.html">1. Lattice-based cryptography</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle navigation of 1. Lattice-based cryptography</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/lattice-based/intro.html">1.1. Nhập môn mật mã dựa trên lattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/lattice-based/congruential-pubkey.html">1.2. Congruential public key cryptosystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/lattice-based/ntru.html">1.3. NTRU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/lattice-based/falcon.html">1.4. FALCON</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/lattice-based/lattice-reduction-algorithms.html">1.5. Thuật toán rút gọn lattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/lattice-based/coppersmith.html">1.6. Phương pháp Coppersmith</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cryptography/code-based/index.html">2. Code-based cryptography</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle navigation of 2. Code-based cryptography</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/code-based/intro.html">2.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/code-based/decode-problem.html">2.2. Bài toán decode tổng quát</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/code-based/linear-code.html">2.3. Linear code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/code-based/weight.html">2.4. Bài toán phổ trọng số của mã tuyến tính</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/code-based/decode-on-linear-code.html">2.5. Bài toán decode trên linear code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/code-based/equivalence.html">2.6. Bài toán tương đương các linear code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/code-based/cryptosystem.html">2.7. Ý tưởng xây dựng các hệ mật mã dựa trên mã sửa sai</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/code-based/pubkey-algo.html">2.8. Các hệ mật mã khóa công khai dựa trên lý thuyết code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/code-based/goppa-code.html">2.9. Goppa Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cryptography/elliptic/index.html">3. Đường cong elliptic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cryptography/Kerckhoffs-principle/index.html">4. Nguyên tắc Kerckhoffs và mật mã học</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cryptography/examen.html">5. Câu hỏi ôn thi mật mã học</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cryptography/quantum-computing.html">6. Quantum computing</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cryptography/zero-knowledge-proof/index.html">7. Zero Knowledge Proof</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle navigation of 7. Zero Knowledge Proof</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/zero-knowledge-proof/intro.html">7.1. Giới thiệu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cryptography/zero-knowledge-proof/plonk.html">7.2. Plonk Protocol</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../solutions/index.html">Lời giải các bài tập trong sách tham khảo</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle navigation of Lời giải các bài tập trong sách tham khảo</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../solutions/Judson.html">Abstract Algebra: Theory and Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solutions/Petrushko/index.html">Курс высшей математики: Теория вероятностей</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../solutions/an-introduction-to-mathematical-cryptography/index.html">An Introduction to Mathematical Cryptography</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle navigation of An Introduction to Mathematical Cryptography</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../solutions/an-introduction-to-mathematical-cryptography/chapter-2.html">Chapter 2. Discrete Logarithms and Diffie-Hellman</a></li>
<li class="toctree-l3"><a class="reference internal" href="../solutions/an-introduction-to-mathematical-cryptography/chapter-3.html">Chapter 3. Integer Factorization and RSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../solutions/an-introduction-to-mathematical-cryptography/chapter-4.html">Chapter 4. Digital Signatures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../solutions/an-introduction-to-mathematical-cryptography/chapter-7.html">Chapter 7. Lattices and Cryptography</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../solutions/symmetric-cryptography/index.html">Симметричная криптография</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solutions/collection.html">Các bài toán sưu tầm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solutions/cryptohack/index.html">Wargame chill chill</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../2020/index.html">Các cuộc thi năm 2020</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle navigation of Các cuộc thi năm 2020</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2020/midnightsunCTF-2020.html">Midnight Sun CTF 2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2020/nsucrypto-2020.html">NSUCRYPTO 2020</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2021/index.html">Các cuộc thi năm 2021</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle navigation of Các cuộc thi năm 2021</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2021/CryptoCTF/index.html">Crypto CTF 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2021/GoogleCTF/index.html">Google CTF 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2021/nsucrypto.html">NSUCRYPTO 2021</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2022/index.html">Các cuộc thi năm 2022</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" role="switch" type="checkbox"/><label for="toctree-checkbox-40"><div class="visually-hidden">Toggle navigation of Các cuộc thi năm 2022</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2022/downunderCTF/index.html">DownUnder CTF 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022/nsucrypto.html">NSUCRYPTO 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022/sekaiCTF/index.html">Sekai CTF 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2022/isitdtu/index.html">ISITDTU Quals 2022</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2023/index.html">Các cuộc thi năm 2023</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" role="switch" type="checkbox"/><label for="toctree-checkbox-41"><div class="visually-hidden">Toggle navigation of Các cuộc thi năm 2023</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2023/nsucrypto/index.html">NSUCRYPTO 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/siberian-maths-contest/index.html">Siberian Mathematical Contest 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/amateursCTF.html">Amateurs CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/backdoorCTF.html">Backdoor CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/googleCTF.html">Google CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/diceCTF.html">Dice CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/UTCTF.html">UTCTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2023/wolvCTF.html">Wolv CTF 2023</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Các cuộc thi năm 2024</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" role="switch" type="checkbox"/><label for="toctree-checkbox-42"><div class="visually-hidden">Toggle navigation of Các cuộc thi năm 2024</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="nsucrypto/index.html">NSUCRYPTO 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="internet-olympiad/index.html">Internet Olympiad 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="0xL4ughCTF-2024/index.html">0xL4ugh CTF 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="ASISCTF-2024/index.html">ASIS CTF 2024</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">TJCTF 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="cryptofox/index.html">CryptoFox 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="isitdtu.html">ISITDTU Quals 2024</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2025/index.html">Các cuộc thi năm 2025</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" role="switch" type="checkbox"/><label for="toctree-checkbox-43"><div class="visually-hidden">Toggle navigation of Các cuộc thi năm 2025</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2025/cryptofox/index.html">CryptoFox 2025</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2025/tjctf.html">TJCTF 2025</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../stuff/index.html">Ngoài lề</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" role="switch" type="checkbox"/><label for="toctree-checkbox-44"><div class="visually-hidden">Toggle navigation of Ngoài lề</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../stuff/game/index.html">Lý thuyết trò chơi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stuff/graphics.html">Một số đồ thị hàm số sưu tầm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stuff/about-godel.html">Về một vị giáo sư và định lý Godel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stuff/about-stoicism.html">Chủ nghĩa khắc kỷ và phân phối nhị thức</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stuff/latex/index.html">Trải nghiệm người dùng với LaTeX</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../russia/index.html">Nước Nga du kí</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" role="switch" type="checkbox"/><label for="toctree-checkbox-45"><div class="visually-hidden">Toggle navigation of Nước Nga du kí</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../russia/intro.html">Giới thiệu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../russia/good-or-bad.html">Đi học ở Nga tốt hay xấu?</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../russia/criticism/index.html">Góc khẩu nghiệp</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" role="switch" type="checkbox"/><label for="toctree-checkbox-46"><div class="visually-hidden">Toggle navigation of Góc khẩu nghiệp</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../russia/contests.html">Các cuộc thi toán ở Nga</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mathematicians/index.html">Sưu tầm những câu chuyện về các nhà toán học</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../men-of-mathematics/index.html">Men of Mathematics</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" role="switch" type="checkbox"/><label for="toctree-checkbox-47"><div class="visually-hidden">Toggle navigation of Men of Mathematics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../men-of-mathematics/dedicate.html">Lời nói đầu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../men-of-mathematics/00-acknowledgement.html">Acknowledgments</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/2024/TJCTF.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="tjctf-2024">
<h1>TJCTF 2024<a class="headerlink" href="#tjctf-2024" title="Link to this heading">¶</a></h1>
<p>Một ngày đẹp trời 20/05/20xx ...</p>
<p>Đề bài của CTF này có nhiều câu rất dài nên mình không để ở đây. Các bạn có thể tải đề từ github của cuộc thi tại <a class="reference external" href="https://github.com/TJCSec/tjctf-2024-challenges">đây</a>.</p>
<section id="weird-crypto">
<h2>weird-crypto<a class="headerlink" href="#weird-crypto" title="Link to this heading">¶</a></h2>
<p>Đây là một bài RSA cơ bản và không may là lúc thi mình không vào được factordb, nhưng <code class="docutils literal notranslate"><span class="pre">oops</span></code> đủ nhỏ để bruteforce nên cũng không hề gì.</p>
</section>
<section id="accountleak">
<h2>accountleak<a class="headerlink" href="#accountleak" title="Link to this heading">¶</a></h2>
<p>Bài này cần tìm <code class="docutils literal notranslate"><span class="pre">subs</span></code> để recover lại <code class="docutils literal notranslate"><span class="pre">p</span></code> và <code class="docutils literal notranslate"><span class="pre">q</span></code>. Tương tự bài trên, <code class="docutils literal notranslate"><span class="pre">subs</span></code> cũng đủ nhỏ để mình bruteforce đến khi nào tìm được cặp <code class="docutils literal notranslate"><span class="pre">p</span></code> và <code class="docutils literal notranslate"><span class="pre">q</span></code> là hai số nguyên tố và decrypt <code class="docutils literal notranslate"><span class="pre">my_password</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sage.all</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="n">process</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">remote</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;Debug&#39;</span>

<span class="n">pr</span> <span class="o">=</span> <span class="n">process</span><span class="p">([</span><span class="s2">&quot;python3&quot;</span><span class="p">,</span> <span class="s2">&quot;server.py&quot;</span><span class="p">])</span>
<span class="c1"># pr = remote(&quot;tjc.tf&quot;, 31601)</span>

<span class="n">pr</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="n">c</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">pr</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())))</span>

<span class="n">pr</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="n">pr</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="n">pr</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&lt;You&gt;&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;yea&#39;</span><span class="p">)</span>
<span class="n">pr</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="n">dont_leak_this</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">pr</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;c = </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dont_leak_this = </span><span class="si">{</span><span class="n">dont_leak_this</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">20</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">sub</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">dont_leak_this</span><span class="p">)</span> <span class="o">%</span> <span class="n">sub</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">sub</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">dont_leak_this</span><span class="p">)</span> <span class="o">//</span> <span class="n">sub</span>
    <span class="n">PR</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">PR</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">n</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">roots</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">roots</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">roots</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">==</span> <span class="n">n</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">65537</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">my_password</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&lt;You&gt;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">my_password</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>

<span class="n">pr</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="assume">
<h2>assume<a class="headerlink" href="#assume" title="Link to this heading">¶</a></h2>
<p>Ở bài này mình chỉ cần kiểm tra xem if hay else được thực thi bằng việc kiểm tra message thứ 5 của mỗi đoạn có bằng <code class="docutils literal notranslate"><span class="pre">(g^a)^b</span></code> không.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;log.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>

<span class="n">p</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">msg</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="mi">6</span> <span class="o">*</span> <span class="mi">20</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="n">ln</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
        <span class="n">ga</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">gb</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">guess</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">pow</span><span class="p">(</span><span class="n">ga</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">guess</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">+=</span> <span class="n">c</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">break</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="iodomethane">
<h2>iodomethane<a class="headerlink" href="#iodomethane" title="Link to this heading">¶</a></h2>
<p>Ở bài này, nếu gọi <span class="math notranslate nohighlight">\(K\)</span> là khóa thì <span class="math notranslate nohighlight">\(K\)</span> là ma trận <span class="math notranslate nohighlight">\(3 \times 3\)</span>. Giả sử flag gồm các bytes <span class="math notranslate nohighlight">\(f_0 f_1 \ldots f_{n}\)</span> thì kết quả output là phép nhân ma trận</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix} f_0 &amp; f_1 &amp; f_2 \\ f_3 &amp; f_4 &amp; f_5 \\ &amp; \ddots &amp; \\ \end{pmatrix} \cdot K = \begin{pmatrix} e_0 &amp; e_1 &amp; e_2 \\ e_3 &amp; e_4 &amp; e_5 \\ &amp; \ddots &amp; \end{pmatrix}.\end{split}\]</div>
</div>
<p>Với flag format là <code class="docutils literal notranslate"><span class="pre">tjctf{</span></code>, mình đã biết <span class="math notranslate nohighlight">\(6\)</span> ký tự đầu của flag, mình chỉ cần bruteforce thêm <span class="math notranslate nohighlight">\(3\)</span> ký tự nữa là có thể kết hợp với output để tìm <span class="math notranslate nohighlight">\(K\)</span>. Ở đây <span class="math notranslate nohighlight">\(K\)</span> cần thỏa mãn là ma trận khả nghịch và khi decrypt mỗi dòng của flag (trừ dòng cuối) phải cho kết quả nằm trong <code class="docutils literal notranslate"><span class="pre">alphabet</span></code>.</p>
<p>Code giải mình để ở <a class="reference download internal" download="" href="../_downloads/ef3e31e141e8a247acbf80f9c66eaf54/solve.py"><code class="xref download docutils literal notranslate"><span class="pre">solve.py</span></code></a>.</p>
</section>
<section id="alkane">
<h2>alkane<a class="headerlink" href="#alkane" title="Link to this heading">¶</a></h2>
<p>Bài này mình giải ra sau cùng do một số nhầm lẫn.</p>
<p>Giả sử gọi dòng <span class="math notranslate nohighlight">\(i\)</span> của <cite>schedule</cite> là <span class="math notranslate nohighlight">\(S^{(i)} = ( s^{(i)}_0, s^{(i)}_1, \ldots, s^{(i)}_{63} )\)</span>.</p>
<p>Gọi key là <span class="math notranslate nohighlight">\(K = k_0 k_1 \ldots k_{128}\)</span>. Khi đó mảng <cite>arr</cite> sẽ được tạo bằng cách</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{arr}_i = k_{s^{(i)}_0} \oplus k_{s^{(i)}_1} \oplus \ldots \oplus k_{s^{(i)}_{63}}.\]</div>
</div>
<p>Ý tưởng của mình là xem phép tính trên như một tích vô hướng của hai vector <span class="math notranslate nohighlight">\(\bar{a}_i = (a_0, \ldots, a_{127})\)</span> và <span class="math notranslate nohighlight">\(K\)</span>, với <span class="math notranslate nohighlight">\(a_j = 1\)</span> nếu <span class="math notranslate nohighlight">\(j\)</span> nằm trong <span class="math notranslate nohighlight">\(S^{(i)}\)</span>, ngược lại thì <span class="math notranslate nohighlight">\(a_j = 0\)</span>.</p>
<p>Khi mình xây dựng ma trận <span class="math notranslate nohighlight">\(M\)</span> gồm các dòng là các vector <span class="math notranslate nohighlight">\(\bar{a}_i\)</span> như trên thì mình không decrypt ra được. Mãi về sau mình mới phát hiện rằng trong <span class="math notranslate nohighlight">\(S^{(i)}\)</span> có một số phần tử trùng nhau chứ không hoàn toàn là <span class="math notranslate nohighlight">\(64\)</span> phần tử phân biệt.</p>
<p>Khi đó mình cần xem số lần mỗi phần tử xuất hiện trong <span class="math notranslate nohighlight">\(S^{(i)}\)</span> là chẵn hay lẻ.</p>
<p>Một vấn đề khác là ma trận <span class="math notranslate nohighlight">\(M\)</span> có rank bằng 127, không phải full rank. Do đó để tìm tất cả nghiệm của hệ phương trình mình cần cộng với tất cả tổ hợp tuyến tính của các vector trong kernel.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sage.all</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">m</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;yellow submarine&#39;</span>
<span class="n">c</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\xb7\x8e\xb3\xd9\xfd\xf2\x1f\xa2\xea</span><span class="s1">z</span><span class="se">\xe3\x0f\x00</span><span class="s1">xj</span><span class="se">\x08</span><span class="s1">&#39;</span>

<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">xor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_bit</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">byte</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">n</span> <span class="o">//</span> <span class="mi">8</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">byte</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">7</span> <span class="o">-</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">8</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mi">1</span>

<span class="k">def</span><span class="w"> </span><span class="nf">set_bit</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="n">byte</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">n</span> <span class="o">//</span> <span class="mi">8</span><span class="p">]</span>
    <span class="n">byte</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">7</span> <span class="o">-</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">8</span><span class="p">)))</span>
    <span class="n">byte</span> <span class="o">|=</span> <span class="n">v</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">7</span> <span class="o">-</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">b</span><span class="p">[</span><span class="n">n</span> <span class="o">//</span> <span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte</span>
    <span class="k">return</span> <span class="n">b</span>

<span class="k">def</span><span class="w"> </span><span class="nf">rrot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)):</span>
        <span class="n">arr</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">arr</span>

<span class="k">def</span><span class="w"> </span><span class="nf">lrot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)):</span>
        <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x1</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">arr</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">challenge</span><span class="w"> </span><span class="kn">import</span> <span class="n">schedule</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">bit_loc</span> <span class="ow">in</span> <span class="n">schedule</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">bit_loc</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">arr</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="n">get_bit</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">)])</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span> <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ker</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">()</span>

<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ker</span><span class="o">.</span><span class="n">basis</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span>

<span class="n">sol_</span> <span class="o">=</span> <span class="n">sol</span> <span class="o">+</span> <span class="n">ker</span><span class="o">.</span><span class="n">basis</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">M</span> <span class="o">*</span> <span class="n">sol</span> <span class="o">==</span> <span class="n">arr</span> <span class="ow">and</span> <span class="n">M</span> <span class="o">*</span> <span class="n">sol_</span> <span class="o">==</span> <span class="n">arr</span>

<span class="n">key</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
    <span class="n">set_bit</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;tjctf{&quot;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>

<span class="n">key_</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
    <span class="n">set_bit</span><span class="p">(</span><span class="n">key_</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">sol_</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;tjctf{&quot;</span> <span class="o">+</span> <span class="n">key_</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="lightweight-crypto-guard-system">
<h2>lightweight-crypto-guard-system<a class="headerlink" href="#lightweight-crypto-guard-system" title="Link to this heading">¶</a></h2>
<p>Đây là một bài LCG cũng không quá phức tạp.</p>
<p>Với seed ban đầu <span class="math notranslate nohighlight">\(x_0\)</span>, chuỗi sẽ được sinh theo công thức <span class="math notranslate nohighlight">\(x_{i+1} = (a x_i + b) \bmod m\)</span>. Ở đây cả <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span> và <span class="math notranslate nohighlight">\(m\)</span> đều không biết.</p>
<p>Có nhiều hướng dẫn mình tham khảo để tìm lại modulo <span class="math notranslate nohighlight">\(m\)</span> và <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span> (mình lười :v). Ví dụ như ở <a class="reference external" href="https://math.stackexchange.com/questions/2724959/how-to-crack-a-linear-congruential-generator-lcg">link</a>.</p>
<p>Nhưng vấn đề ở bài này là chúng ta được cho  một đoạn liên tục <span class="math notranslate nohighlight">\(x_0, x_1, x_2, \ldots\)</span> mà thay vào đó là <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_{1+n}\)</span>, <span class="math notranslate nohighlight">\(x_{2n+1}\)</span> (tổng có 6 số).</p>
<p>Thực ra cách giải vẫn giống nhau. Đầu tiên mình recover modulo <span class="math notranslate nohighlight">\(m\)</span>. Sau đó để ý rằng</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}x_1 &amp; = (a x_0 + b) \bmod m \\
x_2 &amp; = (a x_1 + b) \bmod m = (a \cdot (a x_0 + b) + b) = (a^2 x_0 + ab + b) \bmod m \\
x_3 &amp; = (a x_2 + b) \bmod m = \ldots = a^3 x_0 + a^2 b + ab + b = a^3 x_0 + \dfrac{a^3 - 1}{a - 1} \cdot b \bmod m.\end{split}\]</div>
</div>
<p>Cứ tương tự vậy mình có <span class="math notranslate nohighlight">\(x_{i+n} = (A x_n + B) \bmod m\)</span>,</p>
<p>với <span class="math notranslate nohighlight">\(A = a^n \bmod m\)</span> và <span class="math notranslate nohighlight">\(B = \dfrac{a^n - 1}{a - 1} \cdot b \bmod m\)</span>.</p>
<p>Như vậy mình có một LCG mới và giải ra được <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>Sau đó mình recover lại <span class="math notranslate nohighlight">\(a\)</span> và <span class="math notranslate nohighlight">\(b\)</span>. Như vậy là mình sinh được toàn bộ dãy.</p>
</section>
<section id="hulksmash">
<h2>hulksmash<a class="headerlink" href="#hulksmash" title="Link to this heading">¶</a></h2>
<p>Với hint là file <code class="docutils literal notranslate"><span class="pre">keysmashes.txt</span></code> thì các dòng trong file sẽ giúp mình tìm key.</p>
<p>Để ý rằng mỗi dòng chỉ gồm các ký tự <code class="docutils literal notranslate"><span class="pre">fjdlska;</span></code> (<span class="math notranslate nohighlight">\(8\)</span> ký tự, mỗi ký tự xuất hiện hai lần).</p>
<p>Để ý thêm xíu nữa, mình phát hiện ra mỗi ký tự xuất hiện hai lần vào vị trí hoặc đều chẵn, hoặc đều lẻ. Cụ thể là các ký tự <code class="docutils literal notranslate"><span class="pre">fdsa</span></code> sẽ ở vị trí chẵn còn <code class="docutils literal notranslate"><span class="pre">jlk;</span></code> ở vị trí lẻ.</p>
<p>Như vậy mình bruteforce tất cả tổ hợp như vậy và thử decrypt ...</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">combinations</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;keysmashes.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">rf</span><span class="p">:</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">rf</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>

<span class="n">alphabet</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;fjdlska;&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span>

<span class="n">ct</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s1">&#39;ed05f1440f3ae5309a3125a91dfb0edef306e1a64d1c5f7d8cea88cdb7a0d7d66bb36860082a291138b48c5a6344c1ab&#39;</span><span class="p">)</span>

<span class="n">odd</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
<span class="n">even</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>

<span class="k">for</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">odd</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    <span class="n">ox</span> <span class="o">=</span> <span class="n">odd</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">ox</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">oy</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">oy</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">oy</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">])</span>
            <span class="k">assert</span> <span class="nb">set</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">])</span> <span class="o">==</span> <span class="n">odd</span>
            <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">even</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">ea</span> <span class="o">=</span> <span class="n">even</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">ea</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">eb</span> <span class="o">=</span> <span class="n">ea</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">])</span>
                    <span class="k">for</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">eb</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
                        <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">eb</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">])</span>
                        <span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">16</span>
                        <span class="n">key</span><span class="p">[</span><span class="n">x1</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">x2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;j&#39;</span><span class="p">)</span>
                        <span class="n">key</span><span class="p">[</span><span class="n">y1</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">y2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
                        <span class="n">key</span><span class="p">[</span><span class="n">z1</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">z2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
                        <span class="n">key</span><span class="p">[</span><span class="n">t1</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">t2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

                        <span class="n">key</span><span class="p">[</span><span class="n">a1</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">a2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
                        <span class="n">key</span><span class="p">[</span><span class="n">b1</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">b2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
                        <span class="n">key</span><span class="p">[</span><span class="n">c1</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">c2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
                        <span class="n">key</span><span class="p">[</span><span class="n">d1</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">d2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>

                        <span class="n">aes</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_ECB</span><span class="p">)</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">aes</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="k">pass</span>
</pre></div>
</div>
<p>Tiếp theo mình sẽ trình bày các bài mình làm sau khi giải kết thúc (có tham khảo writeup).</p>
</section>
<section id="c-8">
<h2>c-8<a class="headerlink" href="#c-8" title="Link to this heading">¶</a></h2>
<p>Đề bài cho mình các file <code class="docutils literal notranslate"><span class="pre">enc.py</span></code>, <code class="docutils literal notranslate"><span class="pre">dec.py</span></code>, <code class="docutils literal notranslate"><span class="pre">re_plaus</span></code>, <code class="docutils literal notranslate"><span class="pre">plausibly.deniable</span></code>. Với hint là affine cipher và modulo <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">18446744073709551629</span></code> mình cần khôi phục lại bốn file trên.</p>
<p>Do <span class="math notranslate nohighlight">\(n\)</span> có <span class="math notranslate nohighlight">\(65\)</span> bit nên việc mã hóa theo mã affine sẽ mã hóa <span class="math notranslate nohighlight">\(8\)</span> bytes một lần ra <span class="math notranslate nohighlight">\(9\)</span> bytes của ciphertext. Các bạn cũng có thể thấy rằng byte đầu của mỗi đoạn <span class="math notranslate nohighlight">\(9\)</span> bytes các file trên là <code class="docutils literal notranslate"><span class="pre">0x00</span></code> hoặc <code class="docutils literal notranslate"><span class="pre">0x01</span></code>.</p>
<p>Mã affine có dạng <span class="math notranslate nohighlight">\(y = ax + b \bmod n\)</span> với <span class="math notranslate nohighlight">\(a\)</span> và <span class="math notranslate nohighlight">\(b\)</span> là hai số chưa biết cần đi tìm. Mình đã có <span class="math notranslate nohighlight">\(y\)</span> và cần dự đoán <span class="math notranslate nohighlight">\(x\)</span> nào sẽ mã hóa ra <span class="math notranslate nohighlight">\(y\)</span> tương ứng. Đoạn đầu của các file mã hóa với Python thường sẽ dùng các thư viện như <code class="docutils literal notranslate"><span class="pre">pycryptodome</span></code>. Mình thử một loạt các kiểu import và tìm ra phần đầu sẽ là</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">AES</span>
</pre></div>
</div>
<p>Mình chỉ cần <span class="math notranslate nohighlight">\(16\)</span> bytes ở trên thôi là được. Dựa vào đó mình khôi phục lại <span class="math notranslate nohighlight">\(a\)</span> và <span class="math notranslate nohighlight">\(b\)</span> rồi decrypt bốn file ban đầu.</p>
</section>
<section id="u-235">
<h2>u-235<a class="headerlink" href="#u-235" title="Link to this heading">¶</a></h2>
<p>Lát viết.</p>
</section>
<section id="titanium-isopropoxide">
<h2>titanium-isopropoxide<a class="headerlink" href="#titanium-isopropoxide" title="Link to this heading">¶</a></h2>
<p>Bài này mã hóa bằng file C++ với thuật toán khá phức tạp.</p>
<p>Bug ở bài này là key được tạo ra từ S-box không đủ mạnh. Sử dụng known-plaintext là flag format <cite>tjctf{</cite> và XOR với <span class="math notranslate nohighlight">\(6\)</span> bytes đầu của ciphertext của hai file mình:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">flag2</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;flag2.txt.enc&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">flag3</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;flag3.txt.enc&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">xor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="n">known_plaintext</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;tjctf{&quot;</span>

<span class="n">key</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">flag2</span><span class="p">,</span> <span class="n">known_plaintext</span><span class="p">)</span>

<span class="n">f2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">f3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flag2</span><span class="p">)):</span>
    <span class="n">f2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">^</span> <span class="n">flag2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">f3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">^</span> <span class="n">flag3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">f2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">f3</span><span class="p">))</span>
</pre></div>
</div>
<p>Ở kết quả thu được từ đoạn code, mình thấy rằng <cite>flag2</cite> khá giống với đoạn văn có nghĩa. Sau dấu <code class="docutils literal notranslate"><span class="pre">{</span></code> là từ <code class="docutils literal notranslate"><span class="pre">this</span></code> (vì có sẵn chữ <code class="docutils literal notranslate"><span class="pre">is</span></code>), sau dấu <code class="docutils literal notranslate"><span class="pre">_</span></code> là <code class="docutils literal notranslate"><span class="pre">cube</span></code>. Như vậy, mình XOR đoạn <code class="docutils literal notranslate"><span class="pre">tjctf{this_cube</span></code> thì sẽ thấy được key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sa">b</span><span class="s1">&#39;&lt;U</span><span class="se">\xed\x18\xed\x18\xed\x18\xed\x18\xed\x18\xf7\x1e\xed</span><span class="s1">&#39;</span>
</pre></div>
</div>
<p>Mình thấy rằng key bắt đầu bởi <code class="docutils literal notranslate"><span class="pre">&lt;U</span></code> và lặp lại cặp byte <code class="docutils literal notranslate"><span class="pre">`\xed\x18</span></code>. Do đó mình có thể decrypt ra flag.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">flag2</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;flag2.txt.enc&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">xor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>

<span class="n">known_plaintext</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;tjctf{&quot;</span>

<span class="n">key</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">flag2</span><span class="p">,</span> <span class="n">known_plaintext</span><span class="p">)</span>

<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">70</span><span class="p">:</span>
    <span class="n">key</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xed\x18</span><span class="s2">&quot;</span>

<span class="n">f2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flag2</span><span class="p">)):</span>
    <span class="n">f2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">^</span> <span class="n">flag2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">f2</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="lithium-stearate">
<h2>lithium-stearate<a class="headerlink" href="#lithium-stearate" title="Link to this heading">¶</a></h2>
<p>Sau khi giải kết thúc một pro đã hint cho mình: Slide attack.</p>
<p>Bài này mình được cho <span class="math notranslate nohighlight">\(20\)</span> cặp plaintext-ciphertext cùng với ciphertext của flag. Thông tin về cipher:</p>
<ul class="simple">
<li><p>độ dài block là <span class="math notranslate nohighlight">\(16\)</span> bits (<span class="math notranslate nohighlight">\(2\)</span> bytes);</p></li>
<li><p>độ dài khóa là <span class="math notranslate nohighlight">\(64\)</span> bits (<span class="math notranslate nohighlight">\(8\)</span> bytes);</p></li>
<li><p>số vòng thực hiện là <span class="math notranslate nohighlight">\(100000\)</span> vòng.</p></li>
</ul>
<p>Hàm mã hóa:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Word</span><span class="w"> </span><span class="nf">encrypt</span><span class="p">(</span><span class="n">Word</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">Key</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Word</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">rounds</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">ksch</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">out</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Trong đó <code class="docutils literal notranslate"><span class="pre">rounds</span> <span class="pre">=</span> <span class="pre">100000</span></code> và <code class="docutils literal notranslate"><span class="pre">ksch</span></code> là key schedule sinh ra subkey cho mỗi vòng.</p>
<section id="round-function">
<h3>round function<a class="headerlink" href="#round-function" title="Link to this heading">¶</a></h3>
<p>Round function là hàm <code class="docutils literal notranslate"><span class="pre">r</span></code> với cấu trúc như sau:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Word</span><span class="w"> </span><span class="nf">r</span><span class="p">(</span><span class="n">Word</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">RKey</span><span class="w"> </span><span class="n">kin</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">RKey</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kin</span><span class="p">;</span>
<span class="w">    </span><span class="n">in</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffff</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffff</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">P_f</span><span class="p">(</span><span class="n">S_f</span><span class="p">(</span><span class="n">in</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Trong đó, <code class="docutils literal notranslate"><span class="pre">P_f</span></code> và <code class="docutils literal notranslate"><span class="pre">S_f</span></code> là hai hàm:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Word</span><span class="w"> </span><span class="nf">S_f</span><span class="p">(</span><span class="n">Word</span><span class="w"> </span><span class="n">in</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">Sbox</span><span class="p">[</span><span class="n">in</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Sbox</span><span class="p">[</span><span class="n">in</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">];</span>
<span class="p">}</span>

<span class="n">Word</span><span class="w"> </span><span class="nf">P_f</span><span class="p">(</span><span class="n">Word</span><span class="w"> </span><span class="n">in</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>

<span class="w">    </span><span class="n">Word</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">out</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="p">(</span><span class="n">in</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">;</span>
<span class="w">    </span><span class="n">out</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="p">(</span><span class="n">in</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xff</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>
<span class="w">    </span><span class="n">out</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>

<span class="w">    </span><span class="n">Word</span><span class="w"> </span><span class="n">out2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">out2</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>
<span class="w">    </span><span class="n">out2</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="mi">16</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">out2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Như vậy, <code class="docutils literal notranslate"><span class="pre">S_f</span></code> là hàm sử dụng S-box cho trước, và <code class="docutils literal notranslate"><span class="pre">P_f</span></code> là hàm hoán vị. Mình kí hiệu hai hàm này là <span class="math notranslate nohighlight">\(S_f\)</span> và <span class="math notranslate nohighlight">\(P_f\)</span>.</p>
<p>Như vậy round function có dạng <span class="math notranslate nohighlight">\(out = P_f(S_f(out \oplus k))\)</span>, trong đó <span class="math notranslate nohighlight">\(r\)</span> là số <span class="math notranslate nohighlight">\(16\)</span> bits và <span class="math notranslate nohighlight">\(k\)</span> cũng là số <span class="math notranslate nohighlight">\(16\)</span> bits. Ở đây lưu ý rằng tham số thứ hai của <cite>r</cite> là số <span class="math notranslate nohighlight">\(32\)</span> bits nhưng thực chất là lấy nửa đầu XOR nửa cuối, như vậy key được dùng có <span class="math notranslate nohighlight">\(16\)</span> bits.</p>
</section>
<section id="key-schedule">
<h3>key schedule<a class="headerlink" href="#key-schedule" title="Link to this heading">¶</a></h3>
<p>Thuật toán sinh khóa <code class="docutils literal notranslate"><span class="pre">ksch</span></code> lấy đầu vào là khóa ban đầu <span class="math notranslate nohighlight">\(8\)</span> bytes và vòng hiện tại <span class="math notranslate nohighlight">\(i\)</span> để sinh ra khóa <span class="math notranslate nohighlight">\(k_i\)</span>. Khi thử in ra tất cả <span class="math notranslate nohighlight">\(1000000\)</span> khóa khi mã hóa một plaintext bất kì thì chúng ta có thể thấy rằng <strong>chỉ có đúng bốn subkey xoay vòng</strong>.</p>
<p>Kết hợp với lúc nãy mình chỉ ra, mỗi round function lấy vào key <span class="math notranslate nohighlight">\(32\)</span> bits nhưng thực chất chỉ là <span class="math notranslate nohighlight">\(16\)</span> bits. Như vậy nếu bruteforce cả bốn vòng với bốn subkeys thì sẽ cần <span class="math notranslate nohighlight">\(16 \times 4 = 64\)</span> bits. À thì nó cũng chả khác việc key ban đầu có <span class="math notranslate nohighlight">\(64\)</span> bits :))) nên chúng ta sẽ không bruteforce kiểu này.</p>
<p>Chúng ta sẽ xem kỹ hơn hàm sinh khóa con <code class="docutils literal notranslate"><span class="pre">ksch</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">RKey</span><span class="w"> </span><span class="nf">ksch</span><span class="p">(</span><span class="n">Key</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// .............</span>
<span class="w">    </span><span class="n">k</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mh">0xff</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">24</span><span class="p">;</span>
<span class="w">    </span><span class="n">k</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mh">0xffULL</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="mi">24</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// .............</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Đoạn trên cho thấy rằng, sau một hồi biến đổi, hàm <code class="docutils literal notranslate"><span class="pre">ksch</span></code> sẽ set bit thứ <span class="math notranslate nohighlight">\(3\)</span> và thứ <span class="math notranslate nohighlight">\(7\)</span> của biến <code class="docutils literal notranslate"><span class="pre">k</span></code> thành <code class="docutils literal notranslate"><span class="pre">0xff</span></code>, nghĩa là <code class="docutils literal notranslate"><span class="pre">k</span></code> lúc này có dạng <code class="docutils literal notranslate"><span class="pre">0xff------ff------</span></code> (<span class="math notranslate nohighlight">\(64\)</span> bits).</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">RKey</span><span class="w"> </span><span class="nf">ksch</span><span class="p">(</span><span class="n">Key</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// .............</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffffffff</span><span class="p">;</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="mi">1162466901</span><span class="p">;</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mi">3726821653</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffffffff</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffffffff</span><span class="p">);</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="mi">3811777446</span><span class="p">;</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1240568533</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffffffff</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffffffff</span><span class="p">);</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="mi">3915669785</span><span class="p">;</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1247778533</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffffffff</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffffffff</span><span class="p">);</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="mi">3140176925</span><span class="p">;</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1934965865</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Ở phần kế của hàm <code class="docutils literal notranslate"><span class="pre">ksch</span></code> có <span class="math notranslate nohighlight">\(3/4\)</span> trường hợp <code class="docutils literal notranslate"><span class="pre">r</span></code> là XOR của <span class="math notranslate nohighlight">\(32\)</span> bits cao và <span class="math notranslate nohighlight">\(32\)</span> bits thấp. Ở trên mình đã phân tích rằng bytes thứ <span class="math notranslate nohighlight">\(3\)</span> và thứ <span class="math notranslate nohighlight">\(7\)</span> của <code class="docutils literal notranslate"><span class="pre">k</span></code> sẽ là <code class="docutils literal notranslate"><span class="pre">0xff</span></code> nên khi XOR như vậy sẽ triệt tiêu byte đầu tiên của <code class="docutils literal notranslate"><span class="pre">r</span></code>, nên <code class="docutils literal notranslate"><span class="pre">r</span></code> chỉ còn <span class="math notranslate nohighlight">\(24\)</span> bits và chúng ta sẽ bruteforce ở đây.</p>
<p>Trong trường hợp <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">0</span></code> thì chương trình cũng chỉ lấy <span class="math notranslate nohighlight">\(32\)</span> bits thấp nên chúng ta có thể bỏ qua. Lý do sẽ được trình bày ở phần sau.</p>
</section>
<section id="slide-attack">
<h3>slide attack<a class="headerlink" href="#slide-attack" title="Link to this heading">¶</a></h3>
<p><em>Giới thiệu qua loa:</em> slide attack là phương pháp tấn công block cipher thông qua việc chọn các cặp plaintext-ciphertext <span class="math notranslate nohighlight">\((P, C)\)</span> và  <span class="math notranslate nohighlight">\((P', C')\)</span> mà <span class="math notranslate nohighlight">\(P' = F(P)\)</span> và <span class="math notranslate nohighlight">\(C' = F(C)\)</span> với <span class="math notranslate nohighlight">\(F(x)\)</span> là hàm nào đó. Khi thỏa mãn các điều kiện trên thì ta có thể thực hiện slide attack.</p>
<p>Để tìm hàm <span class="math notranslate nohighlight">\(F(x)\)</span> như vậy thì phụ thuộc vào cipher nào. Thông thường hàm <span class="math notranslate nohighlight">\(F(x)\)</span> sẽ chứa một hoặc nhiều round, trong đó chứa tất cả khóa con của cipher.</p>
<p><strong>Ví dụ.</strong> Xét mô hình cipher đơn giản sau:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[P \xrightarrow{K_0} O_1 \xrightarrow{K_1} O_2 \xrightarrow{K_0} O_3 \xrightarrow{K_1} O_3 = C.\]</div>
</div>
<p>Như vậy hàm <span class="math notranslate nohighlight">\(F(x)\)</span> ở đây sẽ chứa hai subkey là <span class="math notranslate nohighlight">\(K_0\)</span> và <span class="math notranslate nohighlight">\(K_1\)</span>. Do đó sơ đồ của <span class="math notranslate nohighlight">\(F\)</span> sẽ là:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[P \xrightarrow{F} O_2 \xrightarrow{F} C.\]</div>
</div>
<p>Giả sử với một cặp plaintext-ciphertext khác là:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[P' \xrightarrow{K_0} O_1 \xrightarrow{K_1} O_2 \xrightarrow{K_0} O_3 \xrightarrow{K_1} O_3 = C'.\]</div>
</div>
<p>hay tương đương là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[P' \xrightarrow{F} O'_2 \xrightarrow{F} C'.\]</div>
</div>
<p>Slide attack lúc này sẽ hoạt động nếu <span class="math notranslate nohighlight">\(P' = O_2 = F(P)\)</span> và <span class="math notranslate nohighlight">\(C' = F(C)\)</span>. Khi vẽ ra sẽ có dạng:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\begin{align*}
    P &amp; \xrightarrow{F} &amp; O_2 &amp; \xrightarrow{F} &amp; C &amp; \\
    &amp; &amp; P' &amp; \xrightarrow{F} &amp; O_2' &amp; \xrightarrow{F} &amp; C'
\end{align*}</div></div>
<p>Quay lại bài lithium-stearate này, do chỉ có bốn subkeys nên có thể xem hàm <span class="math notranslate nohighlight">\(F\)</span> ở trên có dạng:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[F(P, K) = G(G(G(G(P, K_0), K_1), K_2), K_3) = P'.\]</div>
</div>
<p>Trong đó <span class="math notranslate nohighlight">\(K\)</span> là khóa ban đầu <span class="math notranslate nohighlight">\(64\)</span> bits và mỗi <span class="math notranslate nohighlight">\(K_i\)</span> là khóa con <span class="math notranslate nohighlight">\(32\)</span> bits. Hàm <span class="math notranslate nohighlight">\(G(x, k) = P_f(S_f(x \oplus k))\)</span> là round function.</p>
<p>Như vậy chiến thuật để giải bài này là:</p>
<ul class="simple">
<li><p>Tìm trong <span class="math notranslate nohighlight">\(20\)</span> cặp plaintext-ciphertext đề cho các cặp <span class="math notranslate nohighlight">\((P, C)\)</span> và <span class="math notranslate nohighlight">\((P', C')\)</span> sao cho <span class="math notranslate nohighlight">\(F(P, K) = P'\)</span> và <span class="math notranslate nohighlight">\(F(C, K) = C'\)</span>.</p></li>
<li><p>Từ hai cặp plaintext-ciphertext trên khôi phục khóa <span class="math notranslate nohighlight">\(K\)</span>.</p></li>
</ul>
<p>Tuy nhiên việc này khó khăn vì không có khóa <span class="math notranslate nohighlight">\(K\)</span> thì không kiểm tra được điều kiện <span class="math notranslate nohighlight">\(F(P, K) = P'\)</span>. Do đó chúng ta sẽ làm ngược lại.</p>
<p>Như ở trên đã phân tích, <span class="math notranslate nohighlight">\(K_1\)</span>, <span class="math notranslate nohighlight">\(K_2\)</span> và <span class="math notranslate nohighlight">\(K_3\)</span> được sinh ra từ một <code class="docutils literal notranslate"><span class="pre">k</span></code> có <span class="math notranslate nohighlight">\(24\)</span> bits, do đó chúng ta bruteforce các <code class="docutils literal notranslate"><span class="pre">k</span></code> như vậy và tính ra <span class="math notranslate nohighlight">\(K_1\)</span>, <span class="math notranslate nohighlight">\(K_2\)</span> và <span class="math notranslate nohighlight">\(K_3\)</span> tương ứng.</p>
<p>Với mỗi hai plaintext <span class="math notranslate nohighlight">\(P_i\)</span> và <span class="math notranslate nohighlight">\(P_j\)</span> ta tính <span class="math notranslate nohighlight">\(K_0\)</span> theo <span class="math notranslate nohighlight">\(K_0 = S_f^{-1}(P^{-1}(T)) \oplus P\)</span>, với</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[T = G^{-1}(G^{-1}(G^{-1}(P', K_3), K_2), K_1)..\]</div>
</div>
<p>Khi đã có đủ <span class="math notranslate nohighlight">\(K_0\)</span>, <span class="math notranslate nohighlight">\(K_1\)</span>, <span class="math notranslate nohighlight">\(K_2\)</span> và <span class="math notranslate nohighlight">\(K_3\)</span>, mình sẽ kiểm tra điều kiện <span class="math notranslate nohighlight">\(C' = F(C, K)\)</span>. Nếu thỏa mãn thì mình có được một cặp <strong>slid pair</strong> và sẽ thử mã hóa hai cặp plaintext-ciphertext bất kì để xem việc mã hóa với khóa có đúng không.</p>
<p>Khi tìm được khóa rồi thì mình giải mã lại flag.</p>
<p>Sau khi chạy <a class="reference download internal" download="" href="../_downloads/23200f86063f961d9c00bdd396dfef1d/findkey.cpp"><code class="xref download docutils literal notranslate"><span class="pre">findkey.cpp</span></code></a> thì mình tìm được key là <span class="math notranslate nohighlight">\(11892\)</span>, <span class="math notranslate nohighlight">\(8704\)</span>, <span class="math notranslate nohighlight">\(3384\)</span>, <span class="math notranslate nohighlight">\(38922\)</span>. Sau đó mình decrypt ra flag. Ở đây mình compile với flag <code class="docutils literal notranslate"><span class="pre">-O3</span></code> và <code class="docutils literal notranslate"><span class="pre">openmp</span></code> vì mình không có nhiều kinh nghiệm dùng GCC lắm. :))) Code cũng sẽ chạy nhanh hơn nếu sử dụng các flag khác, cũng như C++ khác như 11, ...</p>
<p>Lệnh compile:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>g++<span class="w"> </span>-O3<span class="w"> </span>findkey.cpp<span class="w"> </span>-o<span class="w"> </span>findkey<span class="w"> </span>-fopenmp
</pre></div>
</div>
<p>Cuối cùng chúng ta giải mã với file <a class="reference download internal" download="" href="../_downloads/75709de5bd8e32bda011f66bc1895dbf/decrypt.cpp"><code class="xref download docutils literal notranslate"><span class="pre">decrypt.cpp</span></code></a>.</p>
<p>Mình dành hẳn một phần cho một bài vì bài này khá dài và phức tạp.</p>
<p>Đây cũng là bài viết đầu tiên của mình về một phương pháp tấn công cực kì phổ biến là differential attack (phá mã vi sai).</p>
</section>
</section>
<section id="tetraethyllead">
<h2>tetraethyllead<a class="headerlink" href="#tetraethyllead" title="Link to this heading">¶</a></h2>
<p>Đây là một cipher sử dụng mô hình Feistel để mã hóa. Mô hình Feistel thường xuyên bị tấn công theo phương pháp differential, có thể kể đến như: DES, GOST, hay các phiên bản nhỏ hơn của chúng.</p>
<p>Do đó yêu cầu chống lại differential attack (cũng như người anh em khác của nó là linear attack) trở thành tiêu chuẩn để xây dựng block cipher hiện nay.</p>
<section id="mo-hinh-feistel">
<h3>Mô hình Feistel<a class="headerlink" href="#mo-hinh-feistel" title="Link to this heading">¶</a></h3>
<p>Trong mô hình Feistel, mỗi block của plaintext sẽ được chia đôi thành hai nửa trái phải - <span class="math notranslate nohighlight">\(P = L_0 \Vert R_0\)</span>.</p>
<p>Ở bài này, plaintext có <span class="math notranslate nohighlight">\(8\)</span> bytes và key cũng có <span class="math notranslate nohighlight">\(8\)</span> bytes.</p>
<p>Trong mô hình Feistel chuẩn, ở mỗi vòng <span class="math notranslate nohighlight">\(i+1\)</span>, sẽ thực hiện biến đổi sau:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[L_{i+1} = R_i, \quad R_{i+1} = L_i \oplus F(R_i, K_{i+1}).\]</div>
</div>
<p>Trong đó:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(K_{i+1}\)</span> là khóa ở vòng <span class="math notranslate nohighlight">\(i+1\)</span> với <span class="math notranslate nohighlight">\(i = 0, 1, \ldots\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(F\)</span> được gọi là round function. Hàm <span class="math notranslate nohighlight">\(F\)</span> phụ thuộc vào cipher là loại nào. Ví dụ thuật toán DES thì <span class="math notranslate nohighlight">\(F\)</span> là các phép biến đổi Expand, P-box và S-box. Hoặc đối với thuật toán GOST thì <span class="math notranslate nohighlight">\(F\)</span> gồm cộng modulo <span class="math notranslate nohighlight">\(2^{32}\)</span>, S-box và dịch <span class="math notranslate nohighlight">\(11\)</span> bit sang trái.</p></li>
</ul>
<p>Ở mô hình Feistel bên trên (cũng là mô hình chuẩn) thì hàm <span class="math notranslate nohighlight">\(F\)</span> cố định cho mỗi vòng. Tuy nhiên ở bài này thì round function ở mỗi vòng khác nhau. Cụ thể thì ở vòng một dùng S-box <cite>r2</cite>, ở vòng thứ hai là S-box <cite>r1</cite>, các vòng sau thì dùng hàm <cite>r345</cite>.</p>
<p>Mình có thể viết quá trình biến đổi như sau:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Vòng <span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(L_1 = R_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(R_1 = L_0 \oplus r_2(R_0, S_2)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Vòng <span class="math notranslate nohighlight">\(2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(L_2 = R_1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(R_2 = L_1 \oplus r_1(R_1, S_1)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Vòng <span class="math notranslate nohighlight">\(3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(L_3 = R_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(R_3 = L_2 \oplus r_{345}(R_2, k_2, 3)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Vòng <span class="math notranslate nohighlight">\(4\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(L_4 = R_3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(R_4 = L_3 \oplus r_{345}(R_3, k_2, 4)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Vòng <span class="math notranslate nohighlight">\(5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(L_5 = R_4\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(R_5 = L_4 \oplus r_{345}(R_4, k_1 \oplus k_2, 5)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Vòng <span class="math notranslate nohighlight">\(6\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(L_6 = R_5\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(R_6 = L_5 \oplus r_{345}(R_5, k_1, 6)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Vòng <span class="math notranslate nohighlight">\(7\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(L_7 = L_6 \oplus r_{345}(R_6, k_2, 7)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(R_7 = R_6 \oplus L_7 = R_6 \oplus r_{345}(R_6, k_2, 7)\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Lưu ý rằng vòng cuối hơi khác một tí.</p>
</section>
<section id="differential-attack">
<h3>Differential attack<a class="headerlink" href="#differential-attack" title="Link to this heading">¶</a></h3>
<p>Differential là gì???</p>
<p><strong>Định nghĩa.</strong> Xét hàm <span class="math notranslate nohighlight">\(S\)</span> từ <span class="math notranslate nohighlight">\(\mathbb{F}_2^n\)</span> tới <span class="math notranslate nohighlight">\(\mathbb{F}_2^m\)</span>. Với mỗi cặp vector <span class="math notranslate nohighlight">\(\boldsymbol{a}, \boldsymbol{b} \in \mathbb{F}_2^n\)</span> thì ta nói <span class="math notranslate nohighlight">\(\boldsymbol{a} \oplus \boldsymbol{b}\)</span> là <strong>input differential</strong> và <span class="math notranslate nohighlight">\(S(\boldsymbol{a}) \oplus S(\boldsymbol{b})\)</span> là <strong>output differential</strong> ứng với hàm <span class="math notranslate nohighlight">\(S\)</span>.</p>
<p>Hàm <span class="math notranslate nohighlight">\(S\)</span> thường là các S-box trong block cipher. Các S-box thường không tuyến tính, nghĩa là ta không có <span class="math notranslate nohighlight">\(S(\boldsymbol{a} \oplus \boldsymbol{b}) = S(\boldsymbol{a}) \oplus S(\boldsymbol{b})\)</span>.</p>
<p>Differential dựa trên quan sát rằng khi <span class="math notranslate nohighlight">\(\boldsymbol{a} \oplus \boldsymbol{b}\)</span> cố định thì output differential <span class="math notranslate nohighlight">\(S(\boldsymbol{a}) \oplus S(\boldsymbol{b})\)</span> phân bố không đều. Giả sử mình có S-box như sau:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{|c|c|c|c|c|c|c|c|c||c|c|c|c|c|c|c|c|}
    \hline
    x &amp; 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 &amp; 9 &amp; 10 &amp; 11 &amp; 12 &amp; 13 &amp; 14 &amp; 15\\ \hline
    S(x) &amp; 3 &amp; 14 &amp; 1 &amp; 10 &amp; 4 &amp; 9 &amp; 5 &amp; 6 &amp; 8 &amp; 11 &amp; 15 &amp; 2 &amp; 13 &amp; 12 &amp; 0 &amp; 7 \\ \hline
\end{array}\end{split}\]</div>
</div>
<p>Nếu mình duyệt qua tất cả cặp <span class="math notranslate nohighlight">\(\boldsymbol{a}, \boldsymbol{b} \in \mathbb{F}_2^4\)</span> thì mình sẽ có quan sát sau:</p>
<ul class="simple">
<li><p>Nếu input vi sai là <span class="math notranslate nohighlight">\(0\)</span> thì output vi sai là <span class="math notranslate nohighlight">\(0\)</span> với xác suất <span class="math notranslate nohighlight">\(1\)</span>.</p></li>
<li><p>Nếu input vi sai là <span class="math notranslate nohighlight">\(1\)</span> thì output vi sai là <span class="math notranslate nohighlight">\(13\)</span> với xác suất <span class="math notranslate nohighlight">\(6 / 16\)</span>.</p></li>
<li><p>Nếu input vi sai là <span class="math notranslate nohighlight">\(4\)</span> thì output vi sai là <span class="math notranslate nohighlight">\(7\)</span> với xác suất <span class="math notranslate nohighlight">\(6 / 16\)</span>.</p></li>
<li><p>Nếu input vi sai là <span class="math notranslate nohighlight">\(8\)</span> thì output vi sai là <span class="math notranslate nohighlight">\(5\)</span> với xác suất <span class="math notranslate nohighlight">\(6 / 16\)</span>.</p></li>
<li><p>Nếu input vi sai là <span class="math notranslate nohighlight">\(15\)</span> thì output vi sai là <span class="math notranslate nohighlight">\(14\)</span> với xác suất <span class="math notranslate nohighlight">\(6 / 16\)</span>.</p></li>
</ul>
<p>Đây là những output differential với <strong>xác suất cao nhất</strong> ứng với mỗi input differential cố định <span class="math notranslate nohighlight">\(\boldsymbol{a} \oplus \boldsymbol{b}\)</span>.</p>
<p>Điều đó có nghĩa là cứ trung bình <span class="math notranslate nohighlight">\(16\)</span> cặp <span class="math notranslate nohighlight">\(\boldsymbol{a} \oplus \boldsymbol{b}\)</span> cho kết quả là <span class="math notranslate nohighlight">\(1\)</span> thì có <span class="math notranslate nohighlight">\(6\)</span> cặp cho output differential là <span class="math notranslate nohighlight">\(13\)</span>.</p>
<p>Tận dụng điều này, chúng ta sẽ giải bài tetraethyllead.</p>
<p>Giả sử <span class="math notranslate nohighlight">\((P, C)\)</span> và <span class="math notranslate nohighlight">\((P', C')\)</span> là hai cặp plaintext-ciphertext sao cho khi input differential <span class="math notranslate nohighlight">\(P \oplus P'\)</span> cố định thì xác suất xảy ra của output differential <span class="math notranslate nohighlight">\(C \oplus C'\)</span> cao nhất. Khi tìm được input và output differential như vậy, ta mã hóa nhiều plaintext khác nhau và khả năng (xác suất) xuất hiện ciphertext tương ứng thỏa mãn differential đó sẽ cao.</p>
<p>Giả sử <span class="math notranslate nohighlight">\(P = (L_0, R_0)\)</span> và <span class="math notranslate nohighlight">\(P' = (L'_0, R'_0)\)</span> là hai nửa trái phải tương ứng với <span class="math notranslate nohighlight">\(P\)</span> và <span class="math notranslate nohighlight">\(P'\)</span>.</p>
<p>Đặt <span class="math notranslate nohighlight">\(\Delta L_{in} = L_0 \oplus L'_0\)</span> và <span class="math notranslate nohighlight">\(\Delta R_{in} = R_0 \oplus R_0\)</span> là input differential trước khi mã hóa.</p>
<p>Đặt <span class="math notranslate nohighlight">\(\Delta L_{out} = L_7 \oplus L'_7\)</span> và <span class="math notranslate nohighlight">\(\Delta_{in} = R_7 \oplus R'_7\)</span> là output differential sau khi mã hóa.</p>
<p>Chúng ta sẽ đi qua từng hàm để xem với input-output differential nào thì khả năng xảy ra là cao nhất.</p>
</section>
<section id="differential-vong-1">
<h3>Differential vòng 1<a class="headerlink" href="#differential-vong-1" title="Link to this heading">¶</a></h3>
<p>Sau vòng <span class="math notranslate nohighlight">\(1\)</span> ta có:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(L_1 = R_0\)</span> và <span class="math notranslate nohighlight">\(R_1 = L_0 \oplus r_2(R_0, S_2)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(L'_1 = R'_0\)</span> và <span class="math notranslate nohighlight">\(R'_1 = L'_0 \oplus r_2(R'_0, S_2)\)</span>.</p></li>
</ul>
<p>Khi đó differential ở vòng <span class="math notranslate nohighlight">\(1\)</span> là:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}&amp; \Delta L_1 = L_1 \oplus L'_1 = R_0 \oplus R'_0 \\
&amp; \Delta R_1 = R_1 \oplus R'_1 = L_0 \oplus L'_0 \oplus r_2(R_0, S_2) \oplus r_2(R'_0, S_2).\end{split}\]</div>
</div>
<p>Như vậy <span class="math notranslate nohighlight">\(\Delta R_1\)</span> phụ thuộc vào vi sai của hàm <span class="math notranslate nohighlight">\(r_2\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">r2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">box</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">i</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">box</span><span class="p">[</span><span class="n">byte</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">out</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">^=</span> <span class="n">out</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">out</span><span class="p">]))</span>
</pre></div>
</div>
<p>Giả sử bốn bytes đầu vào của <span class="math notranslate nohighlight">\(r_2\)</span> là <span class="math notranslate nohighlight">\(a \Vert b \Vert c \Vert d\)</span>. Tiếp theo ta thay thế bốn bytes này bởi giá trị S-box của nó là <span class="math notranslate nohighlight">\(S_2(a) \Vert S_2(b) \Vert S_2(c) \Vert S_2(d)\)</span>. Vòng lặp thứ hai XOR chồng các bytes lên nhau để có kết quả:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[S_2(a) \oplus S_2(b) \oplus S_2(c) \oplus S_2(d) \Vert S_2(b) \oplus S_2(c) \oplus S_2(d) \Vert S_2(c) \oplus S_2(d) \Vert S_2(d).\]</div>
</div>
<p>Như vậy nếu <span class="math notranslate nohighlight">\(R_0 = a \Vert b \Vert c \Vert d\)</span> và <span class="math notranslate nohighlight">\(R'_0 = a' \Vert b' \Vert c' \Vert d'\)</span> thì:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}r_2(R_0, S_2) \oplus r_2(R_0', S_2) = &amp; S_2(a) \oplus S_2(b) \oplus S_2(c) \oplus S_2(d) \oplus S_2(a') \oplus S_2(b') \oplus S_2(c') \oplus S_2(d') \\
\Vert &amp; S_2(b) \oplus S_2(c) \oplus S_2(d') \oplus S_2(b') \oplus S_2(c') \oplus S_2(d') \\
\Vert &amp; S_2(c) \oplus S_2(d) \oplus S_2(c') \oplus S_2(d') \\
\Vert &amp; S_2(d) \oplus S_2(d')\end{split}\]</div>
</div>
<p>Dễ thấy rằng nếu chúng ta chọn <span class="math notranslate nohighlight">\(d = d'\)</span> thì byte cuối triệt tiêu.</p>
<p>Tiếp theo chọn <span class="math notranslate nohighlight">\(c = c'\)</span> thì byte kế cuối cũng triệt tiêu.</p>
<p>Tiếp theo chọn <span class="math notranslate nohighlight">\(b = b'\)</span> thì byte thứ ba (từ phải sang trái) cũng triệt tiêu.</p>
<p>Khi đó vi sai sẽ là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[r_2(R_0, S_2) \oplus r_2(R_0', S_2) = S_2(a) \oplus S_2(a') \Vert 00 \Vert 00 \Vert 00.\]</div>
</div>
<p>Bằng một cách <em>ảo ma</em> nào đó thì output differential <span class="math notranslate nohighlight">\(S_2(a) \oplus S_2(a') = 0x80\)</span> có xác suất xảy ra cao nhất khi input differential là <span class="math notranslate nohighlight">\(0x80\)</span>. Cái này writeup nói nhưng chúng ta cũng có thể kiểm tra phân bố vi sai của <span class="math notranslate nohighlight">\(r_2\)</span>.</p>
<p>Đi ngược lên trên thì <span class="math notranslate nohighlight">\(a \Vert b \Vert c \Vert d \oplus a' \Vert b' \Vert c' \Vert d' = 80 \Vert 00 \Vert 00 \Vert 00\)</span>. Đây chính là vi sai cho <span class="math notranslate nohighlight">\(R_0 \oplus R_0'\)</span>.</p>
<p>Như vậy <span class="math notranslate nohighlight">\(\Delta L_1 = 0x80000000\)</span> (với xác suất là <span class="math notranslate nohighlight">\(1\)</span>) và <span class="math notranslate nohighlight">\(\Delta R_1 = L_0 \oplus L_0' \oplus 0x80000000\)</span> (với xác suất cao).</p>
</section>
<section id="differential-vong-2">
<h3>Differential vòng 2<a class="headerlink" href="#differential-vong-2" title="Link to this heading">¶</a></h3>
<p>Tương tự, đối với <span class="math notranslate nohighlight">\(r_1\)</span> chúng ta cũng dùng phương pháp tương tự.</p>
<p>Sau vòng <span class="math notranslate nohighlight">\(2\)</span> ta có:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(L_2 = R_1\)</span> và <span class="math notranslate nohighlight">\(R_2 = L_1 \oplus r_1(R_1, S_1)\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(L'_2 = R'_1\)</span> và <span class="math notranslate nohighlight">\(R'_2 = L'_1 \oplus r_1(R'_1, S_1)\)</span>.</p></li>
</ul>
<p>Khi đó differential ở vòng <span class="math notranslate nohighlight">\(2\)</span> là:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Delta L_2 = L_2 \oplus L'_2 = R_1 \oplus R'_1 = L_0 \oplus L_0' \oplus 0x80000000.\]</div>
</div>
<p>với xác suất cao.</p>
<p>Tương tự</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Delta R_2 = R_2 \oplus R'_2 = L_1 \oplus L'_1 \oplus r_1(R_1, S_1) \oplus r_1(R'_1, S_1) = 0x80000000 \oplus r_1(R_1, S_1) \oplus r_1(R'_1, S_1).\]</div>
</div>
<p>Khi này, <span class="math notranslate nohighlight">\(R_1 \oplus R_1'\)</span> rất khó kiểm soát nên chúng ta sẽ khiến <span class="math notranslate nohighlight">\(R_1 = R_1'\)</span>. Khi đó <span class="math notranslate nohighlight">\(r_1(R_1, S_1) \oplus r_1(R_1', S_1) = 00\)</span> với xác suất bằng <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>Nếu <span class="math notranslate nohighlight">\(R_1 = R_1'\)</span> thì quay ngược lên trên, <span class="math notranslate nohighlight">\(\Delta R_1 = 00 = L_0 \oplus L_0' \oplus 0x80000000\)</span> nên <span class="math notranslate nohighlight">\(L_0 \oplus L_0' = 0x80000000\)</span>.</p>
<p>Như vậy mình đã tìm được input differential cho cả hàm mã hóa là <span class="math notranslate nohighlight">\(L_0 \oplus L_0' = 0x80000000\)</span> và <span class="math notranslate nohighlight">\(R_0 \oplus R_0' = 0x80000000\)</span>.</p>
<p>Lúc này, differential ở vòng <span class="math notranslate nohighlight">\(2\)</span> có xác suất xảy ra cao nhất là <span class="math notranslate nohighlight">\(L_2 \oplus L_2' = 0x00000000\)</span> và <span class="math notranslate nohighlight">\(R_2 \oplus R_2' = 0x80000000\)</span>.</p>
<p>Tiếp theo, mình cần biết output differential nào của toàn bộ hàm <code class="docutils literal notranslate"><span class="pre">encrypt</span></code> sẽ có khả năng xảy ra nhất đối với input differential này.</p>
</section>
<section id="ham-z345">
<span id="id1"></span><h3>Hàm <code class="docutils literal notranslate"><span class="pre">z345</span></code><a class="headerlink" href="#ham-z345" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">r345</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">rnum</span><span class="p">):</span>
    <span class="n">word</span> <span class="o">^=</span> <span class="n">rrot</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="o">-</span><span class="mi">463</span> <span class="o">+</span> <span class="mi">439</span> <span class="o">*</span> <span class="n">rnum</span> <span class="o">+</span> <span class="o">-</span><span class="mi">144</span> <span class="o">*</span> <span class="n">rnum</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">rnum</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">rnum</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="n">lrot</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="mi">63</span> <span class="o">+</span> <span class="o">-</span><span class="mi">43</span> <span class="o">*</span> <span class="n">rnum</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">rnum</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="o">-</span><span class="n">rnum</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>

    <span class="n">word</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4124669716</span> <span class="o">+</span> <span class="n">word</span> <span class="o">*</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="mi">3</span>

    <span class="n">word</span> <span class="o">^=</span> <span class="n">word</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span>
    <span class="n">word</span> <span class="o">^=</span> <span class="n">word</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span>

    <span class="n">word</span> <span class="o">^=</span> <span class="n">rrot</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="o">-</span><span class="mi">463</span> <span class="o">+</span> <span class="mi">439</span> <span class="o">*</span> <span class="n">rnum</span> <span class="o">+</span> <span class="o">-</span><span class="mi">144</span> <span class="o">*</span> <span class="n">rnum</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">rnum</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">rnum</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="n">lrot</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="mi">63</span> <span class="o">+</span> <span class="o">-</span><span class="mi">43</span> <span class="o">*</span> <span class="n">rnum</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">rnum</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="o">-</span><span class="n">rnum</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rrot</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="o">-</span><span class="mi">504</span> <span class="o">+</span> <span class="mi">418</span> <span class="o">*</span> <span class="n">rnum</span> <span class="o">-</span><span class="mi">499</span> <span class="o">*</span> <span class="n">rnum</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="o">-</span><span class="mi">511</span> <span class="o">*</span> <span class="n">rnum</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">98</span> <span class="o">*</span> <span class="n">rnum</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</pre></div>
</div>
<p>Khi thay các giá trị <code class="docutils literal notranslate"><span class="pre">rnum</span></code> vào thì mình thấy có <span class="math notranslate nohighlight">\(3\)</span> vòng <code class="docutils literal notranslate"><span class="pre">rrot</span></code> và <code class="docutils literal notranslate"><span class="pre">lrot</span></code> ngược nhau (<code class="docutils literal notranslate"><span class="pre">rrot(word,</span> <span class="pre">17)</span></code> và <code class="docutils literal notranslate"><span class="pre">lrot(word,</span> <span class="pre">15)</span></code> trên <span class="math notranslate nohighlight">\(32\)</span> bit) nên ở những vòng này <code class="docutils literal notranslate"><span class="pre">rrot</span></code> và <code class="docutils literal notranslate"><span class="pre">lrot</span></code> sẽ triệt tiêu nhau do đa thức.</p>
<p>Tiếp theo, <code class="docutils literal notranslate"><span class="pre">word</span> <span class="pre">^=</span> <span class="pre">word</span> <span class="pre">&lt;&lt;</span> <span class="pre">5</span></code> sẽ không làm thay đổi differential <span class="math notranslate nohighlight">\(0x80\)</span>. Lấy ví dụ với <span class="math notranslate nohighlight">\(8\)</span> bit <span class="math notranslate nohighlight">\(\bar{a} = a_0 a_1 a_2 a_3 a_4 a_5 a_6 a_7\)</span> và <span class="math notranslate nohighlight">\(\bar{b} = b_0 b_1 b_2 b_3 b_4 b_5 b_6 b_7\)</span>. Giả sử <span class="math notranslate nohighlight">\(\bar{a} \oplus \bar{b} = 0x80\)</span> thì:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\bar{a} \oplus (\bar{a} &lt;&lt; 5) \oplus \bar{b} \oplus (\bar{b} &lt;&lt; 5) = &amp; a_0 a_1 a_2 a_3 a_4 a_5 a_6 a_7 \oplus a_5 a_6 a_7 0 0 0 0 0 \\ \oplus &amp; b_0 b_1 b_2 b_3 b_4 b_5 b_6 b_7 \oplus b_5 b_6 b_7 00000 \\ = &amp; \underbrace{(a_0 a_1 a_2 a_3 a_4 a_5 a_6 a_7 \oplus b_0 b_1 b_2 b_3 b_4 b_5 b_6 b_7)}_{0x80} \\ \oplus &amp; \underbrace{(a_5 a_6 a_7 00000 \oplus b_5 b_6 b_7 00000)}_{0x00} = 0x80.\end{split}\]</div>
</div>
<p>Cuối cùng, phép nhân modulo <span class="math notranslate nohighlight">\(2^{32}\)</span> có <span class="math notranslate nohighlight">\(50\%\)</span> duy trì differential <span class="math notranslate nohighlight">\(0x80000000\)</span> và do đó differential này vẫn có xác suất cao cho cả <code class="docutils literal notranslate"><span class="pre">z345</span></code>.</p>
</section>
<section id="giai">
<h3>Giải<a class="headerlink" href="#giai" title="Link to this heading">¶</a></h3>
<p>Chiến thuật để giải bài này là:</p>
<ul class="simple">
<li><p>Gửi lên các cặp plaintext sao cho <span class="math notranslate nohighlight">\(\Delta L_{in} = 0x80000000\)</span> và <span class="math notranslate nohighlight">\(\Delta R_{in} = 0x80000000\)</span>.</p></li>
<li><p>Nhận các cặp ciphertext tương ứng thỏa mãn <span class="math notranslate nohighlight">\(\Delta L_{out} \oplus R_{out} = 0x80000000\)</span>.</p></li>
</ul>
<p>Các cặp plaintext, ciphertext như trên sẽ giúp ta khôi phục lại khóa.</p>
<p><strong>Note.</strong> Để thuận tiện thì mình sẽ cố định khóa trong <cite>server.py</cite> và chỉ cần tìm ra khóa là xong. Ở trong giải thì sau khi request đủ <span class="math notranslate nohighlight">\(1024\)</span> lần encrypt server cũng không đặt timeout nên chúng ta có thể để script chạy bao lâu tùy ý.</p>
<p>File <a class="reference download internal" download="" href="../_downloads/ef95921e6d22319ad2e65b8d2300671e/solve.py"><code class="xref download docutils literal notranslate"><span class="pre">solve.py</span></code></a> sau đây tương tác với <code class="docutils literal notranslate"><span class="pre">server.py</span></code> để lấy về các cặp plaintext, ciphertext thỏa mãn điều kiện trên.</p>
<p>Sau đó sử dụng thư viện SHA256 từ project <a class="reference external" href="https://github.com/System-Glitch/SHA256">SHA256</a> (gồm file <code class="docutils literal notranslate"><span class="pre">SHA256.h</span></code> và <code class="docutils literal notranslate"><span class="pre">SHA256.cpp</span></code>).</p>
<p>Chúng ta cần viết <a class="reference download internal" download="" href="../_downloads/1e627c90f8d592c5104c642205d1b696/solve.h"><code class="xref download docutils literal notranslate"><span class="pre">solve.h</span></code></a> chứa định nghĩa các hàm sẽ dùng để tìm khóa.</p>
<p>Đầu tiên chúng ta sẽ khôi phục <code class="docutils literal notranslate"><span class="pre">k2</span></code> đi ngược từ ciphertex lên. Chúng ta nhận các khóa thỏa mãn <span class="math notranslate nohighlight">\(\Delta L_6 \oplus \Delta R_6 = 0x80000000\)</span> (vòng <span class="math notranslate nohighlight">\(6\)</span>). Để tìm <code class="docutils literal notranslate"><span class="pre">k2</span></code> thì hàm <code class="docutils literal notranslate"><span class="pre">main</span></code> sẽ là:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint32_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">key2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bruteforce_k2</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">key2</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">hex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">key2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sau đó với mỗi <code class="docutils literal notranslate"><span class="pre">k2</span></code> chúng ta bruteforce các <code class="docutils literal notranslate"><span class="pre">k1</span></code> và kiểm tra <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">=</span> <span class="pre">k1</span> <span class="pre">||</span> <span class="pre">k2</span></code> nào sẽ encrypt đúng. Ở đây do mình đã cố định khóa ở <code class="docutils literal notranslate"><span class="pre">server.py</span></code> nên mình biết <code class="docutils literal notranslate"><span class="pre">k2</span></code> nào là đúng để tiết kiệm thời gian viết lại writeup. Sau đó thì chỉ cần bruteforce <code class="docutils literal notranslate"><span class="pre">k1</span></code> thôi.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">k2</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xef</span><span class="p">,</span><span class="w"> </span><span class="mh">0x13</span><span class="p">,</span><span class="w"> </span><span class="mh">0x37</span><span class="p">,</span><span class="w"> </span><span class="mh">0xff</span><span class="w"> </span><span class="p">};</span>
<span class="w">    </span><span class="n">get_sbox</span><span class="p">(</span><span class="n">k2</span><span class="p">,</span><span class="w"> </span><span class="n">sbox2</span><span class="p">);</span>

<span class="w">    </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2194090266659289430ULL</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5313144679078469543ULL</span><span class="p">;</span>

<span class="w">    </span><span class="cp">#pragma omp for</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">k1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mh">0xffffff</span><span class="p">;</span><span class="w"> </span><span class="n">k1</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">k1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mh">0xef1337ff</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">encrypt</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">c</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Found key: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">hex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cám ơn các bạn đã đọc writeup dài lê thê của mình.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="cryptofox/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">CryptoFox 2024</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="ASISCTF-2024/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">ASIS CTF 2024</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Lê Quốc Dũng
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">TJCTF 2024</a><ul>
<li><a class="reference internal" href="#weird-crypto">weird-crypto</a></li>
<li><a class="reference internal" href="#accountleak">accountleak</a></li>
<li><a class="reference internal" href="#assume">assume</a></li>
<li><a class="reference internal" href="#iodomethane">iodomethane</a></li>
<li><a class="reference internal" href="#alkane">alkane</a></li>
<li><a class="reference internal" href="#lightweight-crypto-guard-system">lightweight-crypto-guard-system</a></li>
<li><a class="reference internal" href="#hulksmash">hulksmash</a></li>
<li><a class="reference internal" href="#c-8">c-8</a></li>
<li><a class="reference internal" href="#u-235">u-235</a></li>
<li><a class="reference internal" href="#titanium-isopropoxide">titanium-isopropoxide</a></li>
<li><a class="reference internal" href="#lithium-stearate">lithium-stearate</a><ul>
<li><a class="reference internal" href="#round-function">round function</a></li>
<li><a class="reference internal" href="#key-schedule">key schedule</a></li>
<li><a class="reference internal" href="#slide-attack">slide attack</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tetraethyllead">tetraethyllead</a><ul>
<li><a class="reference internal" href="#mo-hinh-feistel">Mô hình Feistel</a></li>
<li><a class="reference internal" href="#differential-attack">Differential attack</a></li>
<li><a class="reference internal" href="#differential-vong-1">Differential vòng 1</a></li>
<li><a class="reference internal" href="#differential-vong-2">Differential vòng 2</a></li>
<li><a class="reference internal" href="#ham-z345">Hàm <code class="docutils literal notranslate"><span class="pre">z345</span></code></a></li>
<li><a class="reference internal" href="#giai">Giải</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=dd9e4a14"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/translations.js?v=4c1d55b0"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"tex": {"macros": {"bm": ["{\\boldsymbol{#1}}", 1]}}, "chtml": {"mtextInheritFont": "true"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>