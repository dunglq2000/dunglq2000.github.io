<!doctype html>
<html class="no-js" lang="vi" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Tìm Kiếm" href="../../search.html" /><link rel="next" title="4. Algebraic cryptanalysis" href="../algebraic-attack/index.html" /><link rel="prev" title="2.1. Phá mã tuyến tính trên TinyDES" href="../linear-attack/tinydes.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>3. Slide attack - Math Book</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystyles.css?v=fd3ba0dd" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Math Book</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/Euler_Stamp.jpg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Math Book</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Tìm Kiếm" name="q" aria-label="Tìm Kiếm">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../introduction/index.html">Những lời nói đầu</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Những lời nói đầu</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/about-maths.html">Toán học là gì với mình?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/about-notebook.html">Cơ sở xây dựng notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/about-quotations.html">Những lời răn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/about-notation.html">Kí hiệu và công thức toán trong mật mã</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../algebra/index.html">Đại số</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Đại số</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../algebra/set/index.html">1. Đại cương về tập hợp</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of 1. Đại cương về tập hợp</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/set/set.html">1.1. Tập hợp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/set/cadinality.html">1.2. Lực lượng của tập hợp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/set/map.html">1.3. Ánh xạ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/set/function.html">1.4. Hàm số</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/set/infinity.html">1.5. Các nghịch lý về tập vô hạn</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../algebra/polynomial/index.html">2. Đa thức</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of 2. Đa thức</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/polynomial/polynomial.html">2.1. Giới thiệu về đa thức</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/polynomial/polynomial.html#so-sanh-cong-tru-va-nhan-hai-da-thuc">2.2. So sánh, cộng, trừ và nhân hai đa thức</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/polynomial/lagrange-interpolation.html">2.3. Đa thức nội suy Lagrange</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algebra/polynomial/numerical-methods.html">2.4. Phương pháp tính giá trị đa thức</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../algebra/proof.html">3. Phương pháp chứng minh toán học</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../algebra/glossary.html">4. Bảng thuật ngữ đại số</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../abstract-algebra/index.html">Lý thuyết nhóm</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Lý thuyết nhóm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../abstract-algebra/groups/index.html">1. Lý thuyết nhóm</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of 1. Lý thuyết nhóm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/groups/group.html">1.1. Nhóm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/groups/symmetric-group.html">1.2. Nhóm hoán vị</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/groups/quasigroup.html">1.3. Quasigroup</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../abstract-algebra/homomorphisms/index.html">2. Homomorphisms</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of 2. Homomorphisms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/homomorphisms/group-homomorphism.html">2.1. Group homomorphism</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../abstract-algebra/group-action/index.html">3. Tác động nhóm</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of 3. Tác động nhóm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/group-action/group-action.html">3.1. Tác động nhóm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/group-action/burnside.html">3.2. Bổ đề Burnside</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../abstract-algebra/rings/index.html">4. Vành</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 4. Vành</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/rings/ring.html">4.1. Vành</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../abstract-algebra/fields/index.html">5. Trường</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of 5. Trường</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/fields/field.html">5.1. Trường</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/fields/ideal.html">5.2. Ideal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/fields/ring-homomorphism.html">5.3. Ring kernel và ring homomorphism</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../abstract-algebra/galois-theory/index.html">6. Lý thuyết Galois</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of 6. Lý thuyết Galois</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../abstract-algebra/galois-theory/extension-field.html">6.1. Extension Fields</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../abstract-algebra/glossary.html">7. Bảng thuật ngữ lý thuyết nhóm</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../geometry/index.html">Hình học</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Hình học</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../geometry/analytic-geometry/index.html">1. Hình học giải tích</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of 1. Hình học giải tích</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/analytic-geometry/intro.html">1.1. Theo dòng lịch sử</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/analytic-geometry/analytic-geometry.html">1.2. Phương pháp tọa độ trong mặt phẳng</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/analytic-geometry/analytic-geometry.html#dao-ham">1.3. Đạo hàm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/analytic-geometry/analytic-geometry.html#tich-phan">1.4. Tích phân</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/analytic-geometry/conics.html">1.5. Ba đường Conic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/analytic-geometry/transformation.html">1.6. Phép biến hình</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/brachistochrone/brachistochrone.html">2. Đường đoản thời</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../geometry/affine-geometry/index.html">3. Hình học affine</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of 3. Hình học affine</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html">3.1. Không gian affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#phang">3.2. Phẳng</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#doc-lap-affine-va-phu-thuoc-affine">3.3. Độc lập affine và phụ thuộc affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#giao-cua-cac-phang-bao-affine">3.4. Giao của các phẳng. Bao affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#vi-tri-tuong-doi">3.5. Vị trí tương đối</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#muc-tieu-va-toa-do-affine">3.6. Mục tiêu và tọa độ affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#cong-thuc-doi-muc-tieu">3.7. Công thức đổi mục tiêu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#phuong-trinh-cua-m-phang">3.8. Phương trình của <span class="math notranslate nohighlight">\(m\)</span>-phẳng</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#tam-ti-cu-va-ti-so-don">3.9. Tâm tỉ cự và tỉ số đơn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#anh-xa-affine">3.10. Ánh xạ affine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometry/affine-geometry/affine-space.html#su-xac-dinh-anh-xa-affine">3.11. Sự xác định ánh xạ affine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../geometry/noneuclidean.html">4. Hình học phi Euclid</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../calculus/index.html">Giải tích</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Giải tích</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../calculus/calculus/index.html">1. Giải tích</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of 1. Giải tích</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/limits.html">1.1. Giới hạn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/continuity.html">1.2. Tính liên tục của hàm số</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/monotone.html">1.3. Tính đơn điệu và cực trị</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/derivative.html">1.4. Đạo hàm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/avarage-value.html">1.5. Một số định lí về giá trị trung bình</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/calculus/concave.html">1.6. Tính lồi, lõm và điểm uốn của đồ thị</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../calculus/differential-equation/index.html">2. Phương trình vi phân</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../calculus/series/index.html">3. Chuỗi số</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../calculus/derivative/index.html">4. Đạo hàm</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of 4. Đạo hàm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/derivative/partial-derivative.html">4.1. Đạo hàm một số hàm nhiều biến</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../calculus/integral/index.html">5. Tích phân</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of 5. Tích phân</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../calculus/integral/line-integral.html">5.1. Tích phân đường</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../probability/index.html">Xác suất thống kê</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Xác suất thống kê</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../probability/intro.html">Xác suất thống kê</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../probability/ML/index.html">Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Machine Learning</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../probability/ML/linear-regression.html">Linear Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../probability/ML/kmeans.html">K-Means clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../probability/ML/gradient-descent.html">Gradient Descent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../probability/ML/perceptron.html">Perceptron Learning Algorithm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../linalg/index.html">Đại số tuyến tính</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of Đại số tuyến tính</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../linalg/matrix/index.html">1. Ma trận</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of 1. Ma trận</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../linalg/matrix/matrix-determinant.html">1.1. Định thức ma trận</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../linalg/matrix/matrix-inversion.html">1.2. Ma trận nghịch đảo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../linalg/matrix/matrix-rank.html">1.3. Hạng của ma trận</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/linear-operator.html">2. Toán tử tuyến tính</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/eigen.html">3. Trị riêng và vector riêng</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/linear-combination.html">4. Tổ hợp tuyến tính</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/vector-space.html">5. Không gian vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/euclidean-space.html">6. Không gian Euclide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../linalg/hilbert-space.html">7. Không gian Hilbert</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../number-theory/index.html">Lý thuyết số</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Lý thuyết số</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/euclidean.html">1. Phép chia Euclid. Thuật toán Euclid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/linear-congruence.html">2. Phương trình đồng dư tuyến tính</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/euler.html">3. Hàm Euler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/quadratic-residue.html">4. Thặng dư chính phương</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/mobius.html">5. Hàm Möbius</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/dirichlet-convolution.html">6. Tích chập Dirichlet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/chinese-remainder-theorem.html">7. Định lý số dư Trung Hoa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../number-theory/exercises.html">8. Bài tập số học sưu tầm</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../discrete-mathematics/index.html">Toán rời rạc</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Toán rời rạc</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/binary-relation.html">Quan hệ hai ngôi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/partition.html">Phân hoạch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/discrete-fourier-transform.html">Biến đổi Fourier rời rạc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/combinatoric.html">Đại cương tổ hợp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/recurrence-relation.html">Công thức truy hồi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/system-lineq-integer.html">Hệ phương trình tuyến tính trên trường hữu hạn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../discrete-mathematics/graph/index.html">Lý thuyết đồ thị</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../topology/index.html">Topology</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../boolean/index.html">Đại số Bool và mật mã học</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Đại số Bool và mật mã học</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../boolean/intro.html">1. Giới thiệu</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../boolean/boolean-algebra/index.html">2. Đại số Boolean</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of 2. Đại số Boolean</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/boolean-algebra/boolean-function.html">2.1. Hàm boolean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/boolean-algebra/boolean-affine.html">2.2. Hàm affine và hàm tuyến tính</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/boolean-algebra/boolean-monotone.html">2.3. Hàm đơn điệu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/boolean-algebra/boolean-dnf-cnf.html">2.4. Disjunctive và Conjunctive Normal Form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/boolean-algebra/boolean-weight.html">2.5. Khoảng cách Hamming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/boolean-algebra/walsh-hadamard-spectre.html">2.6. Nonlinearity của hàm boolean</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../boolean/block/block-cipher.html">3. Block cipher</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of 3. Block cipher</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block/spnet.html">3.1. SP network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block/AES.html">3.2. AES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block/kuznyechik.html">3.3. Kuznyechik</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block/present.html">3.4. PRESENT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block/feistel.html">3.5. Mô hình Feistel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block/magma.html">3.6. Magma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block/sms4.html">3.7. SMS4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/block/arx.html">3.8. ARX</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../boolean/stream/stream-cipher.html">4. Stream cipher</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of 4. Stream cipher</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../boolean/stream/linear-feedback-shift-register.html">4.1. Linear Feedback Shift Register</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../boolean/mac.html">5. Message Authentication Code</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Phá mã</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of Phá mã</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../differential-attack/index.html">1. Phá mã vi sai</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of 1. Phá mã vi sai</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../differential-attack/toycipher.html">1.1. Nhập môn phá mã vi sai</a></li>
<li class="toctree-l3"><a class="reference internal" href="../differential-attack/tinydes.html">1.2. Phá mã vi sai trên TinyDES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../differential-attack/difference-and-differential.html">1.3. Difference và differential</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../linear-attack/index.html">2. Phá mã tuyến tính</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of 2. Phá mã tuyến tính</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../linear-attack/tinydes.html">2.1. Phá mã tuyến tính trên TinyDES</a></li>
</ul>
</li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">3. Slide attack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algebraic-attack/index.html">4. Algebraic cryptanalysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cryptography/index.html">Mật mã học</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of Mật mã học</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cryptography/lattice-based/index.html">1. Lattice-based cryptography</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle navigation of 1. Lattice-based cryptography</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/lattice-based/intro.html">1.1. Nhập môn mật mã dựa trên lattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/lattice-based/congruential-pubkey.html">1.2. Congruential public key cryptosystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/lattice-based/ntru.html">1.3. NTRU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/lattice-based/falcon.html">1.4. FALCON</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/lattice-based/lattice-reduction-algorithms.html">1.5. Thuật toán rút gọn lattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/lattice-based/coppersmith.html">1.6. Phương pháp Coppersmith</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cryptography/code-based/index.html">2. Code-based cryptography</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle navigation of 2. Code-based cryptography</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/intro.html">2.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/decode-problem.html">2.2. Bài toán decode tổng quát</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/linear-code.html">2.3. Linear code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/weight.html">2.4. Bài toán phổ trọng số của mã tuyến tính</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/decode-on-linear-code.html">2.5. Bài toán decode trên linear code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/equivalence.html">2.6. Bài toán tương đương các linear code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/cryptosystem.html">2.7. Ý tưởng xây dựng các hệ mật mã dựa trên mã sửa sai</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/pubkey-algo.html">2.8. Các hệ mật mã khóa công khai dựa trên lý thuyết code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/code-based/goppa-code.html">2.9. Goppa Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/elliptic/index.html">3. Đường cong elliptic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/Kerckhoffs-principle/index.html">4. Nguyên tắc Kerckhoffs và mật mã học</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/examen.html">5. Câu hỏi ôn thi mật mã học</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cryptography/quantum-computing.html">6. Quantum computing</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cryptography/zero-knowledge-proof/index.html">7. Zero Knowledge Proof</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle navigation of 7. Zero Knowledge Proof</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/zero-knowledge-proof/intro.html">7.1. Giới thiệu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cryptography/zero-knowledge-proof/plonk.html">7.2. Plonk Protocol</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../solutions/index.html">Lời giải các bài tập trong sách tham khảo</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle navigation of Lời giải các bài tập trong sách tham khảo</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../solutions/Judson.html">Abstract Algebra: Theory and Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../solutions/Petrushko/index.html">Курс высшей математики: Теория вероятностей</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../solutions/an-introduction-to-mathematical-cryptography/index.html">An Introduction to Mathematical Cryptography</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle navigation of An Introduction to Mathematical Cryptography</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../solutions/an-introduction-to-mathematical-cryptography/chapter-2.html">Chapter 2. Discrete Logarithms and Diffie-Hellman</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../solutions/an-introduction-to-mathematical-cryptography/chapter-3.html">Chapter 3. Integer Factorization and RSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../solutions/an-introduction-to-mathematical-cryptography/chapter-4.html">Chapter 4. Digital Signatures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../solutions/an-introduction-to-mathematical-cryptography/chapter-7.html">Chapter 7. Lattices and Cryptography</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../solutions/collection.html">Các bài toán sưu tầm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../solutions/cryptohack/index.html">Wargame chill chill</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../2020/index.html">Các cuộc thi năm 2020</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle navigation of Các cuộc thi năm 2020</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../2020/midnightsunCTF-2020.html">Midnight Sun CTF 2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2020/nsucrypto-2020.html">NSUCRYPTO 2020</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../2021/index.html">Các cuộc thi năm 2021</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle navigation of Các cuộc thi năm 2021</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../2021/CryptoCTF/index.html">Crypto CTF 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2021/GoogleCTF/index.html">Google CTF 2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2021/nsucrypto.html">NSUCRYPTO 2021</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../2022/index.html">Các cuộc thi năm 2022</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" role="switch" type="checkbox"/><label for="toctree-checkbox-40"><div class="visually-hidden">Toggle navigation of Các cuộc thi năm 2022</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../2022/downunderCTF/index.html">DownUnder CTF 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2022/nsucrypto.html">NSUCRYPTO 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2022/sekaiCTF/index.html">Sekai CTF 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2022/isitdtu/index.html">ISITDTU Quals 2022</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../2023/index.html">Các cuộc thi năm 2023</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" role="switch" type="checkbox"/><label for="toctree-checkbox-41"><div class="visually-hidden">Toggle navigation of Các cuộc thi năm 2023</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../2023/nsucrypto/index.html">NSUCRYPTO 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/siberian-maths-contest/index.html">Siberian Mathematical Contest 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/amateursCTF.html">Amateurs CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/backdoorCTF.html">Backdoor CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/googleCTF.html">Google CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/diceCTF.html">Dice CTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/UTCTF.html">UTCTF 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023/wolvCTF.html">Wolv CTF 2023</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../2024/index.html">Các cuộc thi năm 2024</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" role="switch" type="checkbox"/><label for="toctree-checkbox-42"><div class="visually-hidden">Toggle navigation of Các cuộc thi năm 2024</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../2024/nsucrypto/index.html">NSUCRYPTO 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024/internet-olympiad/index.html">Internet Olympiad 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024/0xL4ughCTF-2024/index.html">0xL4ugh CTF 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024/ASISCTF-2024/index.html">ASIS CTF 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024/TJCTF.html">TJCTF 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024/cryptofox/index.html">CryptoFox 2024</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024/isitdtu.html">ISITDTU Quals 2024</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../2025/index.html">Các cuộc thi năm 2025</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" role="switch" type="checkbox"/><label for="toctree-checkbox-43"><div class="visually-hidden">Toggle navigation of Các cuộc thi năm 2025</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../2025/cryptofox/index.html">CryptoFox 2025</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2025/tjctf.html">TJCTF 2025</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../stuff/index.html">Ngoài lề</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" role="switch" type="checkbox"/><label for="toctree-checkbox-44"><div class="visually-hidden">Toggle navigation of Ngoài lề</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stuff/game/index.html">Lý thuyết trò chơi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stuff/graphics.html">Một số đồ thị hàm số sưu tầm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stuff/about-godel.html">Về một vị giáo sư và định lý Godel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stuff/about-education.html">Nhìn lại giáo dục từ 2018 về trước</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stuff/about-stoicism.html">Chủ nghĩa khắc kỷ và phân phối nhị thức</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stuff/latex/index.html">Trải nghiệm người dùng với LaTeX</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../russia/index.html">Nước Nga du kí</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" role="switch" type="checkbox"/><label for="toctree-checkbox-45"><div class="visually-hidden">Toggle navigation of Nước Nga du kí</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../russia/intro.html">Giới thiệu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../russia/good-or-bad.html">Đi học ở Nga tốt hay xấu?</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../russia/criticism/index.html">Góc khẩu nghiệp</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" role="switch" type="checkbox"/><label for="toctree-checkbox-46"><div class="visually-hidden">Toggle navigation of Góc khẩu nghiệp</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../russia/criticism/criticism-2.html">Phần 2. Sinh viên Việt Nam tại Moscow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../russia/contests.html">Các cuộc thi toán ở Nga</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../mathematicians/index.html">Sưu tầm những câu chuyện về các nhà toán học</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../men-of-mathematics/index.html">Men of Mathematics</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" role="switch" type="checkbox"/><label for="toctree-checkbox-47"><div class="visually-hidden">Toggle navigation of Men of Mathematics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../men-of-mathematics/dedicate.html">Lời nói đầu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../men-of-mathematics/00-acknowledgement.html">Acknowledgments</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/cryptanalysis/slide-attack/index.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="slide-attack">
<h1><span class="section-number">3. </span>Slide attack<a class="headerlink" href="#slide-attack" title="Link to this heading">¶</a></h1>
<p>Phá mã vi sai (differential cryptanalysis) và phá mã tuyến tính (linear cryptanalysis) dựa trên các phân bổ xác suất khi sử dụng S-box. Một ý tưởng đơn giản để chống lại phân tích xác suất là tăng số vòng lên, khi đó chúng ta cần nhiều cặp bản rõ-bản mã hơn để tìm liên hệ giữa các bit của khóa. Rõ ràng nếu số lượng cặp bản rõ-bản mã quá nhiều thì rất khó để tính toán và lưu trữ nên có thể nói cách tiếp cận này hợp lý.</p>
<p>Tuy nhiên slide attack ra đời và đã chứng minh được rằng số vòng nhiều không đồng nghĩa với an toàn hơn.</p>
<p>Tương tự với hai phần trước, mình vẫn dùng TinyDES làm ví dụ cho slide attack.</p>
<section id="id1">
<h2><span class="section-number">3.1. </span>Slide attack<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p>Slide attack là kỹ thuật tấn công mã khối dạng know-plaintext hoặc chosen-plaintext.</p>
<p>Gọi <span class="math notranslate nohighlight">\(F\)</span> là một hoặc hợp của nhiều phép biến đổi trong thuật toán. Giả sử bản rõ ban đầu là <span class="math notranslate nohighlight">\(P = P_0\)</span>, sau khi đi qua hàm <span class="math notranslate nohighlight">\(F\)</span> sẽ trở thành <span class="math notranslate nohighlight">\(P_1 = F(P_0)\)</span>. Tương tự, <span class="math notranslate nohighlight">\(P_1\)</span> đi qua hàm <span class="math notranslate nohighlight">\(F\)</span> sẽ trở thành <span class="math notranslate nohighlight">\(P_2 = F(P_1)\)</span>. Cứ như vậy tới khi nhận được bản rõ ở cuối thuật toán, giả sử là sau <span class="math notranslate nohighlight">\(n\)</span> lần biến đổi, <span class="math notranslate nohighlight">\(C = P_n\)</span>.</p>
<p>Thông thường, mỗi lần thực hiện phép biến đổi <span class="math notranslate nohighlight">\(F\)</span> cũng sẽ đi kèm một hoặc nhiều khóa con. Khi khóa con được sử dụng lặp lại, gọi là <span class="math notranslate nohighlight">\(K\)</span>, thì ta có sơ đồ</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[P = P_0 \xrightarrow{F_K} P_1 \xrightarrow{F_K} P_2 \xrightarrow{F_K} \cdots \xrightarrow{F_K} P_n = C.\]</div>
</div>
<p>Mục tiêu của slide attack là tìm một cặp bản rõ-bản mã <span class="math notranslate nohighlight">\((P, C)\)</span> và <span class="math notranslate nohighlight">\((P', C')\)</span> mà chúng ta gọi là <strong>slid pair</strong>.</p>
<div class="proof definition admonition" id="def-slid-pair">
<p class="admonition-title"><span class="caption-number">Định nghĩa 3.20 </span> (Slid pair)</p>
<section class="definition-content" id="proof-content">
<p>Xét một phép biến đổi <span class="math notranslate nohighlight">\(F_K\)</span> với <span class="math notranslate nohighlight">\(K\)</span> là khóa được sử dụng lặp lại cho mỗi lần thực hiện hàm <span class="math notranslate nohighlight">\(F\)</span>. Để mã hóa bản rõ <span class="math notranslate nohighlight">\(P\)</span> thành bản mã <span class="math notranslate nohighlight">\(C\)</span> giả sử ta thực hiện theo thứ tự</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[P = P_0 \xrightarrow{F_K} P_1 \xrightarrow{F_K} P_2 \xrightarrow{F_K} \cdots \xrightarrow{F_K} P_n = C.\]</div>
</div>
<p>Tương tự, để mã hóa bản rõ <span class="math notranslate nohighlight">\(P'\)</span> thành bản mã <span class="math notranslate nohighlight">\(C'\)</span> giả sử ta thực hiện theo thứ tự</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[P' = P_0' \xrightarrow{F_K} P_1' \xrightarrow{F_K} P_2' \xrightarrow{F_K} \cdots \xrightarrow{F_K} P_n' = C'.\]</div>
</div>
<p>Khi đó, cặp bản rõ-bản mã <span class="math notranslate nohighlight">\((P, C)\)</span> và <span class="math notranslate nohighlight">\((P', C')\)</span> được gọi là <strong>slid pair</strong> nếu <span class="math notranslate nohighlight">\(F_K(P) = P'\)</span> và <span class="math notranslate nohighlight">\(F_K(C) = C'\)</span>.</p>
</section>
</div><figure class="align-default" id="id3">
<img alt="../../_images/slide_attack.jpg" src="../../_images/slide_attack.jpg" />
<figcaption>
<p><span class="caption-number">Hình 3.17 </span><span class="caption-text">Sơ đồ mô tả slid pair</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Nếu chúng ta có một cặp bản rõ-bản mã là slid pair thì chúng ta có thể trích xuất khóa <span class="math notranslate nohighlight">\(K\)</span> từ hai phương trình. Điểm quan trọng của slide attack là chúng ta chỉ quan tâm hai điều kiện <span class="math notranslate nohighlight">\(F_K(P) = P'\)</span> và <span class="math notranslate nohighlight">\(F_K(C) = C'\)</span>, còn việc hàm <span class="math notranslate nohighlight">\(F\)</span> thực hiện bao nhiêu lần không quan trọng. Đây chính là ý nghĩa mình nói ở đầu bài, tăng số vòng không đồng nghĩa với an toàn hơn.</p>
<p>Sau đây mình sẽ ví dụ đơn giản về slide attack. Giống như hai bài trước, mình vẫn dùng TinyDES nhưng ở đây sẽ có hai thay đổi nhỏ.</p>
</section>
<section id="slide-attack-tren-mo-hinh-feistel">
<h2><span class="section-number">3.2. </span>Slide attack trên mô hình Feistel<a class="headerlink" href="#slide-attack-tren-mo-hinh-feistel" title="Link to this heading">¶</a></h2>
<section id="slide-attack-voi-tinydes">
<h3><span class="section-number">3.2.1. </span>Slide attack với TinyDES<a class="headerlink" href="#slide-attack-voi-tinydes" title="Link to this heading">¶</a></h3>
<p>TinyDES là một phiên bản thu nhỏ của chuẩn mã hóa DES. TinyDES là mã hóa khối theo mô hình Feistel, kích thước khối là <span class="math notranslate nohighlight">\(8\)</span> bit, kích thước khóa cũng là <span class="math notranslate nohighlight">\(8\)</span> bit. Mỗi vòng khóa con có độ dài <span class="math notranslate nohighlight">\(6\)</span> bit. Trong phần slide attack này chúng ta sẽ thay đổi một vài điểm so với TinyDES ở hai bài trước.</p>
<figure class="align-default" id="id4">
<img alt="../../_images/tinydes.jpg" src="../../_images/tinydes.jpg" />
<figcaption>
<p><span class="caption-number">Hình 3.18 </span><span class="caption-text">Một vòng TinyDES</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Theo mô hình Feistel, khối đầu vào <span class="math notranslate nohighlight">\(8\)</span> bit được chia thành hai nửa trái phải <span class="math notranslate nohighlight">\(4\)</span> bit. Nửa phải sẽ đi qua các hàm Expand, SBox và PBox, sau đó XOR với nửa trái để được nửa phải mới. Còn nửa trái mới là nửa phải cũ. Tóm lại công thức mô hình Feistel là:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[L_{i+1} = R_i, \quad R_{i+1} = L_i \oplus F(R_i, K)\]</div>
</div>
<p>với <span class="math notranslate nohighlight">\(i = 1, 2, \ldots, 100\)</span> với đầu vào của khối là <span class="math notranslate nohighlight">\((L_0, R_0)\)</span>. Ở đây chúng ta lưu ý <strong>hai</strong> thay đổi so với TinyDES ở hai bài trước:</p>
<ul class="simple">
<li><p>hiện tại chúng ta sử dụng <span class="math notranslate nohighlight">\(100\)</span> vòng thay vì <span class="math notranslate nohighlight">\(3\)</span> như hai bài trước;</p></li>
<li><p>cả <span class="math notranslate nohighlight">\(100\)</span> vòng sử dụng duy nhất một khóa con là <span class="math notranslate nohighlight">\(K\)</span>.</p></li>
</ul>
<p>Chúng ta vẫn dùng các động tác sau:</p>
<ol class="arabic simple">
<li><p>Expand: mở rộng và hoán vị <span class="math notranslate nohighlight">\(R_i\)</span> từ <span class="math notranslate nohighlight">\(4\)</span> bits lên <span class="math notranslate nohighlight">\(6\)</span> bits. Giả sử <span class="math notranslate nohighlight">\(4\)</span> bits của <span class="math notranslate nohighlight">\(R_i\)</span> là <span class="math notranslate nohighlight">\(b_0 b_1 b_2 b_3\)</span> thì kết quả sau khi Expand là <span class="math notranslate nohighlight">\(b_2 b_3 b_1 b_2 b_1 b_0\)</span>.</p></li>
<li><p>SBox: gọi <span class="math notranslate nohighlight">\(6\)</span> bits đầu vào là <span class="math notranslate nohighlight">\(b_0 b_1 b_2 b_3 b_4 b_5\)</span>. Khi đó ta tra cứu theo bảng SBox với <span class="math notranslate nohighlight">\(b_0 b_5\)</span> chỉ số <strong>hàng</strong>, <span class="math notranslate nohighlight">\(b_1 b_2 b_3 b_4\)</span> chỉ số <strong>cột</strong>. Nói cách khác bảng SBox có <span class="math notranslate nohighlight">\(4\)</span> hàng, <span class="math notranslate nohighlight">\(16\)</span> cột. Kết quả của SBox là một số <span class="math notranslate nohighlight">\(4\)</span> bits.</p></li>
<li><p>PBox: là hàm hoán vị <span class="math notranslate nohighlight">\(4\)</span> bit <span class="math notranslate nohighlight">\(b_0 b_1 b_2 b_3\)</span> thành <span class="math notranslate nohighlight">\(b_2 b_0 b_3 b_1\)</span>.</p></li>
</ol>
<p>Như vậy, hàm <span class="math notranslate nohighlight">\(F\)</span> của mô hình Feistel đối với mã TinyDES là:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[F(R_i, K) = \mathsf{PBox}(\mathsf{SBox}(\mathsf{Expand}(R_i) \oplus K)).\]</div>
</div>
<p>Để sinh khóa con cho <span class="math notranslate nohighlight">\(100\)</span> vòng, khóa ban đầu được chia thành hai nửa trái phải lần lượt là <span class="math notranslate nohighlight">\(KL_0\)</span> và <span class="math notranslate nohighlight">\(KR_0\)</span>. TinyDES thực hiện như sau:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(KL_0\)</span> và <span class="math notranslate nohighlight">\(KR_0\)</span> được dịch vòng trái <span class="math notranslate nohighlight">\(1\)</span> bit để được <span class="math notranslate nohighlight">\(KL_1\)</span> và <span class="math notranslate nohighlight">\(KR_1\)</span>;</p></li>
<li><p>khóa <span class="math notranslate nohighlight">\(K\)</span> dùng chung cho <span class="math notranslate nohighlight">\(100\)</span> vòng là hoán vị và nén <span class="math notranslate nohighlight">\(8\)</span> bits của <span class="math notranslate nohighlight">\(KL_1 \Vert KR_1\)</span>. Đặt <span class="math notranslate nohighlight">\(8\)</span> bits khi ghép <span class="math notranslate nohighlight">\(KL_1 \Vert KR_1\)</span> là <span class="math notranslate nohighlight">\(k_0 k_1 k_2 k_3 k_4 k_5 k_6 k_7\)</span>. Khi đó khóa <span class="math notranslate nohighlight">\(K\)</span> là <span class="math notranslate nohighlight">\(6\)</span> bits <span class="math notranslate nohighlight">\(k_5 k_1 k_3 k_2 k_7 k_0\)</span>.</p></li>
</ul>
<div class="dropdown admonition">
<p class="admonition-title">tinydes.py</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># tindeys.py</span>

<span class="n">sbox</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mh">0xE</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0xD</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0x2</span><span class="p">,</span> <span class="mh">0xF</span><span class="p">,</span> <span class="mh">0xB</span><span class="p">,</span> <span class="mh">0x8</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0xA</span><span class="p">,</span> <span class="mh">0x6</span><span class="p">,</span> <span class="mh">0xC</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x7</span><span class="p">,</span>
    <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0xF</span><span class="p">,</span> <span class="mh">0x7</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0xE</span><span class="p">,</span> <span class="mh">0x2</span><span class="p">,</span> <span class="mh">0xD</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0xA</span><span class="p">,</span> <span class="mh">0x6</span><span class="p">,</span> <span class="mh">0xC</span><span class="p">,</span> <span class="mh">0xB</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0x8</span><span class="p">,</span>
    <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0xE</span><span class="p">,</span> <span class="mh">0x8</span><span class="p">,</span> <span class="mh">0xD</span><span class="p">,</span> <span class="mh">0x6</span><span class="p">,</span> <span class="mh">0x2</span><span class="p">,</span> <span class="mh">0xB</span><span class="p">,</span> <span class="mh">0xF</span><span class="p">,</span> <span class="mh">0xC</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span> <span class="mh">0x7</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0xA</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span>
    <span class="mh">0xF</span><span class="p">,</span> <span class="mh">0xC</span><span class="p">,</span> <span class="mh">0x8</span><span class="p">,</span> <span class="mh">0x2</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0x7</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0xB</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0xE</span><span class="p">,</span> <span class="mh">0xA</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x6</span><span class="p">,</span> <span class="mh">0xD</span>
<span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">Xor</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">b</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">Expand</span><span class="p">(</span><span class="n">R</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">SBox</span><span class="p">(</span><span class="n">R</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="n">row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="p">[</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="mi">5</span><span class="p">]])),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">col</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">])),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">format</span><span class="p">(</span><span class="n">sbox</span><span class="p">[</span><span class="n">row</span><span class="o">*</span><span class="mi">16</span> <span class="o">+</span> <span class="n">col</span><span class="p">],</span> <span class="s2">&quot;04b&quot;</span><span class="p">)))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">PBox</span><span class="p">(</span><span class="n">R</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">PBox_inv</span><span class="p">(</span><span class="n">R</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">Compress</span><span class="p">(</span><span class="n">K</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">round</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">K</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">K</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
    <span class="k">if</span> <span class="nb">round</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">round</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">left</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">left</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">right</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">right</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">round</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">left</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">+</span> <span class="n">left</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">right</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">+</span> <span class="n">right</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">Ki</span> <span class="o">=</span> <span class="n">left</span> <span class="o">+</span> <span class="n">right</span>
    <span class="k">return</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="p">[</span><span class="n">Ki</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">Ki</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Ki</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">Ki</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">Ki</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">Ki</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">encrypt_block</span><span class="p">(</span><span class="n">plaintext</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">key</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">key</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">Compress</span><span class="p">(</span><span class="n">left</span> <span class="o">+</span> <span class="n">right</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">plaintext</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">plaintext</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>    <span class="c1"># 100 vòng</span>
        <span class="c1"># chỉ sử dụng mỗi K_1 trong TinyDES gốc</span>
        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">right</span><span class="p">,</span> <span class="n">Xor</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">PBox</span><span class="p">(</span><span class="n">SBox</span><span class="p">(</span><span class="n">Xor</span><span class="p">(</span><span class="n">Expand</span><span class="p">(</span><span class="n">right</span><span class="p">),</span> <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]))))</span>

    <span class="k">return</span> <span class="n">left</span> <span class="o">+</span> <span class="n">right</span>

<span class="c1"># print(encrypt_block([0, 1, 0, 1, 1, 1, 0, 0], [1, 0, 0, 1, 1, 0, 1, 0]))</span>
</pre></div>
</div>
</div>
<p>Ở đây chúng ta thấy mô hình mã hóa sẽ diễn ra như sau. Gọi <span class="math notranslate nohighlight">\((L_0, R_0)\)</span> là hai nửa trái phải của bản rõ ban đầu <span class="math notranslate nohighlight">\(P\)</span>. Khi đó, ở mỗi vòng biến đổi sẽ sử dụng chung khóa con <span class="math notranslate nohighlight">\(K\)</span> theo mô hình</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[P = (L_0, R_0) \xrightarrow{F_K} (L_1, R_1) \xrightarrow{F_K} (L_2, R_2) \xrightarrow{F_K} (L_3, R_3) = C.\]</div>
</div>
<p>Theo mô hình Feistel thì</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[L_1 = R_0, \quad R_1 = L_0 \oplus f(R_0, K)\]</div>
</div>
<p>với <span class="math notranslate nohighlight">\(f\)</span> là round function tương ứng với thuật toán TinyDES. Nói cách khác thì <span class="math notranslate nohighlight">\(F_k\)</span> là</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[F_K(L_i, R_i) = (R_i, L_i \oplus f(R_i, K)).\]</div>
</div>
<p>Lúc này slid pair có dạng</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
    F_K(P) = P' \\ F_K(C) = C'
\end{cases} \Longleftrightarrow \begin{cases}
    F_K(L_0, R_0) = (L_0', R_0') \\
    F_K(L_3, R_3) = (L_3', R_3')
\end{cases}\end{split}\]</div>
</div>
<p>hay tương đương với</p>
<div class="math-wrapper docutils container" id="equation-eq-slid">
<div class="math notranslate nohighlight" id="equation-eq-slid">
<span class="eqno">(3.5)<a class="headerlink" href="#equation-eq-slid" title="Link to this equation">¶</a></span>\[\begin{split}\begin{cases}
    (R_0, L_0 \oplus f(R_0, K)) = (L_0', R_0') \\
    (R_3, L_3 \oplus f(R_3, K)) = (L_3', R_3')
\end{cases} \Longleftrightarrow \begin{cases}
    R_0 = L_0' \\ L_0 \oplus f(R_0, K) = L_0' \\
    R_3 = L_3' \\ L_3 \oplus f(R_3, K) = R_3'.
\end{cases}\end{split}\]</div>
</div>
<p>Như vậy:</p>
<blockquote>
<div><p>nếu chúng ta có <span class="math notranslate nohighlight">\((P, C)\)</span> và <span class="math notranslate nohighlight">\((P', C')\)</span> thỏa các điều kiện ở <a class="reference internal" href="#equation-eq-slid">(3.5)</a> thì chúng ta có slid pair.</p>
</div></blockquote>
<p>Câu hỏi đặt ra là nếu chúng ta không biết khóa con <span class="math notranslate nohighlight">\(K\)</span> thì làm sao kiểm tra được các điều kiện trên?</p>
<p>Câu trả lời (mà cũng là cách chúng ta thực hiện trên thực tế) là chúng ta <strong>giả sử đã tìm được slid pair</strong>. Như vậy điều kiện đầu và điều kiện thứ ba phải thỏa mãn trước. Sau đó từ điều kiện thứ hai và thứ tư chúng ta tìm ngược lại <span class="math notranslate nohighlight">\(K\)</span>. Cuối cùng chúng ta thử mã hóa <span class="math notranslate nohighlight">\(P\)</span> với <span class="math notranslate nohighlight">\(K\)</span> đã tìm được. Nếu chúng ta thu được chính xác <span class="math notranslate nohighlight">\(C\)</span> thì <span class="math notranslate nohighlight">\(K\)</span> là khóa con cần tìm, ngược lại thì chúng ta thử với slid pair khác.</p>
<div class="dropdown admonition">
<p class="admonition-title">solve.py</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># solve.py</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">tinydes</span><span class="w"> </span><span class="kn">import</span> <span class="n">encrypt_block</span><span class="p">,</span> <span class="n">PBox</span><span class="p">,</span> <span class="n">SBox</span><span class="p">,</span> <span class="n">Expand</span><span class="p">,</span> <span class="n">Xor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>


<span class="k">def</span><span class="w"> </span><span class="nf">fault_encrypt_block</span><span class="p">(</span><span class="n">plaintext</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">key</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">plaintext</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">plaintext</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">right</span><span class="p">,</span> <span class="n">Xor</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">PBox</span><span class="p">(</span><span class="n">SBox</span><span class="p">(</span><span class="n">Xor</span><span class="p">(</span><span class="n">Expand</span><span class="p">(</span><span class="n">right</span><span class="p">),</span> <span class="n">key</span><span class="p">))))</span>

    <span class="k">return</span> <span class="n">left</span> <span class="o">+</span> <span class="n">right</span>


<span class="n">pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">cts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">secret_key</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">4</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">__</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)]</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">encrypt_block</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">)</span>
    <span class="n">pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
    <span class="n">cts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="n">L0</span><span class="p">,</span> <span class="n">R0</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="mi">4</span><span class="p">],</span> <span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">:]</span>
    <span class="n">L3</span><span class="p">,</span> <span class="n">R3</span> <span class="o">=</span> <span class="n">cts</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="mi">4</span><span class="p">],</span> <span class="n">cts</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">:]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
        <span class="n">l0</span><span class="p">,</span> <span class="n">r0</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">j</span><span class="p">][:</span><span class="mi">4</span><span class="p">],</span> <span class="n">pts</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">4</span><span class="p">:]</span>
        <span class="n">l3</span><span class="p">,</span> <span class="n">r3</span> <span class="o">=</span> <span class="n">cts</span><span class="p">[</span><span class="n">j</span><span class="p">][:</span><span class="mi">4</span><span class="p">],</span> <span class="n">cts</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">4</span><span class="p">:]</span>
        <span class="c1"># Lazy bruteforce for K</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">06b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
            <span class="c1"># Check slid pair</span>
            <span class="k">if</span> <span class="n">l0</span> <span class="o">==</span> <span class="n">R0</span> <span class="ow">and</span> <span class="n">r0</span> <span class="o">==</span> <span class="n">Xor</span><span class="p">(</span><span class="n">L0</span><span class="p">,</span> <span class="n">PBox</span><span class="p">(</span><span class="n">SBox</span><span class="p">(</span><span class="n">Xor</span><span class="p">(</span><span class="n">Expand</span><span class="p">(</span><span class="n">R0</span><span class="p">),</span> <span class="n">key</span><span class="p">)))):</span>
                <span class="k">if</span> <span class="n">l3</span> <span class="o">==</span> <span class="n">R3</span> <span class="ow">and</span> <span class="n">r3</span> <span class="o">==</span> <span class="n">Xor</span><span class="p">(</span><span class="n">R3</span><span class="p">,</span> <span class="n">PBox</span><span class="p">(</span><span class="n">SBox</span><span class="p">(</span><span class="n">Xor</span><span class="p">(</span><span class="n">Expand</span><span class="p">(</span><span class="n">R3</span><span class="p">),</span> <span class="n">key</span><span class="p">)))):</span>
                    <span class="k">if</span> <span class="n">fault_encrypt_block</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="n">cts</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Ở đoạn code trên mình bruteforce khóa con <span class="math notranslate nohighlight">\(K\)</span> vì SBox của TinyDES (và cũng là của DES) nhận đầu vào <span class="math notranslate nohighlight">\(6\)</span> bit nhưng đầu ra giảm còn <span class="math notranslate nohighlight">\(4\)</span> bit (chứ không phải do mình lười đâu hiuhiu). Do đó có thể có nhiều trường hợp của khóa con <span class="math notranslate nohighlight">\(K\)</span> có thể thỏa mãn điều kiện của slid pair. Chúng ta cũng có thể tạo lookup table và thực hiện ngược lại round function để tìm các khả năng của khóa con <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>Gọi <span class="math notranslate nohighlight">\(\mathsf{PBox}^{-1}\)</span> là phép biến đổi ngược của <span class="math notranslate nohighlight">\(\mathsf{PBox}\)</span>. Khi đó từ điều kiện thứ hai <span class="math notranslate nohighlight">\(L_0 \oplus f(R_0, K) = L_0'\)</span> suy ra</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[L_0 \oplus L_0' = f(R_0, K) = \mathsf{PBox}(\mathsf{SBox}(\mathsf{Expand}(R_0) \oplus K)),\]</div>
</div>
<p>suy ra</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathsf{PBox}^{-1}(L_0 \oplus L_0') = \mathsf{SBox}(\mathsf{Expand}(R_0) \oplus K).\]</div>
</div>
<p>Chúng ta có thể tính được <span class="math notranslate nohighlight">\(\mathsf{PBox}^{-1}(L_0 \oplus L_0')\)</span> và <span class="math notranslate nohighlight">\(\mathsf{Expand}(R_0)\)</span> nên việc &quot;đoán&quot; <span class="math notranslate nohighlight">\(K\)</span> không phải vấn đề khó khăn. Thêm nữa điều kiện thứ tư cũng cho chúng ta các ứng cử viên cho khóa con <span class="math notranslate nohighlight">\(K\)</span>. Kết hợp hai điều kiện này chúng ta có khóa con <span class="math notranslate nohighlight">\(K\)</span> và chúng ta sẽ thử mã hóa <span class="math notranslate nohighlight">\(P\)</span> thành <span class="math notranslate nohighlight">\(C\)</span>.</p>
</section>
<section id="slide-attack-voi-des">
<h3><span class="section-number">3.2.2. </span>Slide attack với DES<a class="headerlink" href="#slide-attack-voi-des" title="Link to this heading">¶</a></h3>
<p>Ở olympiad mật mã học quốc tế NSUCRYPTO 2024 có một bài slide attack trên DES là bài 4 ở round 2 &quot;Weak key schedule for DES&quot;. Bài này được giải bởi bạn Chương (vnc) đội mình. Ở phần sau mình sẽ trình bày lời giải cho bài này. Mình sẽ sử dụng code của bạn Chương trong lời giải. Xin cám ơn bạn Chương vì đã đóng góp :D :D :D</p>
<p>Trong bài này, thông tin ban đầu là file <code class="docutils literal notranslate"><span class="pre">Book.txt</span></code> và được mã hóa thành file <code class="docutils literal notranslate"><span class="pre">Book_Cipher.txt</span></code>.</p>
<p>Thuật toán được sử dụng để mã hóa là DES. Tuy nhiên trong bài này đặc biệt ở chỗ mỗi vòng đều dùng chung một khóa con (khóa con đầu tiên của thuật toán sinh khóa con).</p>
<p>Nhiệm vụ của chúng ta là tìm khóa con đó và giải mã thông điệp sau:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">86991641</span><span class="n">D28259604412D6BA88A5C0A6471CA7222C52482BF2D0E841D4343DFB877DC8E0147F3D5F20FC18FF28CB5C4DA8A0F4694861AB5E98F37ADBC2D69B35779D9001BB4B648518FE6EBC00B2AB10</span>
</pre></div>
</div>
<section id="cai-dat-faulty-des">
<h4><span class="section-number">3.2.2.1. </span>Cài đặt FAULTY_DES<a class="headerlink" href="#cai-dat-faulty-des" title="Link to this heading">¶</a></h4>
<p>Ở đây bạn Chương gọi thuật toán của đề bài là <code class="docutils literal notranslate"><span class="pre">FAULTY_DES</span></code> và bạn sẽ cài đặt thuật toán này cùng với một số hàm bổ trợ cho việc giải bài.</p>
<div class="dropdown admonition">
<p class="admonition-title">faulty_des.py</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># faulty_des.py</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DES_CONST</span><span class="p">:</span>
    <span class="n">PC1</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">57</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">9</span> <span class="p">,</span>
        <span class="mi">1</span> <span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span>
        <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span>
        <span class="mi">19</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span>
        <span class="mi">63</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span>
        <span class="mi">7</span> <span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span>
        <span class="mi">14</span><span class="p">,</span> <span class="mi">6</span> <span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span>
        <span class="mi">21</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span> <span class="p">,</span>
    <span class="p">)</span>

    <span class="n">PC2</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">14</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">,</span>
        <span class="mi">3</span> <span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">6</span> <span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>
        <span class="mi">23</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span> <span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">8</span> <span class="p">,</span>
        <span class="mi">16</span><span class="p">,</span> <span class="mi">7</span> <span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span>
        <span class="mi">41</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span>
        <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span>
        <span class="mi">44</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span>
        <span class="mi">46</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">KEY_ROTATION</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">INITIAL_PERMUTATION</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">58</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
        <span class="mi">60</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>
        <span class="mi">62</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
        <span class="mi">64</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
        <span class="mi">57</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">9</span> <span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
        <span class="mi">59</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
        <span class="mi">61</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
        <span class="mi">63</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ROUND_PERMUTATION</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">16</span><span class="p">,</span> <span class="mi">7</span> <span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span>
        <span class="mi">29</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span>
        <span class="mi">1</span> <span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span>
        <span class="mi">5</span> <span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>
        <span class="mi">2</span> <span class="p">,</span> <span class="mi">8</span> <span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>
        <span class="mi">32</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">9</span> <span class="p">,</span>
        <span class="mi">19</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">6</span> <span class="p">,</span>
        <span class="mi">22</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">4</span> <span class="p">,</span> <span class="mi">25</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">INV_ROUND_PERMUTATION</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">9</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span>
        <span class="mi">13</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span>
        <span class="mi">24</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
        <span class="mi">26</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
        <span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">3</span> <span class="p">,</span>
        <span class="mi">4</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span>
        <span class="mi">32</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
        <span class="mi">5</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">FINAL_PERMUTATION</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">40</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span>
        <span class="mi">39</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span>
        <span class="mi">38</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span>
        <span class="mi">37</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span>
        <span class="mi">36</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span>
        <span class="mi">35</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span>
        <span class="mi">34</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span>
        <span class="mi">33</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">9</span> <span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">EXPANSION</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">2</span> <span class="p">,</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">4</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">,</span>
        <span class="mi">4</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">6</span> <span class="p">,</span> <span class="mi">7</span> <span class="p">,</span> <span class="mi">8</span> <span class="p">,</span> <span class="mi">9</span> <span class="p">,</span>
        <span class="mi">8</span> <span class="p">,</span> <span class="mi">9</span> <span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>
        <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span>
        <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span>
        <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span>
        <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span>
        <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span>
    <span class="p">)</span>

    <span class="n">SBOX</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span>
            <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
            <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span>
            <span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
            <span class="mi">13</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
            <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span>
            <span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span>
            <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span>
            <span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>
            <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span>
            <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
            <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
            <span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
            <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span>
            <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
            <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
            <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">HELP</span><span class="p">:</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">INT_TO_BITS</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="n">bits</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)):</span>
            <span class="n">bits</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bits</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">BITS_TO_INT</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bits</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">bits</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span>
            <span class="n">value</span> <span class="o">|=</span> <span class="n">bit</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">BLOCK_TO_BITS</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">block</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="n">bits</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">block</span><span class="p">:</span>
            <span class="n">bits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">INT_TO_BITS</span><span class="p">(</span><span class="n">byte</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">bits</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">BITS_TO_BLOCK</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bits</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="n">block_bytes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
            <span class="n">byte</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">BITS_TO_INT</span><span class="p">(</span><span class="n">bits</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">8</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">])</span>
            <span class="n">block_bytes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">PERMUTATE</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bits</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">table</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">bits</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>
        <span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">XOR</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bits1</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">bits2</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="o">^</span> <span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bits1</span><span class="p">,</span> <span class="n">bits2</span><span class="p">)]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">EXPAND</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bits</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">table</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">bits</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>
        <span class="p">]</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">SUBSTITUTE</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bits</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">mapping</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="n">pieces</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
            <span class="n">piece_bits</span> <span class="o">=</span> <span class="n">bits</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">6</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">6</span><span class="p">]</span>

            <span class="n">piece</span> <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">BITS_TO_INT</span><span class="p">(</span><span class="n">piece_bits</span><span class="p">)</span>
            <span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">piece</span><span class="p">)</span>

        <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">piece</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pieces</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">(</span><span class="n">piece</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="n">piece</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mb">0b10</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="p">(</span><span class="n">piece</span> <span class="o">&amp;</span> <span class="mb">0b011110</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>

            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mapping</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">row</span> <span class="o">*</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">column</span><span class="p">])</span>

        <span class="n">result_bits</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="n">result_bits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">HELP</span><span class="o">.</span><span class="n">INT_TO_BITS</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">result_bits</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FAULTY_DES</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rk</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">rounds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rounds</span> <span class="o">=</span> <span class="n">rounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">round_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">HELP</span><span class="o">.</span><span class="n">BLOCK_TO_BITS</span><span class="p">(</span><span class="n">rk</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rounds</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reversed_round_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_keys</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">encrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">plaintext</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plaintext</span><span class="p">),</span> <span class="mi">8</span><span class="p">)]</span>
        <span class="k">return</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_process_block</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_keys</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span><span class="o">%</span><span class="mi">8</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">ciphertext</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">),</span> <span class="mi">8</span><span class="p">)]</span>
        <span class="k">return</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_process_block</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed_round_keys</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_process_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">schedule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="n">bits</span> <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">BLOCK_TO_BITS</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>

        <span class="n">bits</span> <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">PERMUTATE</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">DES_CONST</span><span class="o">.</span><span class="n">INITIAL_PERMUTATION</span><span class="p">)</span>
        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">bits</span><span class="p">[:</span><span class="mi">32</span><span class="p">],</span> <span class="n">bits</span><span class="p">[</span><span class="mi">32</span><span class="p">:]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rounds</span><span class="p">):</span>
            <span class="n">new_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">schedule</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">right</span><span class="p">,</span> <span class="n">HELP</span><span class="o">.</span><span class="n">XOR</span><span class="p">(</span><span class="n">new_right</span><span class="p">,</span> <span class="n">left</span><span class="p">)</span>

        <span class="n">result_bits</span> <span class="o">=</span> <span class="n">right</span> <span class="o">+</span> <span class="n">left</span>
        <span class="n">result_bits</span> <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">PERMUTATE</span><span class="p">(</span><span class="n">result_bits</span><span class="p">,</span> <span class="n">DES_CONST</span><span class="o">.</span><span class="n">FINAL_PERMUTATION</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">HELP</span><span class="o">.</span><span class="n">BITS_TO_BLOCK</span><span class="p">(</span><span class="n">result_bits</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bits</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">key_bits</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="n">bits</span> <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">DES_CONST</span><span class="o">.</span><span class="n">EXPANSION</span><span class="p">)</span>
        <span class="n">bits</span> <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">XOR</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">key_bits</span><span class="p">)</span>
        <span class="n">bits</span> <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">SUBSTITUTE</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">DES_CONST</span><span class="o">.</span><span class="n">SBOX</span><span class="p">)</span>
        <span class="n">bits</span> <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">PERMUTATE</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">DES_CONST</span><span class="o">.</span><span class="n">ROUND_PERMUTATION</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">bits</span>
</pre></div>
</div>
</div>
</section>
<section id="thuc-hien-solve-py">
<h4><span class="section-number">3.2.2.2. </span>Thực hiện solve.py<a class="headerlink" href="#thuc-hien-solve-py" title="Link to this heading">¶</a></h4>
<p>Phần này mình sẽ viết <code class="docutils literal notranslate"><span class="pre">solve.py</span></code> để giải bài này từ jupyter notebook của bạn Chương.</p>
<p>Đầu tiên chúng ta gọi một số thư viện.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">faulty_des</span><span class="w"> </span><span class="kn">import</span> <span class="n">DES_CONST</span><span class="p">,</span> <span class="n">HELP</span><span class="p">,</span> <span class="n">FAULTY_DES</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
</pre></div>
</div>
<p>Tiếp theo, chúng ta cần thống nhất rằng mỗi khối trong thuật toán <code class="docutils literal notranslate"><span class="pre">FAULTY_DES</span></code> sẽ được biểu diễn bởi mảng gồm <span class="math notranslate nohighlight">\(8\)</span> phần tử (<code class="docutils literal notranslate"><span class="pre">list[int]</span></code>). Khi đó nửa trái (left-half) là <span class="math notranslate nohighlight">\(4\)</span> phần tử đầu của mảng và nửa phải (right-half) là <span class="math notranslate nohighlight">\(4\)</span> phần tử sau. Do đó chúng ta cần một số lambda để lấy nửa trái/phải. Sau bước cuối chúng ta ghép nửa phải cuối cùng với nửa trái cuối cùng nên cần thêm hàm <code class="docutils literal notranslate"><span class="pre">Swap_f</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Left_f</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">block</span><span class="p">:</span> <span class="n">block</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">Right_f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">block</span><span class="p">:</span> <span class="n">block</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
<span class="n">Swap_f</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">block</span><span class="p">:</span> <span class="n">Right_f</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="o">+</span> <span class="n">Left_f</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
</pre></div>
</div>
<p>Sau đó đọc bản rõ và bản mã từ file đề cho rồi tách chúng thành các khối <span class="math notranslate nohighlight">\(8\)</span> bytes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Known-Plaintext-Ciphertext Pairs</span>
<span class="n">plaintext</span>  <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Book.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>     <span class="c1"># độ dài bản rõ chia hết cho 8</span>
<span class="n">ciphertext</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Book_cipher.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># Divide them into blocks</span>
<span class="n">pts</span>        <span class="o">=</span> <span class="p">[</span><span class="n">plaintext</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plaintext</span><span class="p">),</span> <span class="mi">8</span><span class="p">)]</span>
<span class="n">cts</span>        <span class="o">=</span> <span class="p">[</span><span class="n">ciphertext</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">),</span> <span class="mi">8</span><span class="p">)]</span>
</pre></div>
</div>
<p>Tiếp theo chúng ta tìm các slid pair. Ở đây chúng ta cần xem lại cách hoạt động của thuật toán DES. Hình sau mình lấy từ <span id="id2">[<a class="reference internal" href="../../index.html#id36" title="Jérémy Jean. TikZ for Cryptographers. https://www.iacr.org/authors/tikz/, 2016.">32</a>]</span> và chỉnh sửa lại.</p>
<figure class="align-default" id="id5">
<img alt="../../_images/des-round.jpg" src="../../_images/des-round.jpg" />
<figcaption>
<p><span class="caption-number">Hình 3.19 </span><span class="caption-text">Round function của DES</span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Tóm tắt cách hoạt động thì DES cũng theo mô hình</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[L_{i+1} = R_i, \quad R_{i+1} = L_i \oplus \mathsf{PBox}(\mathsf{SBox}(\mathsf{Expand}(R_i) \oplus K_{i+1})),\]</div>
</div>
<p>trong đó</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathsf{Expand}\)</span> mở rộng nửa khối từ <span class="math notranslate nohighlight">\(32\)</span> bits lên <span class="math notranslate nohighlight">\(48\)</span> bits;</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathsf{SBox}\)</span>: <span class="math notranslate nohighlight">\(48\)</span> bits sẽ được chia thành <span class="math notranslate nohighlight">\(8\)</span> đoạn, mỗi đoạn có <span class="math notranslate nohighlight">\(6\)</span> bits. Sau đó mỗi đoạn sẽ đi qua các S-Box và giảm từ <span class="math notranslate nohighlight">\(6\)</span> bits xuống <span class="math notranslate nohighlight">\(4\)</span> bits. Các kết quả được nối lại với nhau nên kết quả sau <span class="math notranslate nohighlight">\(\mathsf{SBox}\)</span> là <span class="math notranslate nohighlight">\(4 \cdot 8 = 32\)</span> bits;</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathsf{PBox}\)</span>: thực hiện hoán vị <span class="math notranslate nohighlight">\(32\)</span> bit sau <span class="math notranslate nohighlight">\(\mathsf{SBox}\)</span>.</p></li>
</ul>
<p>Ở đây slid pair cũng tương tự TinyDES ở trên. Giả sử slid pair là cặp <span class="math notranslate nohighlight">\((P, C)\)</span> và <span class="math notranslate nohighlight">\((P', C')\)</span>. Khi đó</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[F_K(P) = P', \quad F_K(C) = C'\]</div>
</div>
<p>với <span class="math notranslate nohighlight">\(F_K\)</span> là round function</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(L_i, R_i) \xrightarrow{F_K} (L_{i+1}, R_{i+1}) \equiv (R_i, L_i \oplus \mathsf{PBox}(\mathsf{SBox}(\mathsf{Expand}(R_i) \oplus K_{i+1}))),\]</div>
</div>
<p>như trên.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Before and After DES&#39; rounds operations, there is a Block Permutation step!</span>
<span class="k">def</span><span class="w"> </span><span class="nf">BlockPermutate</span><span class="p">(</span><span class="n">block</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span>
    <span class="n">block_bits</span> <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">BLOCK_TO_BITS</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
    <span class="n">block_bits</span> <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">PERMUTATE</span><span class="p">(</span><span class="n">block_bits</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
    <span class="n">block</span>      <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">BITS_TO_BLOCK</span><span class="p">(</span><span class="n">block_bits</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">block</span>

<span class="c1"># Create Lookup Table</span>
<span class="n">lookup</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

<span class="k">for</span> <span class="n">pi</span><span class="p">,</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">cts</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;[+] Creating Lookup Table...&quot;</span><span class="p">):</span>
    <span class="n">pi_initial</span> <span class="o">=</span> <span class="n">BlockPermutate</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">DES_CONST</span><span class="o">.</span><span class="n">INITIAL_PERMUTATION</span><span class="p">)</span>
    <span class="n">ci_preout</span>  <span class="o">=</span> <span class="n">BlockPermutate</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="n">DES_CONST</span><span class="o">.</span><span class="n">INITIAL_PERMUTATION</span><span class="p">)</span>
    <span class="c1"># Why Left_f(Ci) -&gt; Remember that the final round doesn&#39;t swap two-halfs</span>
    <span class="n">lookup</span><span class="p">[</span><span class="n">Right_f</span><span class="p">(</span><span class="n">pi_initial</span><span class="p">)</span> <span class="o">+</span> <span class="n">Left_f</span><span class="p">(</span><span class="n">ci_preout</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pi_initial</span><span class="p">,</span> <span class="n">ci_preout</span><span class="p">))</span>

<span class="c1"># Finding &quot;slid pairs&quot;</span>
<span class="n">slid_pairs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">pj</span><span class="p">,</span> <span class="n">cj</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">cts</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;[+] Finding slid pairs...&quot;</span><span class="p">):</span>
    <span class="n">pj_initial</span> <span class="o">=</span> <span class="n">BlockPermutate</span><span class="p">(</span><span class="n">pj</span><span class="p">,</span> <span class="n">DES_CONST</span><span class="o">.</span><span class="n">INITIAL_PERMUTATION</span><span class="p">)</span>
    <span class="n">cj_preout</span>  <span class="o">=</span> <span class="n">BlockPermutate</span><span class="p">(</span><span class="n">cj</span><span class="p">,</span> <span class="n">DES_CONST</span><span class="o">.</span><span class="n">INITIAL_PERMUTATION</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Why Right_f(Cj) -&gt; Remember that the final round doesn&#39;t swap two-halfs</span>
        <span class="k">for</span> <span class="n">pi_initial</span><span class="p">,</span> <span class="n">ci_preout</span> <span class="ow">in</span> <span class="n">lookup</span><span class="p">[</span><span class="n">Left_f</span><span class="p">(</span><span class="n">pj_initial</span><span class="p">)</span> <span class="o">+</span> <span class="n">Right_f</span><span class="p">(</span><span class="n">cj_preout</span><span class="p">)]:</span>
            <span class="n">slid_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span>
                <span class="c1"># Now we swap to ensure that (P,C) and (P&#39;,C&#39;) is slid pair</span>
                <span class="c1"># &lt;=&gt; F(P) = P&#39; and F(C) = C&#39;</span>
                <span class="p">(</span><span class="n">pi_initial</span><span class="p">,</span> <span class="n">Swap_f</span><span class="p">(</span><span class="n">ci_preout</span><span class="p">)),</span>
                <span class="p">(</span><span class="n">pj_initial</span><span class="p">,</span> <span class="n">Swap_f</span><span class="p">(</span><span class="n">cj_preout</span><span class="p">)),</span>
            <span class="p">])</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">continue</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[!] Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">slid_pairs</span><span class="p">)</span><span class="si">}</span><span class="s2"> possible slid pairs!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Các phép biến đổi ngược của các phép biến đổi trong DES nhằm tìm các &quot;ứng cử viên&quot; cho khóa. Quan trọng là S-Box vì chúng ta đã biết mỗi S-Box biến đổi <span class="math notranslate nohighlight">\(6\)</span> bits thành <span class="math notranslate nohighlight">\(4\)</span> bits nên với nhiều đầu vào cho cùng đầu ra. Khi đi ngược lại để tìm &quot;ứng cử viên&quot; thì ta phải xét tất cả trường hợp đầu vào S-Box cho cùng đầu ra mà ta đang có.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enumerate all possible candidates</span>
<span class="k">def</span><span class="w"> </span><span class="nf">RevSubtitute</span><span class="p">(</span><span class="n">out</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">mapping</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">]):</span>
    <span class="n">cands</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)]</span>
    <span class="n">out</span>   <span class="o">=</span> <span class="p">[</span><span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="mi">4</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">piece</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">(</span><span class="n">piece</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="n">piece</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mb">0b10</span><span class="p">)</span>
            <span class="n">column</span> <span class="o">=</span> <span class="p">(</span><span class="n">piece</span> <span class="o">&amp;</span> <span class="mb">0b011110</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">HELP</span><span class="o">.</span><span class="n">INT_TO_BITS</span><span class="p">(</span><span class="n">mapping</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">row</span> <span class="o">*</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">column</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="n">out</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
                <span class="n">cands</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HELP</span><span class="o">.</span><span class="n">INT_TO_BITS</span><span class="p">(</span><span class="n">piece</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">rk</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">cands</span><span class="p">):</span>
        <span class="k">yield</span> <span class="nb">sum</span><span class="p">(</span><span class="n">rk</span><span class="p">,</span> <span class="p">[])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">RevFeistel</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">PERMUTATE</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">DES_CONST</span><span class="o">.</span><span class="n">INV_ROUND_PERMUTATION</span><span class="p">)</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">HELP</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">DES_CONST</span><span class="o">.</span><span class="n">EXPANSION</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rev_out</span> <span class="ow">in</span> <span class="n">RevSubtitute</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">DES_CONST</span><span class="o">.</span><span class="n">SBOX</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">HELP</span><span class="o">.</span><span class="n">BITS_TO_BLOCK</span><span class="p">(</span><span class="n">HELP</span><span class="o">.</span><span class="n">XOR</span><span class="p">(</span><span class="n">rev_out</span><span class="p">,</span> <span class="n">inp</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">RevRound</span><span class="p">(</span><span class="n">state0</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">state1</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
    <span class="n">L0</span><span class="p">,</span> <span class="n">R0</span> <span class="o">=</span> <span class="n">Left_f</span><span class="p">(</span><span class="n">state0</span><span class="p">),</span> <span class="n">Right_f</span><span class="p">(</span><span class="n">state0</span><span class="p">)</span>
    <span class="n">L1</span><span class="p">,</span> <span class="n">R1</span> <span class="o">=</span> <span class="n">Left_f</span><span class="p">(</span><span class="n">state1</span><span class="p">),</span> <span class="n">Right_f</span><span class="p">(</span><span class="n">state1</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">RevFeistel</span><span class="p">(</span>
        <span class="n">inp</span><span class="o">=</span><span class="n">HELP</span><span class="o">.</span><span class="n">BLOCK_TO_BITS</span><span class="p">(</span><span class="n">R0</span><span class="p">),</span>
        <span class="n">out</span><span class="o">=</span><span class="n">HELP</span><span class="o">.</span><span class="n">XOR</span><span class="p">(</span><span class="n">HELP</span><span class="o">.</span><span class="n">BLOCK_TO_BITS</span><span class="p">(</span><span class="n">R1</span><span class="p">),</span> <span class="n">HELP</span><span class="o">.</span><span class="n">BLOCK_TO_BITS</span><span class="p">(</span><span class="n">L0</span><span class="p">))</span>
    <span class="p">))</span>
</pre></div>
</div>
<p>Tìm các khóa con có thể và thử giải mã thông điệp đề cho với khóa con đó.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rk_cands</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="k">for</span> <span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">ci</span><span class="p">),</span> <span class="p">(</span><span class="n">pj</span><span class="p">,</span> <span class="n">cj</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">slid_pairs</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;[+] Recovering Possible RoundKey...&quot;</span><span class="p">):</span>
    <span class="n">rks_1</span>    <span class="o">=</span> <span class="n">RevRound</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">pj</span><span class="p">)</span>
    <span class="n">rks_2</span>    <span class="o">=</span> <span class="n">RevRound</span><span class="p">(</span><span class="n">ci</span><span class="p">,</span> <span class="n">cj</span><span class="p">)</span>
    <span class="n">rk_cands</span> <span class="o">=</span> <span class="n">rk_cands</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">rks_1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">rks_2</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[!] Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rk_cands</span><span class="p">)</span><span class="si">}</span><span class="s2"> possible RoundKeys!&quot;</span><span class="p">)</span>

<span class="c1"># Try to decrypt intercepted ciphertext</span>
<span class="n">intercepted_ciphertext</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;86991641D28259604412D6BA88A5C0A6471CA722&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;2C52482BF2D0E841D4343DFB877DC8E0147F3D5F&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;20FC18FF28CB5C4DA8A0F4694861AB5E98F37ADB&quot;</span><span class="p">),</span>
    <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;C2D69B35779D9001BB4B648518FE6EBC00B2AB10&quot;</span><span class="p">)</span>
<span class="p">])</span>

<span class="k">for</span> <span class="n">rk</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">rk_cands</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;[+] Try to decrypt intercepted ciphertext...&quot;</span><span class="p">):</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">FAULTY_DES</span><span class="p">(</span><span class="n">rk</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt; Readable Message:&quot;</span><span class="p">,</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">intercepted_ciphertext</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt; WRT RoundKey:&quot;</span><span class="p">,</span> <span class="n">rk</span><span class="o">.</span><span class="n">hex</span><span class="p">(),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">continue</span>

<span class="c1"># Verify again?</span>
<span class="k">assert</span> <span class="n">FAULTY_DES</span><span class="p">(</span><span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&quot;0c74fa6a642a&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span> <span class="o">==</span> <span class="n">ciphertext</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../algebraic-attack/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">4. </span>Algebraic cryptanalysis</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../linear-attack/tinydes.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">2.1. </span>Phá mã tuyến tính trên TinyDES</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Lê Quốc Dũng
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">3. Slide attack</a><ul>
<li><a class="reference internal" href="#id1">3.1. Slide attack</a></li>
<li><a class="reference internal" href="#slide-attack-tren-mo-hinh-feistel">3.2. Slide attack trên mô hình Feistel</a><ul>
<li><a class="reference internal" href="#slide-attack-voi-tinydes">3.2.1. Slide attack với TinyDES</a></li>
<li><a class="reference internal" href="#slide-attack-voi-des">3.2.2. Slide attack với DES</a><ul>
<li><a class="reference internal" href="#cai-dat-faulty-des">3.2.2.1. Cài đặt FAULTY_DES</a></li>
<li><a class="reference internal" href="#thuc-hien-solve-py">3.2.2.2. Thực hiện solve.py</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=dd9e4a14"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../_static/translations.js?v=4c1d55b0"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"tex": {"macros": {"bm": ["{\\boldsymbol{#1}}", 1]}}, "chtml": {"mtextInheritFont": "true"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>